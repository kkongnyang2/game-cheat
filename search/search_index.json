{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":""},{"location":"1-ow/","title":"1 ow","text":""},{"location":"1-ow/#_1","title":"\uc624\ubc84\uc6cc\uce58 \uad6c\uc870\ub97c \uc54c\uc544\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-07-06</p>"},{"location":"1-ow/#_2","title":"\uc124\uce58 \ud30c\uc774\ud504\ub77c\uc778","text":"<p>\uc18c\uc2a4 asset\uc5d0\uc11c \uc2e4\ud589\uac00\ub2a5 asset\uc73c\ub85c \ubcc0\ud658\ud558\uac70\ub098, \uce90\uc2f1, \ubd84\uc0b0 \ube4c\ub4dc, \ud328\ud0a4\uc9d5 \ub4f1\uc744 \ud55c\ub2e4.</p> <pre><code>[Source Assets] \u2500\u25b6 pull --sourcepull \u2500\u25b6 SQLite \u2018local asset DB\u2019\n                 \u25b2                             \u2502\n                 \u2502 (Structured-Data Generator) \u2502\n                 \u2502                             \u25bc\n[Builder per Type] \u25c0\u2500 DataBuild --compile \u2500\u2500\u25b6 [Compiled Asset Store]\n</code></pre> <p>genrator: json \uc720\uc0ac \uc120\uc5b8(SDLang)\uc73c\ub85c \ud0c0\uc785-\uc548\uc804 C++/C# \ud074\ub798\uc2a4, \uc5d0\ub514\ud130 \ub9ac\ud50c\ub809\uc158 \ucf54\ub4dc \uc790\ub3d9\uc0dd\uc131. \uc0b0\ucd9c\ubb3c \uc704\uce58\ub294 Generated/.h/.cpp\ub85c \ucd94\uc815. <p>builer: asset \ud0c0\uc785\ubcc4(\uba54\uc2dc, \uba38\ud2f0\ub9ac\uc5bc, \uc601\uc6c5 \uc2a4\ud06c\ub9bd\ud2b8) DLL. \uc785\ub825 SHA-1 \ud574\uc2dc\uc640 CompilerID \uc870\ud569\uc73c\ub85c \uacb0\uacfc\ub97c \uce90\uc2f1\ud574, \uc774\ubbf8 \ucef4\ud30c\uc77c\ub41c \ub3d9\uc77c \uc785\ub825\uc740 \uc804\uc5ed Compiled Asset Repository\uc5d0\uc11c \uadf8\ub0e5 \ub2f9\uaca8\uc628\ub2e4. \ubd84\uc0b0 \ube4c\ub4dc\ub294 \ub0b4\ubd80 \ube4c\ub4dc\ud31c 30\ub178\ub4dc \uae30\uc900 12h -&gt; 4h \uc774\ub2e4. \uc644\uc131 \uc790\uc0b0\uc744 \uae30\ub2a5 \ub2e8\uc704 Package\ub85c \ubb36\uace0, \uc9c0\uc5ed, \ud50c\ub7ab\ud3fc\ubcc4 \uc554\ud638\ud654 \uaddc\uce59\uc744 \ubd99\uc5ec \ub7f0\ucc98\uac00 \uc628-\ub514\ub9e8\ub4dc \uc2a4\ud2b8\ub9ac\ubc0d\uc744 \ud55c\ub2e4. \uc0b0\ucd9c\ubb3c \uc704\uce58\ub294 Compiled//.bin\ub85c \ucd94\uc815."},{"location":"1-ow/#_3","title":"\uc18c\uc2a4 \ud3f4\ub354 \uad6c\uc870","text":"<pre><code>Overwatch/\n\u251c\u2500 Engine/                 # \ub7f0\ud0c0\uc784 \ucf54\uc5b4\n\u2502   \u251c\u2500 Core/               # \uba54\ubaa8\ub9ac, Job, Math, ECS Core\n\u2502   \u251c\u2500 Graphics/           # DX12/Vulkan \ub80c\ub354\ub7ec\n\u2502   \u251c\u2500 Physics/\n\u2502   \u251c\u2500 Audio/\n\u2502   \u2514\u2500 Platform/\n\u251c\u2500 Game/                   # ECS \uc2dc\uc2a4\ud15c\u00b7\ucef4\ud3ec\ub10c\ud2b8\u00b7\uc2a4\ud0b4\n\u2502   \u251c\u2500 Heroes/\n\u2502   \u2502   \u2514\u2500 Tracer/\n\u2502   \u251c\u2500 Abilities/\n\u2502   \u2514\u2500 PvE/\n\u251c\u2500 Network/                # \ud504\ub808\uc784 \uc2a4\ub0c5\uc0f7, \ub864\ubc31, \uc608\uce21\n\u251c\u2500 Tools/\n\u2502   \u251c\u2500 TED/                # \uc6d4\ub4dc\u00b7\uc2a4\ud06c\ub9bd\ud2b8 \uc5d0\ub514\ud130 GUI\n\u2502   \u251c\u2500 DataBuild/          # \uba54\uc778 \ud30c\uc774\ud504\ub77c\uc778 \uc2e4\ud589\ud30c\uc77c\n\u2502   \u2502   \u2514\u2500 Builders/       # *.Builder.dll per asset-type\n\u2502   \u251c\u2500 Generators/         # Structured-Data codegen\n\u2502   \u251c\u2500 BranchManager/\n\u2502   \u2514\u2500 PackageManager/\n\u251c\u2500 CI/\n\u2502   \u2514\u2500 DataBuildCI/\n\u251c\u2500 Content/                # \u2018\uc18c\uc2a4\u2019 \uc790\uc0b0(PSD, FBX, WAV\u2026)\n\u2514\u2500 BuildScripts/           # CMake/SCons + \ud37c\ube14\ub9ac\uc154 \uc2a4\ud06c\ub9bd\ud2b8\n</code></pre>"},{"location":"1-ow/#_4","title":"\ub0b4\ub824\ubc1b\ub294 \ud30c\uc77c","text":"<p>\uc2e4\uc81c\ub85c \uc6b0\ub9ac\uac00 \ub0b4\ub824\ubc1b\ub294 \ud30c\uc77c\uc740 \uc2e4\ud589 \ud30c\uc77c\uacfc \ub77c\uc774\ube0c\ub7ec\ub9ac,  CASC \ub370\uc774\ud130 \uc544\uce74\uc774\ube0c, \uc778\ub371\uc2a4, \ub7f0\ucc98 \uba54\ud0c0\ub370\uc774\ud130\uac00 \ub2e4\uc774\ub2e4.</p> <p>\uc2e4\ud589 \ud30c\uc77c: C/C++\ub85c \ucef4\ud30c\uc77c\ub41c \ud074\ub77c\uc774\uc5b8\ud2b8, \ub7f0\ucc98 \ucf54\ub4dc. Overwatch/Overwatch.exe \ub77c\uc774\ube0c\ub7ec\ub9ac: .dll CASC: Content Addressable Storage Container\ub85c, \ube14\ub9ac\uc790\ub4dc\uac00 MPQ\ub97c \ub300\uccb4\ud574 \uc0ac\uc6a9\ud558\ub294 \ud328\ud0a4\uc9c0 \ud3ec\ub9f7\uc73c\ub85c, \ud30c\uc77c \ub369\uc5b4\ub9ac\ub97c '\ucf58\ud150\uce20 \ud574\uc2dc' \uae30\uc900\uc73c\ub85c \uc800\uc7a5, \uc2a4\ud2b8\ub9ac\ubc0d\ud55c\ub2e4. \uc601\uc6c5 \ubaa8\ub378, \uc0ac\uc6b4\ub4dc, \ub9f5 \ub4f1 asset\uc774 \uc554\ud638\ud654\ub41c \ucc44\ub85c \uc800\uc7a5\ub418\uc5b4 \uc788\ub2e4. \uc124\uce58\uae30(Battle.net) &lt;-&gt; \uac8c\uc784 \uc2e4\ud589 \uc2dc \ub3d9\uc77c \uad6c\uc870\ub97c \uacf5\uc720\ud574 \uc99d\ubd84 \ud328\uce58\uac00 \ube60\ub974\ub2e4. Overwatch/data/casc/data/\u2026 \uc778\ub371\uc2a4: CASC \ube14\ub85d-\ud574\uc2dc\uc640 \uc2e4\uc81c \uc704\uce58\ub97c \ub9e4\ud551\ud55c\ub2e4. \u2026/casc/indices/.idx \ub7f0\ucc98 \uba54\ud0c0\ub370\uc774\ud130: \ubc84\uc804, CDN \uc704\uce58, \ud574\uc2dc \ubaa9\ub85d (TACT \ud504\ub85c\ud1a0\ucf5c). *.build.info, *.product.db</p> <p>\uc124\uce58\ub098 \uc5c5\ub370\uc774\ud2b8 \ud750\ub984\uc740 \ub2e4\uc74c\uacfc \uac19\ub2e4. <pre><code>i. Battle.net \uc571\uc5d0\uc11c '\uc124\uce58' \ubc84\ud2bc\uc744 \ub204\ub974\uba74 TACT \ud504\ub85c\ud1a0\ucf5c\ub85c \ubc84\uc804, \ud574\uc2dc \ubaa9\ub85d\uc744 \ubc1b\uc544\uc634\nii. \ud074\ub77c\uc774\uc5b8\ud2b8\ub294 CDN\uc5d0\uc11c \ucef4\ud30c\uc77c\ub41c \uc2e4\ud589 \ud30c\uc77c\uacfc CASC \uc870\uac01\uc744 \ub0b4\ub824\ubc1b\uc74c\niii. \ubc1b\uc740 \uc870\uac01\uc740 Overwatch/data/casc \uc544\ub798\uc5d0 \uc800\uc7a5\ub418\uace0, \uc778\ub371\uc2a4, \uc800\ub110(*.idx,shmem) \ud30c\uc77c\uc5d0 \uc704\uce58\uac00 \uae30\ub85d\ub428\niv. \uc2e4\ud589 \uc2dc \ub7f0\ucc98\uac00 \ubb34\uacb0\uc131 \uac80\uc0ac(\ud574\uc2dc-&gt;\ube14\ub85d \ud655\uc778) \ud6c4 \uc2e4\ud589.\n</code></pre></p> <p>\uadf8\ub9ac\uace0 \uc774\uc870\ucc28 \uc624\ubc84\uc6cc\uce58 1\uacfc 2\uc5d0 \ucc28\uc774\ub97c \ubcf4\uc778\ub2e4.</p> \ud56d\ubaa9 Overwatch (2016) Overwatch 2 (2022\\~) \uc5d4\uc9c4 \ucf54\uc5b4 Team 4 \ub3c5\uc790 ECS \uc5d4\uc9c4 v1.0 v1.5 \u2013 \ub3d9\uc77c \ucf54\ub4dc\ubca0\uc774\uc2a4\ub97c \ud655\uc7a5\u00b7 \uba40\ud2f0\uc2a4\ub808\ub4dc \ub80c\ub354 \ud30c\uc774\ud504\ub77c\uc778\u00b7 \ubb3c\ub9ac\u00b7\ud30c\ud2f0\ud074 \ucd5c\ub300\uce58 \uc0c1\ud5a5\u00b7 \ub3d9\uc801 \uc870\uba85\u00b7PBR \uc7ac\uc9c8 \ucd94\uac00 \ub9f5/\uc790\uc0b0 \uaddc\ubaa8 \ud3c9\uade0 100 \u00d7 100 m, 6v6 \uc804\uc81c PvE\uc6a9 3\\~5\ubc30 \ub300\ud615 \ub9f5, \uc2a4\ud06c\ub9bd\ud2b8\ud615 \uc774\ubca4\ud2b8, \ub3d9\uc801 \uae30\uc0c1 \ud6a8\uacfc DataBuild \ud30c\uc774\ud504\ub77c\uc778 203 \ud0c0\uc785, \ubd84\uc0b0 \ube4c\ub4dc 30 \ub178\ub4dc/4 h \u2248250 \ud0c0\uc785(+Perk\u00b7Cinematic \ub4f1), \uc77c\ubd80 GPU \uc804\uc6a9 \ube4c\ub354-DLL \uc2e0\uc124\u00b7CUDA \ud65c\uc6a9 Generator(SDLang \u2192 \ucf54\ub4dc) 1,700\uc5ec \uad6c\uc870\uccb4 Hero Perks/Progression \ub4f1 \uc2e0\uaddc \uc2a4\ud0a4\ub9c8 \uc790\ub3d9\uc0dd\uc131 \ud328\ud0a4\uc9d5\u00b7\ubc30\ud3ec CASC v2 + TACT, SHA-1 \uc554\ud638\ud654 CASC v3 (AES-CTR 128 bit) \u00b7 \uc99d\ubd84 \uc2a4\ud2b8\ub9ac\ubc0d \ucd5c\uc801\ud654 \ud074\ub77c\uc774\uc5b8\ud2b8 \uaddc\ubaa8(PC) \uc124\uce58 25 \\~ 30 GB \uc2dc\uc98c 15 \uae30\uc900 \u224852 GB, \ud328\uce58 \uc2dc \uc99d\ubd84 \ub2e4\uc6b4\ub85c\ub4dc"},{"location":"1-ow/#_5","title":"\uc5d4\uc9c4","text":"<p>\uc5d4\uc9c4\uc740 \uac8c\uc784\uc774 \uc2e4\uc2dc\uac04\uc73c\ub85c \uc9c4\ud589\ub418\ub294 \ucf54\ub4dc\uc774\ub2e4. ECS(Entitiy-Component-System) \uae30\ubc18 \uc2dc\ubbac\ub808\uc774\uc158 \ub8e8\ud504, \ub80c\ub354\ub7ec, \ubb3c\ub9ac, \uc624\ub514\uc624, \ud50c\ub7ab\ud3fc \ub798\ud37c \ub4f1\uc73c\ub85c \uad6c\uc131\ub418\uc5b4 \uc788\ub2e4.</p> <p>\uc774\ub54c \uc5d4\uc9c4\uc758 \ud575\uc2ec \ud2b9\uc9d5\uc740 ECS + Network-deterministic \uc2dc\ubbac\ub808\uc774\uc158\uc774\ub77c\ub294 \uac83\uc774\ub2e4. \ubaa8\ub4e0 \ud074\ub77c\uc774\uc5b8\ud2b8, \uc11c\ubc84\uac00 \ud2f1 \ub2e8\uc704\ub85c \uac19\uc740 \uacc4\uc0b0\uc744 \uc7ac\ud604\ud558\ub3c4\ub85d \uc124\uacc4\ub418\uc5b4 \uc785\ub825\ub9cc \ub3d9\uae30\ud654\ud558\uba74 \uacb0\uacfc\uac00 \uc77c\uce58\ud55c\ub2e4.</p> <p>ECS? Entity/Component/System \uc138\uac00\uc9c0 \ucd95. Entity: \uace0\uc720 ID, \uc0dd\uba85\uc8fc\uae30, \ud3ed\ubc1c \uad6c\uc5ed, \uc601\uc6c5 \ud55c\uba85, \ud22c\uc0ac\uccb4 \ub4f1 \ub370\uc774\ud130\ub098 \ub17c\ub9ac\uac00 \uc5c6\ub294 \uac83\ub4e4. \uba54\ubaa8\ub9ac\uc5d0\uc11c 32-bit \ud578\ub4e4(\uc778\ub371\uc2a4+\uc138\ub300) \ubc30\uc5f4\uc774\ub2e4. Component: \uc21c\uc218 \ub370\uc774\ud130(POD)\ub85c \uc704\uce58(transform), HP(health), \ucd1d\uc54c\uc218(weaponstate). \uba54\ubaa8\ub9ac\uc5d0\uc11c SoA(Structure of Arrays)\ub85c \uce90\uc2dc \uce5c\ud654\uc774\ub2e4. System: \ub9e4 \ud2f1\ub9c8\ub2e4 \ud544\uc694 Component \uc14b\uc744 \uac00\uc9c4 Entity \uc2a4\ud2b8\ub9bc\uc744 \uc2a4\uce94\ud574 \ub85c\uc9c1\uc744 \uc2e4\ud589\ud55c\ub2e4. MovementSystem(transform+Physics), WeaponSystem(weaponstate+input) \ub4f1\uc774\ub2e4. \uba54\ubaa8\ub9ac\uc5d0\uc11c \ub2e4\uc911 \uc2a4\ub808\ub4dc/Job \ud050\ub85c \ubcd1\ub82c \ucc98\ub9ac\ud55c\ub2e4.</p> <p>\uc804\ud1b5\uc11d\uc778 \uc0c1\uc18d \uacc4\uce35(OOP)\uacfc\ub294 \ud655\uc2e4\ud788 \ub2e4\ub978 \ubd84\ub9ac\ub85c \ucf54\ub4dc \ubcf5\uc7a1\ub3c4\uac00 \ub0ae\ub2e4.</p> <p>\ub124\ud2b8\uc6cc\ud06c \uacb0\uc815\ub860? \ubaa8\ub4e0 \ucc38\uac00\uc790\uac00 \uac19\uc740 \ucd08\uae30 \uc0c1\ud0dc\uc5d0\uc11c \uac19\uc740 \uc2dc\uc810\ubcc4 \uc785\ub825 \uc2dc\ud000\uc2a4\ub9cc \uacf5\uc720\ud558\uba74, \uac01\uc790\uc758 PC\uc5d0\uc11c \ub3cc\ub9b0 \uacb0\uacfc\uac00 \ubc14\uc774\ud2b8 \ub2e8\uc704\uae4c\uc9c0 \ub3d9\uc77c\ud558\uac8c \uc7ac\ud604\ub41c\ub2e4.</p> <p>\uc989 \ud074\ub77c\uc774\uc5b8\ud2b8\ub294 \ub9e4 \ud2f1(63hz \uc989 15.9ms) \uc785\ub825\uac12 \uc218\ubc14\uc774\ud2b8\ub97c \uafb8\uc900\ud788 \ubcf4\ub0b8\ub2e4. 63 Hz 'high-bandwidth' \uc11c\ubc84\uac00 \uc774\ub97c \ubc1b\ub294\ub2e4. \uc11c\ubc84\ub294 \ubaa8\ub450\uc758 Command[N]\uc744 \ubaa8\uc544 \uad8c\uc704 \uc2dc\ubbac\ub808\uc774\uc158\uc744 \ub3cc\ub9b0\ub2e4. \uadf8 \uacb0\uacfc\ub97c delta \uc2a4\ub0c5\uc0f7\uc73c\ub85c \uac01 \ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0 \ubc30\ud3ec\ud55c\ub2e4. \ud074\ub77c\uc774\uc5b8\ud2b8\ub294 \uc790\uc2e0\uc774 \ubbf8\ub9ac \ub3cc\ub9b0 \ub85c\uceec \uc608\uce21\uacfc \ube44\uad50\ud574 \ud544\uc694\ud558\uba74 \ubbf8\uc138 \ub864\ubc31/\ubcf4\uc815\ub9cc \uc218\ud589\ud55c\ub2e4.</p> <p>\ub530\ub77c\uc11c \uc790\uc2e0\uc758 \uc6c0\uc9c1\uc784\uc740 \uc785\ub825 \uc2dc\uc810\uc5d0 \ub3cc\uc544\uac00\uace0 \ub2e4\ub978 \ud50c\ub808\uc774\uc5b4\ub294 \uc0b4\uc9dd \uacfc\uac70(\uc57d 50ms)\ub97c \uc7ac\uc0dd\ud558\uace0 \uc788\ub294 \uac83\uc774\ub2e4. \uc11c\ubc84\uc758 \uc2a4\ub0c5\uc0f7\uc744 \uae30\uc900\uc73c\ub85c \ub9d0\ud558\uba74 \ub0b4 \uce90\ub9ad\uc740 \uc55e\uc73c\ub85c 1/2 RTT\uc815\ub3c4 \uc55e\uc11c \ub2ec\ub9ac\uace0, \uc0c1\ub300 \uce90\ub9ad\ud130\ub294 \uacfc\uac70 1/2 RTT\uc815\ub3c4\ub97c \uc7ac\uc0dd\ud558\ub294 \uac83\uc774\ub2e4.</p> <p>\ucc38\uace0/ \uacb0\uc815\ub860\uc744 \uc720\uc9c0\ud558\uae30 \uc704\ud574 \uace0\uc815 \ud2f1 \ub808\uc774\ud2b8, \ubd80\ub3d9\uc18c\uc218\uc810\uacfc \uc5f0\uc0b0 \uc21c\uc11c \ud1b5\uc81c, \ubb34\uc791\uc704 \uc694\uc18c\ub294 \uc804\uc5ed \uc2dc\ub4dc PRNG \uc0ac\uc6a9, \ucef4\ud3ec\ub10c\ud2b8 \uc21c\uc11c \uace0\uc815, command\uc5d0 Tick ID \ud3ec\ud568.</p>"},{"location":"1-ow/#command","title":"command \ud328\ud0b7","text":"<p>\ud074\ub77c\uc774\uc5b8\ud2b8-&gt;\uc11c\ubc84 command \ud328\ud0b7 \ud615\uc2dd</p> \ud544\ub4dc \uc555\ucd95\u00b7\ube44\ud2b8\uc218 \uc124\uba85 <code>tickId</code> 16 bit \uc774 \uba85\ub839\uc774 \uc801\uc6a9\ub420 ECS \ud2f1(63 Hz\uba74 0.0159 s) <code>buttons</code> 16 bit LMB\u2006/\u2006Shift\u2006/\u2006Ability\u20061\u00b72\u00b7Ult \ub4f1 \u2015 \ube44\ud2b8\ud50c\ub798\uadf8 <code>moveX, moveY</code> \uac01\uac01 8 bit WASD \ucd95, -127\\~127 \uc815\uaddc\ud654 <code>yaw, pitch</code> \uac01\uac01 13 bit 0-360\u00b0, 0-\u00b189\u00b0 \uc591\uc790\ud654 <code>heroPayload</code> \uac00\ubcc0 (\uc608) \uba54\uc774 \uc5bc\uc74c\ubcbd \ub192\uc774, \uc790\ub9ac\uc57c \ucda9\uc804\ub7c9\u2026 \uc911\ubcf5 \uba85\ub839 \u0394-\uc555\ucd95 \uc9c1\uc804 3 \ud2f1 \uc785\ub825\uc744 diff \ud615\ud0dc\ub85c \ucd94\uac00\ud574 \ud328\ud0b7 \uc190\uc2e4 \ub300\ube44 <p>\uc2e4\uc81c \uae30\uc900 11-15B \uc815\ub3c4\ub85c \ub9e4\uc6b0 \uc791\uc74c \ud5e4\ub354\uc5d0\ub294 seq/ack \ubc88\ud638\uc640 \uc11c\ubc84 \uc2a4\ub0c5\uc0f7 ack(\ub0b4\uac00 N\ubc88\uc9f8 \uacb0\uacfc\uae4c\uc9c0 \ubc1b\uc558\ub2e4)\uac00 \ud568\uaed8 \ub4e4\uc5b4 \uc788\ub2e4.</p> <p>\ubb3c\ub9ac\uc801 \uc804\uc1a1 \uacc4\uce35  \ud504\ub85c\ud1a0\ucf5c\uc740 battle.net \uc2e4\uc2dc\uac04 \uc2a4\ud2b8\ub9bc\uc73c\ub85c UDP+\uc790\uccb4 \uc7ac\uc804\uc1a1/\uc554\ud638\ud654 \ub808\uc774\uc5b4. \uc8fc \uc0ac\uc6a9 \ud3ec\ud2b8\ub294 UDP 5060,5062,6250,3478,3479,12000~64000 \uacfc TCP 1119,3724,6113. \ubcf4\uc548\uc740 \uc138\uc158 \ud578\ub4dc\uc170\uc774\ud06c \ub4a4 AES-CTR \ud0a4 \ub9c1\uc73c\ub85c \uc678\ubd80 \ucd94\ucd9c \ucc28\ub2e8.</p> <p>\uc11c\ubc84 \uce21 \ucc98\ub9ac \ud750\ub984. <pre><code>for every tick N:\n    cmds = gatherCommandsFromClients(N)      // \uc5c6\uc73c\uba74 N-1 \uc785\ub825 \uc7ac\uc0ac\uc6a9\n    runAllECSSystems(cmds)                   // \uacb0\uc815\ub860 \uc2dc\ubbac\ub808\uc774\uc158\n    delta = makeSnapshotDelta(prev, current)\n    sendSnapshotToEachClient(delta, ack=N)   // \uc644\uc131\ub41c \uc2a4\ub0c5\uc0f7\uc744 UDP\ub85c \uc804\uc1a1\n</code></pre></p>"},{"location":"1-ow/#_6","title":"\uc2a4\ub0c5\uc0f7 \ud328\ud0b7","text":"<p>\uc11c\ubc84-&gt;\ud074\ub77c\uc774\uc5b8\ud2b8 \uc2a4\ub0c5\uc0f7 \ud615\uc2dd</p> <p>100 ~ 200 \ubc14\uc774\ud2b8. \ubc14\uc774\ud2b8 \uc2a4\ud2b8\ub9bc \uc804\uccb4\uac00 AES-CTR\ub85c \uc554\ud638\ud654\ub3fc \uc788\ub2e4. A\uce35 \ud5e4\ub354. 6-8B</p> \ud544\ub4dc \ube44\ud2b8\uc218 \uc124\uba85 <code>snapshotSeq</code> 16 \uc774\ubc88 \uc2a4\ub0c5\uc0f7\uc758 \uc5f0\uc18d \ubc88\ud638 <code>baselineSeq</code> 16 \u201c\uc774 \ubc88\ud638\uae4c\uc9c0\ub294 \ud074\ub77c\uac00 \ubc1b\uc558\ub2e4\uace0 \ud655\uc815\u201d\u2014\u2006\ub378\ud0c0\uc758 \uae30\uc900 \ud2f1 <code>ackBits</code> 32 \ucd5c\uadfc 32\uac1c \uc2a4\ub0c5\uc0f7 \uc218\uc2e0 \ud655\uc778 \ube44\ud2b8-\ud544\ub4dc <code>flags</code> 8 \uc555\ucd95(LZ4), \uc804\uccb4\uc2a4\ub0c5\uc0f7 \uc5ec\ubd80 \ub4f1 <p>B\uce35 entity \ud14c\uc774\ube14. 5-40B Create/Update/Delete \ube44\ud2b8 \ub9c8\uc2a4\ud06c + \uc5d4\ud2f0\ud2f0 ID \uac00\ubcc0\uae38\uc774 VLQ  ID\ub294 EntityIndex &lt;&lt; 6 | GenerationBits(6) \ud615\ud0dc\ub97c 7bit VLQ\ub85c \uc555\ucd95.</p> <p>C\uce35 Component \u0394\ube14\ub85d(entity\ubcc4\ub85c 1~100B).</p> \uc21c\uc11c \ub0b4\uc6a9 \uc778\ucf54\ub529 \ubc29\uc2dd\u00b7\ube44\ud2b8\uc218 \uc608 \u2460 <code>updateMask</code> \uc774 \uc5d4\ud2f0\ud2f0\uc5d0\uc11c \ubc14\ub010 \ucef4\ud3ec\ub10c\ud2b8 \ube44\ud2b8\ud544\ub4dc \ucd5c\ub300 16 \ube44\ud2b8 \u2461 \ucef4\ud3ec\ub10c\ud2b8 \uc778\ub371\uc2a4 \ubc14\ub010 \uac83\ub9cc \uc21c\ucc28 \uae30\ub85d \uac00\ubcc0(\u0394-VLQ) \u2462 \ud544\ub4dc\ubcc4 \u0394 \uac12\ub9c8\ub2e4 \uac1c\ubcc4 \uc591\uc790\ud654 \uc608) \uc704\uce58 X/Y/Z \u2192 16\u00b716\u00b714 bitYaw/Pitch \u2192 13\u00b79 bitHP \u2192 10 bit (0-1023) <p>\uc989 \ud55c\ubc88\uc5d0 \ud45c\ud604\ud558\uc790\uba74 [UDP]    |Header|E-Tbl|\u0394Comp(Entity #17)|\u0394Comp(Entity #42)|\u2026                 \u25b2 \uc555\ucd95(LZ4) \u25b2 <p>\ud074\ub77c\uc774\uc5b8\ud2b8 \uc218\uc2e0-&gt;\ub864\ubc31/\uc7ac\uc801\uc6a9 \ub85c\uceec \uc608\uce21 \uacb0\uacfc\uc640 \ube44\uad50\ud574 \ucc28\uc774\uac00 \ub098\uba74 \ub864\ubc31.</p> <p>\uc2a4\ub0c5\uc0f7 \ud328\ud0b7 \ub0b4\ubd80\ub97c \uae4c\ubcfc \uc218 \uc788\ub098?</p> <pre><code>OW1 \u2013 \uc77c\ubd80 \ud0a4\uac00 \uacf5\uac1c\ub3fc \uc788\uc5b4 CascView + OverTool \ub85c \uc81c\ud55c\uc801 \ub514\ucf54\ub529 \uac00\ub2a5.\n\nOW2 (CASC v3 + Key-Ring) \u2013 AES-CTR \ud0a4\uac00 \uc11c\ubc84\uc5d0\uc11c \ub3d9\uc801 \uad50\ud658 \u2192 \uc678\ubd80 \ucd94\ucd9c \ub09c\ub3c4 \u2191.\n\ub530\ub77c\uc11c Wireshark\ub85c\ub294 \ud5e4\ub354 \uae38\uc774\u00b7Sequence/ACK \ud544\ub4dc\ub9cc \ubcf4\uc774\uace0,\n\uc5d4\ud2f0\ud2f0 Table\u00b7\ucef4\ud3ec\ub10c\ud2b8 \u0394-\ube14\ub85d\uc740 \uc804\ubd80 \uc554\ud638\ud654\ub41c \ubc14\uc774\ud2b8 \uc2a4\ud2b8\ub9bc\uc785\ub2c8\ub2e4.\n</code></pre>"},{"location":"1-ow/#api","title":"&gt; API","text":"<p>api? \uc18c\ud504\ud2b8\uc6e8\uc5b4\ub07c\ub9ac \uc57d\uc18d\ud55c \ub300\ud654 \uaddc\uce59\uc774\ub2e4. \uc5b4\ub5a4 \ud504\ub85c\uadf8\ub7a8\uc774 \ub2e4\ub978 \uae30\ub2a5\uc744 \ud638\ucd9c\ud558\uac70\ub098 \uc81c\uc5b4\ud560 \uc218 \uc788\ub3c4\ub85d \uc774\ub984, \uc785\ub825, \ubc18\ud658, \ub3d9\uc791\uc774 \ubb38\uc11c\ud654\ub41c \uc778\ud130\ud398\uc774\uc2a4.</p> <p>\uc624\ubc84\uc6cc\uce58\uc5d0\uc11c \uc0ac\uc6a9\ud558\ub294 api?</p> \uad6c\uc5ed \ubb34\uc5c7\uc744 \ucea1\ucc98\ud560 \uc218 \uc788\ub098 \uc554/\ubcf5\ud638\ud654 \uac00\ub2a5\uc131 \ucd94\ucc9c \ub3c4\uad6c\u00b7\ubc29\ubc95 \u2460 Battle.net HTTP API(\ub85c\uadf8\uc778\u00b7OAuth\u00b7\ub9e4\uce58\uba54\uc774\ucee4\u00b7\ud328\uce58 \uba54\ud0c0) HTTPS - TLS 1.3 TLS\u2015\ube0c\ub77c\uc6b0\uc800\uc640 \ub3d9\uc77c.\ud074\ub77c\uc5d0 Pinning \uc5c6\uc74c \u2192 <code>SSLKEYLOGFILE</code> + Wireshark\ub85c \ubcf5\ud638\ud654 \uac00\ub2a5 (\uc708\ub3c4\uc6b0 Schannel \uae30\ubc18) 1. \ud658\uacbd\ubcc0\uc218 <code>SSLKEYLOGFILE=%USERPROFILE%\\tls.keys</code> \uc124\uc8152. Wireshark \u25b8 TLS \u25b8 (Pre-)Master-Secret log \uacbd\ub85c \uc9c0\uc8153. \ud544\ud130 <code>tcp.port==443 &amp;&amp; tls.handshake.extensions_server_name contains \"battle.net\"</code> \u2461 TACT/CDN \ub2e4\uc6b4\ub85c\ub4dc(CASC *.data, *.idx, root/encoding) \uc21c\uc218 HTTP GET \ud3c9\ubb38(\ube14\ub85d \uc790\uccb4\ub294 BLTE \uc555\ucd95\u00b7AES \uac00\ub2a5) \u2013 Wireshark <code>http.host contains \"level3.blizzard.com\"</code>\u2013 <code>tactmon</code>, <code>curl -O</code> \ub85c \uc7ac\ud604\u2013 \uc774\ud6c4 \ub85c\uceec \ud30c\uc77c\uc744 CascView / TACTLib\ub85c \ubd84\uc11d \u2462 \uac8c\uc784\ud50c\ub808\uc774 UDP \uc2a4\ud2b8\ub9bc(Command \u2194 Snapshot) \uc804\uc6a9 UDP (\uae30\ubcf8 63 Hz)\ud3ec\ud2b8 5060, 5062, 6250, 12000-64000 AES-CTR \uc804\uad6c\uac04 \uc554\ud638\ud654\ud0a4\ub294 \ub7f0\ud0c0\uc784 \uba54\ubaa8\ub9ac \uc548(OW2 = Key-Ring) \u2192 \uc678\ubd80\uc5d0\uc11c \ubcf5\ud638\ud654 \ubd88\uac00 \u2013 Wireshark <code>udp.port &gt;= 12000 &amp;&amp; udp.port &lt;= 64000</code>\u2013 \u201cFollow \u2192 UDP Stream\u201d\uc73c\ub85c \ud328\ud0b7 \uae38\uc774\u00b7RTT\u00b7\uc190\uc2e4 \ud1b5\uacc4\ub9cc \ud655\uc778\u2013 Payload \ud574\uc11d\uc740 \uc0ac\uc2e4\uc0c1 \ubd88\uac00\ub2a5 (\ud0a4 \ucd94\ucd9c\u00b7\uba54\ubaa8\ub9ac \ud6c4\ud0b9 \ud544\uc694) \u2463 \ud074\ub77c\uc774\uc5b8\ud2b8 \ub85c\uadf8\u00b7\ub85c\uceec \uc0c1\ud0dc <code>Overwatch/Logs/*.log</code> &amp; CASC <code>data/shmem</code>, <code>.idx</code> \ud3c9\ubb38 \ud14d\uc2a4\ud2b8 \ubdf0\uc5b4\u00b7010 Editor <pre><code>1) TLS \ud0a4 \ub85c\uae45\nsetx SSLKEYLOGFILE \"%USERPROFILE%\\tls.keys\"\n\n1) \uad00\ub9ac\uc790 \uad8c\ud55c\uc73c\ub85c Wireshark \uc2e4\ud589\n    - Capture filter: host 137.*.***.*** or udp\n    - TLS \u2023 (Pre-)Master-Secret log: %USERPROFILE%\\tls.keys\n\n 2) Overwatch2 \uc2e4\ud589 \u2192 \ub85c\uadf8\uc778 \u2192 \ud55c \ud310 \ud50c\ub808\uc774\n\n 3) Wireshark\n    a) HTTP \uc2a4\ud2b8\ub9bc: tcp.port==443 &amp;&amp; tls.app_data\n       \u00ad\u2192 Follow TCP Stream \u2192 JSON Body \ud655\uc778\n    b) UDP \uc2a4\ud2b8\ub9bc: udp.port&gt;=12000 &amp;&amp; udp.port&lt;=64000\n      \u00ad\u2192 Statistics \u25b8 I/O Graph \ub85c \ud2f1 \uc8fc\uae30\u00b7\uc190\uc2e4\ub960 \ud655\uc778\n</code></pre>"},{"location":"1-ow/#_7","title":"&gt; \ud074\ub77c\uc6b0\ub4dc \uc2a4\ud2b8\ub9ac\ubc0d \uc11c\ube44\uc2a4","text":"<p>DTLS-UDP \ucc44\ub110\uc5d0 \ucee8\ud2b8\ub864 \ud328\ud0b7\ub9cc \uc2e4\ub824 \uac04\ub2e4. SRTP \ucc44\ub110\uc740 \ubc18\ub300\ub85c \uc11c\ubc84\uac00 \uc778\ucf54\ub529\ud55c \uc601\uc0c1, \uc624\ub514\uc624 \uc2a4\ud2b8\ub9bc\uc744 \ub0b4\ub824\ubcf4\ub0b8\ub2e4.</p>"},{"location":"10-kvmi-v7/","title":"10 kvmi v7","text":""},{"location":"10-kvmi-v7/#kvmi-vmi","title":"KVMI \ubc29\uc2dd\uc73c\ub85c vmi\ub97c \uad6c\ud604\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-12</p>"},{"location":"10-kvmi-v7/#_1","title":"&gt; \uc0ac\uc804 \uc900\ube44","text":"<p>bios \uc124\uc815 <pre><code>VT-x, VT-d \ucf1c\uae30\nSecure boot \ub044\uae30(\uc11c\uba85 \ubb38\uc81c \ud68c\ud53c\uc5d0 \uc720\ub9ac. \ubc14\ub85c \uc548\uaebc\uc9c0\uba74 \ubc14\uc774\uc624\uc2a4 \ube44\ubc88 \uc124\uc815\ud55c \ud6c4 \ub048 \ud6c4 \ube44\ubc88 \ub2e4\uc2dc \uc5c6\uc560\uba74 \ub428)\nvmd controller \ub044\uae30(advanced-main\uc5d0\uc11c ctrl+s \ub20c\ub7ec \ud788\ub4e0\uc635\uc158 \ub744\uc6b0\uba74 \ub428)\ndisplay mode : optimus\n</code></pre> * optimus = igpu \uc9c1\uacb0, dgpu \ub3c4\uc6c0 * dgpu only = dgpu \uc9c1\uacb0 * auto select = \uc704 \ub450\uac1c \uc911\uc5d0 \uc790\ub3d9\uc120\ud0dd</p> <p>\ucee4\ub110\uacfc \ud558\ub4dc\uc6e8\uc5b4 \ud638\ud658 \ubbf8\ub9ac \uc0b4\ud53c\uae30 <pre><code># === \uc2dc\uc2a4\ud15c \uc810\uac80 \ud328\ud0a4\uc9c0(\uc5c6\uc73c\uba74) ===\nsudo apt -y install ethtool mokutil || true\n\necho \"===== CPU =====\"\nlscpu | egrep 'Model name|Vendor ID|Architecture|CPU\\\\(s\\\\)|Thread|Core|Socket'\necho; echo \"===== CPU flags (vmx/ept \ud655\uc778) =====\"\ngrep -m1 '^flags' /proc/cpuinfo | tr ' ' '\\n' | egrep -x 'vmx|svm|ept|npt' | sort -u\n\necho; echo \"===== IOMMU/DMAR (VT-d) =====\"\ndmesg | egrep -i 'DMAR|IOMMU|VT-d' | head -n 50\n\necho; echo \"===== \ubd80\ud305/\uc2dc\ud050\uc5b4\ubd80\ud2b8 =====\"\n[ -d /sys/firmware/efi ] &amp;&amp; echo \"Boot: UEFI\" || echo \"Boot: Legacy\"\nmokutil --sb-state 2&gt;/dev/null || echo \"mokutil not available\"\n\necho; echo \"===== \ucee4\ub110/OS =====\"\nuname -a\ngrep -E 'PRETTY_NAME|VERSION=' /etc/os-release\n\necho; echo \"===== \uba54\uc778\ubcf4\ub4dc/BIOS =====\"\nsudo dmidecode -t baseboard -t bios | egrep -i 'Vendor:|Product Name:|Version:|Release Date:' || true\n\necho; echo \"===== GPU =====\"\nlspci -nnk | grep -A3 -Ei 'vga|3d|display'\n\necho; echo \"===== NIC(\uc774\ub354\ub137/\ubb34\uc120) =====\"\nlspci -nnk | grep -A3 -Ei 'ethernet|network'\n\necho; echo \"===== \uc778\ud130\ud398\uc774\uc2a4\ubcc4 \ub4dc\ub77c\uc774\ubc84 =====\"\nfor i in $(ls /sys/class/net | grep -v lo); do\n  echo \"== $i ==\"; sudo ethtool -i \"$i\" 2&gt;/dev/null || true\ndone\n\n===== CPU =====\nArchitecture:                         x86_64\nVendor ID:                            GenuineIntel\nModel name:                           Intel(R) Core(TM) i5-14500HX\nThread(s) per core:                   2\nCore(s) per socket:                   14\nSocket(s):                            1\n\n===== CPU flags (vmx/ept \ud655\uc778) =====\nept\nvmx\n\n===== IOMMU/DMAR (VT-d) =====\ndmesg: read kernel buffer failed: Operation not permitted\n\n===== \ubd80\ud305/\uc2dc\ud050\uc5b4\ubd80\ud2b8 =====\nBoot: UEFI\nSecureBoot disabled\n\n===== \ucee4\ub110/OS =====\nLinux acer 6.14.0-27-generic #27~24.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue Jul 22 17:38:49 UTC 2 x86_64 x86_64 x86_64 GNU/Linux\nPRETTY_NAME=\"Ubuntu 24.04.3 LTS\"\nVERSION=\"24.04.3 LTS (Noble Numbat)\"\n\n===== \uba54\uc778\ubcf4\ub4dc/BIOS =====\n    Vendor: Insyde Corp.\n    Version: V1.14\n    Release Date: 09/19/2024\n    Product Name: EQE_RTX\n    Version: V1.14\n\n===== GPU =====\n00:02.0 VGA compatible controller [0300]: Intel Corporation Raptor Lake-S UHD Graphics [8086:a788] (rev 04)\n    Subsystem: Acer Incorporated [ALI] Raptor Lake-S UHD Graphics [1025:1731]\n    Kernel driver in use: i915\n    Kernel modules: i915, xe\n--\n01:00.0 VGA compatible controller [0300]: NVIDIA Corporation AD107M [GeForce RTX 4060 Max-Q / Mobile] [10de:28e0] (rev a1)\n    Subsystem: Acer Incorporated [ALI] AD107M [GeForce RTX 4060 Max-Q / Mobile] [1025:1731]\n    Kernel driver in use: nvidia\n    Kernel modules: nvidiafb, nouveau, nvidia_drm, nvidia\n\n===== NIC(\uc774\ub354\ub137/\ubb34\uc120) =====\n00:14.3 Network controller [0280]: Intel Corporation Raptor Lake-S PCH CNVi WiFi [8086:7a70] (rev 11)\n    Subsystem: Rivet Networks Device [1a56:1672]\n    Kernel driver in use: iwlwifi\n    Kernel modules: iwlwifi\n00:15.0 Serial bus controller [0c80]: Intel Corporation Raptor Lake Serial IO I2C Host Controller #0 [8086:7a4c] (rev 11)\n--\n44:00.0 Ethernet controller [0200]: Realtek Semiconductor Co., Ltd. Killer E3000 2.5GbE Controller [10ec:3000] (rev 06)\n    Subsystem: Acer Incorporated [ALI] Killer E3000 2.5GbE Controller [1025:1731]\n    Kernel driver in use: r8169\n    Kernel modules: r8169\n\n===== \uc778\ud130\ud398\uc774\uc2a4\ubcc4 \ub4dc\ub77c\uc774\ubc84 =====\n== enp68s0 ==\ndriver: r8169\nversion: 6.14.0-27-generic\nfirmware-version: rtl8125b-2_0.0.2 07/13/20\nexpansion-rom-version: \nbus-info: 0000:44:00.0\nsupports-statistics: yes\nsupports-test: no\nsupports-eeprom-access: no\nsupports-register-dump: yes\nsupports-priv-flags: no\n== wlp0s20f3 ==\ndriver: iwlwifi\nversion: 6.14.0-27-generic\nfirmware-version: 89.202a2f7b.0 so-a0-gf-a0-89.uc\nexpansion-rom-version: \nbus-info: 0000:00:14.3\nsupports-statistics: yes\nsupports-test: no\nsupports-eeprom-access: no\nsupports-register-dump: no\nsupports-priv-flags: no\n</code></pre> * kvm-vmi\uc5d0\uc11c \uc644\ubcbd\ud558\uac8c \uad6c\uc131\ud574\ub193\uc740 v7 \uae30\uc900\uc73c\ub85c\ub294 5.4 \ucee4\ub110\uc774 \ube4c\ub4dc\ub420\ud150\ub370 \ub0b4 \ub124\ud2b8\uc6cc\ud06c \uce69\uc14b\uc774 \ub108\ubb34 \ucd5c\uc2e0\uc774\ub77c \ub4dc\ub77c\uc774\ubc84 \ubbf8\uc874\uc7ac. dkms \ubc31\ud3ec\ud2b8 \ube4c\ub4dc\ub97c \ud574\uc57c \ud558\ub294\ub370 \ubb34\uc120 \ub79c\uc120\uc740 \ubcf5\uc7a1\ud568. \ub530\ub77c\uc11c \uc720\uc120\ub79c\uc120 Realtek Killer E3000 (10ec:3000)\uc744 \uc704\ud55c r8125 \ub4dc\ub77c\uc774\ubc84\ub97c \ubbf8\ub9ac \uc900\ube44. </p> <p>iommu \ud0a4\uae30 <pre><code>$ sudo dmesg | grep -i -e iommu -e dmar\n\ubb50\ub77c\uace0 \ub728\uc9c0\ub9cc IOMMU enable\uc740 \uc5c6\uc74c\n$ sudo sed -i 's/^\\(GRUB_CMDLINE_LINUX_DEFAULT=\"[^\"]*\\)\"/\\1 intel_iommu=on iommu=pt\"/' /etc/default/grub\n$ sudo update-grub\n$ sudo reboot\n$ sudo dmesg | grep -i -e iommu -e dmar\n\uc544\uae4c\ub791 \ub2e4\ub974\uac8c IOMMU enable \uc788\uc74c\n</code></pre></p> <p>vfio \ubaa8\ub4c8 \uc790\ub3d9 \ub85c\ub4dc <pre><code>$ lsmod | grep vfio\n$ echo -e \"vfio\\nvfio_pci\\nvfio_iommu_type1\\nvfio_virqfd\" | sudo tee /etc/modules-load.d/vfio.conf\n$ sudo update-initramfs -u\n$ sudo reboot\n$ lsmod | grep vfio\nvfio_pci               16384  0\nvfio_pci_core          94208  1 vfio_pci\nirqbypass              12288  2 vfio_pci_core,kvm\nvfio_iommu_type1       49152  0\nvfio                   69632  3 vfio_pci_core,vfio_iommu_type1,vfio_pci\niommufd               118784  1 vfio\n</code></pre> * \ub9cc\uc57d \uc790\ub3d9\uc774 \uc544\ub2cc \uc218\ub3d9\uc73c\ub85c \ud0ac\uac70\uba74 \ub9e4\ubc88 sudo modprobe vfio vfio_pci vfio_iommu_type1 vfio_virqfd</p> <p>r8125 \ub4dc\ub77c\uc774\ubc84 \ub2e4\uc6b4\ubc1b\uc544\ub193\uae30 <pre><code>mkdir -p ~/drivers/r8125\nhttps://www.realtek.com/Download/List?cate_id=584 \ub4e4\uc5b4\uac00 2.5G Ethernet LINUX driver r8125 (r8125-9.016.00.tar.bz2) \ub2e4\uc6b4. \uc704 \ud3f4\ub354\uc5d0 \uc62e\uaca8\ub193\uae30\n</code></pre></p>"},{"location":"10-kvmi-v7/#kvm-vmi-v7","title":"&gt; kvm-vmi v7","text":"<p>kvm-vmi? vmi\ub97c \uc2e4\ud589\ud560 \uc218 \uc788\ub3c4\ub85d \ucee4\ub110(kvm), QEMU(qemu), libkvmi, libvmi \uac01 \ub808\ud3ec \ubc84\uc804\uc744 \ub9de\ucdb0 \ubaa8\uc544\ub454 \ub808\ud3ec. \uae30\uc874\uc5d0 \uc788\ub294 qemu/kvm\uc740 \uae30\ub2a5\ub3c4 \uc801\uace0 \ud638\ud658 \ubb38\uc81c\uac00 \ud130\uc9c0\ub2c8 \uc774 \ub808\ud3ec\uc5d0 \uc788\ub294 \uc77c\ubc18 generic \ucee4\ub110\uc774 \uc544\ub2cc kvmi+ \uc774 \ucd94\uac00\ub41c kvm \ucee4\ub110\uc744 \ub9cc\ub4e4\uace0 qemu\ub97c \uc124\uce58\ud55c\ub2e4.</p> <p>\ud544\uc218 \ud328\ud0a4\uc9c0 \uc124\uce58 <pre><code>sudo apt update\nsudo apt install -y build-essential git cmake pkg-config \\\n  libvirt-daemon-system libvirt-clients qemu-utils virt-manager ovmf bridge-utils \\\n  libglib2.0-dev libpixman-1-dev zlib1g-dev libspice-server-dev \\\n  check libjson-c-dev libtool autoconf automake bison flex \\\n  libelf-dev libssl-dev dwarves bc fakeroot\nsudo apt install -y \\\n  build-essential git fakeroot bc flex bison libelf-dev libssl-dev \\\n  libncurses-dev dwarves xz-utils\nsudo apt install -y \\\n  libvirt-daemon-system libvirt-clients virt-manager \\\n  ovmf swtpm virtiofsd \\\n  bridge-utils dnsmasq\nsudo usermod -aG libvirt $USER\n</code></pre></p> <p>kvm-vmi \uc18c\uc2a4 \uac00\uc838\uc624\uae30 <pre><code>git clone --recursive https://github.com/KVM-VMI/kvm-vmi.git\n</code></pre></p> <p>kvm(\ucee4\ub110) \uc124\uc815 <pre><code>cd kvm-vmi/kvm\n\n# \uc0b0\ucd9c\ubb3c \ucd08\uae30\ud654\nmake clean\n# config \uc644\uc804 \ucd08\uae30\ud654\nmake mrproper\n\n# x86_64 \uae30\ubcf8\uac12\uc5d0\uc11c \uc2dc\uc791\nmake x86_64_defconfig\n\n# \uc6b0\ubd84\ud22c \ud638\ud658 \uc2a4\uc704\uce58(\uac00\uc774\ub4dc \uae30\uc7ac)\n./scripts/config --enable PREEMPT\n./scripts/config --disable NET_VENDOR_NETRONOME\n\n# \uae30\ubcf8/\ubd80\ud305 \ud544\uc218\n./scripts/config --enable BLK_DEV_INITRD\n./scripts/config --enable DEVTMPFS --enable DEVTMPFS_MOUNT\n./scripts/config --enable PCI --enable PCIEPORTBUS --enable PCI_MSI\n./scripts/config --set-str CONFIG_LOCALVERSION -kvmi\n\n# \uc2a4\ud1a0\ub9ac\uc9c0 (\ub8e8\ud2b8: NVMe)\n./scripts/config --enable NVME_CORE\n./scripts/config --enable BLK_DEV_NVME\n# SATA \uc7a5\uce58\uac00 \uc788\uc73c\uba74:\n./scripts/config --module SATA_AHCI\n# x86\uc5d0 \ubcf4\ud1b5 \ubd88\ud544\uc694\n./scripts/config --disable AHCI_PLATFORM\n# VMD\ub294 BIOS\uc5d0\uc11c \uaebc\ub1a8\uc73c\ub2c8 \ubd88\ud544\uc694\n./scripts/config --disable VMD\n\n# \ud30c\uc77c\uc2dc\uc2a4\ud15c\n./scripts/config --enable EXT4_FS\n./scripts/config --enable CRYPTO_CRC32C   # ext4/jbd2 \uccb4\ud06c\uc12c \uac00\uc18d\n\n# KVMI\n./scripts/config --module KVM\n./scripts/config --module KVM_INTEL\n./scripts/config --enable KVM_INTROSPECTION\n./scripts/config --disable TRANSPARENT_HUGEPAGE\n\n# UEFI(\uc120\ud0dd\uc774\uc9c0\ub9cc \ucf1c\ub3c4 \ubb34\ud574)\n./scripts/config --enable EFI_PARTITION\n./scripts/config --enable EFI_STUB\n\n# \ubd88\ud544\uc694/\ubb38\uc81c \uc18c\uc9c0 \ub4dc\ub77c\uc774\ubc84 \uc81c\uac70\n./scripts/config --disable NET_VENDOR_NETRONOME\n./scripts/config --disable NFP\n# r8169\uc740 r8125\ub85c \ub300\uccb4 \uc608\uc815\uc774\ubbc0\ub85c \ub044\uba74 \uae54\ub054\n./scripts/config --disable R8169\n# \uc624\ub514\uc624\ub294 \ud544\uc694\uc2dc \ubaa8\ub4c8\ub85c\n./scripts/config --module SND_HDA_INTEL\n\n# \ubcc0\uacbd \ubc18\uc601\nmake olddefconfig\n</code></pre> * ssd\uac00 \uc778\uc2dd\ub418\uc9c0 \uc54a\uace0 busybox\ub85c \ub5a8\uc5b4\uc838 \ube4c\ud2b8\uc778\uc73c\ub85c \uad6c\uc131\ud558\uc600\ub2e4.</p> <p>\ube4c\ub4dc(.deb \uc0dd\uc131) \ubc0f \uc124\uce58 <pre><code># CPU \ucf54\uc5b4\uc218\ub9cc\ud07c \ubcd1\ub82c \ube4c\ub4dc\nmake -j\"$(nproc)\" bindeb-pkg WERROR=0 \\\n  KCFLAGS=\"-Wno-error=use-after-free\" \\\n  HOSTCFLAGS=\"-Wno-error=use-after-free\"\n\n# \ube4c\ub4dc \uc0b0\ucd9c\ubb3c\uc740 \ubd80\ubaa8 \ub514\ub809\ud130\ub9ac\uc5d0 \uc0dd\uc131\ub428\ncd ..\nls -1 *.deb\nlinux-headers-5.4.24-kvmi+_5.4.24-kvmi+-1_amd64.deb\nlinux-image-5.4.24-kvmi+_5.4.24-kvmi+-1_amd64.deb\nlinux-libc-dev_5.4.24-kvmi+-1_amd64.deb\n\n# \uc124\uce58\nsudo dpkg -i linux-image-*-kvmi+_*.deb linux-headers-*-kvmi+_*.deb\nsudo update-grub\n</code></pre></p> <p>initramfs\ub780? \ubd80\ud2b8\ub85c\ub354\uac00 \ucee4\ub110\uacfc \ud568\uaed8 \uba54\ubaa8\ub9ac\ub85c \uc62c\ub9ac\ub294 \uc791\uc740 \ub8e8\ud2b8 \ud30c\uc77c\uc2dc\uc2a4\ud15c. cpio \uc544\uce74\uc774\ube0c\uc774\uace0, \ubcf4\ud1b5 gzip/lz4/zstd\ub85c \uc555\ucd95\ub418\uc5b4 \uc788\ub2e4. \uc548\uc5d0\ub294 \ucd08\uae30 \uc0ac\uc6a9\uc790 \uacf5\uac04 busybox, \uc800\uc7a5\uc7a5\uce58/\ud30c\uc77c\uc2dc\uc2a4\ud15c \ub4dc\ub77c\uc774\ubc84 \ubaa8\ub4c8, udev \uaddc\uce59, \uc554\ud638\ud654(LUKS)/RAID/LVM \uc2a4\ud06c\ub9bd\ud2b8 \ub4f1\uc774 \ub4e4\uc5b4 \uc788\ub2e4. \ucee4\ub110\uc774 \uba3c\uc800 \uc774 initramfs\ub97c \ub8e8\ud2b8\ub85c \ub9c8\uc6b4\ud2b8\ud574 \ud544\uc694\ud55c \ubaa8\ub4c8\uc744 \ub85c\ub4dc\ud558\uace0 \uc2e4\uc81c \ub514\uc2a4\ud06c\uc758 \uc9c4\uc9dc \ub8e8\ud2b8(/)\ub97c \ucc3e\uc740 \ub4a4 \ubcf8 \ubd80\ud305\uc744 \uc774\uc5b4\uac04\ub2e4.</p> <p>initramfs \ud655\uc778 <pre><code># \ud655\uc778\nfile /boot/initrd.img-5.4.24-kvmi+    # zstd\ub294 \uc608\uc804 \ucee4\ub110\uc5d0\uc11c \ubabb\uc77d\uc74c gzip compressed data \uc5ec\uc57c \ud568. \ud639\uc740 \uc544\uc608 ASCII cpio archive\ub85c \uc555\ucd95 \ubbf8\uc801\uc6a9 initramfs \uc5ec\ub3c4 \uad1c\ucc2e\n\n# \ub9cc\uc57d \uadf8\ub807\uc9c0 \uc54a\ub2e4\uba74\n# \uc124\uc815\uc774 \ucf1c\uc838 \uc788\ub294\uc9c0 \ud655\uc778\ngrep -E 'CONFIG_BLK_DEV_INITRD|CONFIG_RD_GZIP|CONFIG_RD_LZ4|CONFIG_RD_ZSTD' /boot/config-5.4.24-kvmi+\nCONFIG_BLK_DEV_INITRD=y\nCONFIG_RD_GZIP=y\nCONFIG_RD_LZ4=y\n\n# \uc774\uac83\ub9c8\uc800 \uaebc\uc838 \uc788\uc73c\uba74\n./scripts/config --enable BLK_DEV_INITRD --enable RD_GZIP --enable RD_LZ4 --enable RD_XZ --enable RD_LZO\n\ub85c \uc7ac\ube4c\ub4dc\n\n# initramfs-tools \uc555\ucd95 \uc124\uc815\uc744 gzip\uc73c\ub85c\nsudo sed -i 's/^COMPRESS=.*/COMPRESS=gzip/' /etc/initramfs-tools/initramfs.conf\n\n# 5.4.24-kvmi+ \uc6a9 \uc0c8 initramfs \uc0dd\uc131(-c \uc0c8\ub85c \uc0dd\uc131)\nsudo update-initramfs -c -k 5.4.24-kvmi+\n\n# \ub2e4\uc2dc \ud655\uc778\nfile /boot/initrd.img-5.4.24-kvmi+\n\nsudo update-grub\nreboot\n</code></pre></p> <p>\ud14d\uc2a4\ud2b8 \ubaa8\ub4dc\ub85c \uace0\uc815 <pre><code># \ud604\uc7ac 5.4\ub85c \ubd80\ud305\ud55c TTY\uc5d0\uc11c\nsudo systemctl set-default multi-user.target   # \ub2e4\uc74c \ubd80\ud305\ubd80\ud130 \ud14d\uc2a4\ud2b8 \ubaa8\ub4dc\nsudo systemctl disable --now gdm3              # \uadf8\ub798\ud53d \ub85c\uadf8\uc778 \ub9e4\ub2c8\uc800 \uc911\uc9c0\n# \ub098\uc911\uc5d0 GUI\ub85c \ub418\ub3cc\ub9b4 \ub550\nsudo systemctl set-default graphical.target &amp;&amp; sudo systemctl enable --now gdm3\n</code></pre> * 5.4 \ucee4\ub110\uc774 Raptor Lake iGPU(i915)\ub97c \ub2e4\ub8f0 \uc218 \uc5c6\uc5b4 gui \ubaa8\ub4dc\ub294 \ubb34\ub9ac\uc774\ub2e4. \ubc31\ubcf4\ub4dc\ub85c \uac00\uc838\uc624\uae30\uc5d4..</p> <p>\uc900\ube44\ud574\ub454 r8125 \uc124\uce58 <pre><code>cd ~/drivers/r8125\ntar xf r8125-*.tar.*\ncd r8125-*/\nsudo ./autorun.sh || { sudo make clean &amp;&amp; sudo make &amp;&amp; sudo make install; }\n\necho \"blacklist r8169\" | sudo tee /etc/modprobe.d/blacklist-r8169.conf\nsudo update-initramfs -u -k 5.4.24-kvmi+\nsudo reboot\n</code></pre></p> <p>\ubd80\ud305 \ud6c4 \ud655\uc778 <pre><code>uname -r                                   # 5.4.24-kvmi+ \uc778\uc9c0\nlspci -nnk -d 10ec:3000                    # Kernel driver in use: r8125\nsudo ethtool -i $(ip -o -4 route show default | awk '{print $5}')\n</code></pre></p> <p>\u26a0\ufe0f \uc2e4\ud328. \ud654\uba74\uc774 \uc548\ub738 \uc774\uc288. xen\ucc98\ub7fc grub \uc124\uc815 \uc798 \ud558\uba74 \ud654\uba74 \ud574\uacb0\ub420\ub4ef?</p>"},{"location":"11-xen-22.04/","title":"11 xen 22.04","text":""},{"location":"11-xen-22.04/#xen-drakvuf-sandbox-vmi","title":"xen drakvuf sandbox \ubc29\uc2dd\uc73c\ub85c vmi\ub97c \uad6c\ud604\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-08</p>"},{"location":"11-xen-22.04/#xen","title":"Xen \uc124\uce58","text":"<p>Xen? \ud0c0\uc7851 \ud558\uc774\ud37c\ubc14\uc774\uc800.</p> <p>\uae54\uba74 grub \ud654\uba74\uc5d0\uc11c \uc708\ub3c4\uc6b0 / \uc6b0\ubd84\ud22c / \uc6b0\ubd84\ud22c on xen \uc138\uac1c \uc911\uc5d0 \uc120\ud0dd\uac00\ub2a5. \uc708\ub3c4\uc6b0 : UEFI \u279c Windows \ubd80\ud2b8 \ub85c\ub354 \uc6b0\ubd84\ud22c : UEFI \u279c GRUB \u279c vmlinuz-... \uc6b0\ubd84\ud22c on xen : UEFI \u279c GRUB \u279c xen-4.19.gz \u279c vmlinuz-...</p> <p>\uc989 xen hypervisor \uc704\uc5d0\uc11c \uc6b0\ubd84\ud22c\ub97c \uc62c\ub9b0 \uc138\ubc88\uc9f8 \ud615\ud0dc\uac00 \uc0dd\uae34 \uac83\uc784 \ubd80\ud2b8\ub85c\ub354(Grub) \u2192 Xen hypervisor \u2192 Dom0(\ub9ac\ub205\uc2a4 \ucee4\ub110) \u2192 DomU(\uac8c\uc2a4\ud2b8 VM)</p> <p>\ucc38\uace0\ub85c type 1 \ud558\uc774\ud37c\ubc14\uc774\uc800\uc778\ub370 Dom0 DomU \uad6c\ubd84\uc774 \uc65c \uc788\ub0d0 \ud558\uba74, \uadf8\ub798\ub3c4 \ud558\ub4dc\uc6e8\uc5b4\ub97c \ub2e4\ub8e8\ub294 \uc8fc os\ub294 \uc788\uc5b4\uc57c \ud558\uae30 \ub54c\ubb38</p> <p>\ube4c\ub4dc \ub3c4\uad6c \uc124\uce58 <pre><code>$ sudo apt update\n$ sudo apt-get install wget git build-essential make gcc clang bcc \\\n    libcurl4-openssl-dev libpci-dev zlib1g-dev bridge-utils\n$ sudo apt install flex bison python3-dev libncurses-dev \\\n     libssl-dev libelf-dev libglib2.0-dev libpixman-1-dev \\\n     pkg-config gettext uuid-dev iasl libyajl-dev ninja-build meson\n</code></pre></p> <p>Xen 4.19.2 <pre><code>$ wget https://downloads.xenproject.org/release/xen/4.19.2/xen-4.19.2.tar.gz\n$ tar xf xen-4.19.2.tar.gz\n$ cd ~/xen-4.19.2\n$ make distclean                      # \uc774\uc804 \ube4c\ub4dc \uc0b0\ucd9c\ubb3c \uc0ad\uc81c\n$ ./configure --disable-docs          # \ubb38\uc11c \uc5c6\ub294 \uc124\uc815\n$ make -j$(nproc) world               # \ubcd1\ub82c \ube4c\ub4dc\n$ sudo make install\n$ ls -lh /boot/xen-4.19*.gz         # \ud558\uc774\ud37c\ubc14\uc774\uc800 \uc774\ubbf8\uc9c0 \ud655\uc778\n-rw-r--r-- 1 root root 1.2M  8\uc6d4  5 14:54 /boot/xen-4.19.2.gz\nlrwxrwxrwx 1 root root   13  8\uc6d4  5 15:00 /boot/xen-4.19.gz -&gt; xen-4.19.2.gz\n</code></pre></p>"},{"location":"11-xen-22.04/#xen_1","title":"Xen \ubb38\uc81c\ud574\uacb0","text":"<p>\ub77c\uc774\ube0c\ub7ec\ub9ac \uc704\uce58 conf <pre><code>$ sudo xl info | head                 # \ud5e4\ub4dc info. xen\uc73c\ub85c \ubd80\ud305\ub41c\uac74\uc9c0 \uccb4\ud06c\ud558\ub294\uac70\uc784\n\uc544\uc9c1 \uc77c\ubc18 \uc6b0\ubd84\ud22c\uc774\uae30\uc5d0 cannot connect \ub294 \ub9de\uc9c0\ub9cc, \ub77c\uc774\ube0c\ub7ec\ub9ac \uc624\ub958\uae4c\uc9c0 \ub738\n$ sudo find /usr/local -name 'libxl*.so*' -o -name 'libxen*so*'     # xen \ub77c\uc774\ube0c\ub7ec\ub9ac \uc704\uce58 \ucc3e\uae30\n/usr/local/lib/libxencall.so.1.3\n/usr/local/lib/libxlutil.so.4.19\n(\uc0dd\ub7b5)\n\uc6d0\ub798 /usr/lib \uc774 \uc815\uc0c1\uc774\uc9c0\ub9cc /usr/local/lib \uc5d0 \uc124\uce58\ub41c \uac83 \ud655\uc778\necho /usr/local/lib | sudo tee /etc/ld.so.conf.d/local.conf     # \uc704\uce58 \ub4f1\ub85d\n$ sudo ldconfig                       # \uce90\uc2dc \uc7ac\uc0dd\uc131\n$ sudo update-grub                    # grub \uc124\uc815 \uac31\uc2e0\n</code></pre></p> <p>secure boot \ub044\uae30 <pre><code>\uc804\uc6d0 \uaed0\ub2e4 \ud0a4\uba74 grub \uba54\ub274\uc5d0 xen ubuntu\uac00 \ucd94\uac00\ub41c \uac83 \ud655\uc778.\n\uadfc\ub370 Secure Boot(\ud38c\uc6e8\uc5b4 UEFI \uc758 \ubcf4\uc548 \ubd80\ud305)\uc774 xen\uc744 \ub9c9\uc544\ubc84\ub824 \ubd80\ud305 \uc2e4\ud328\nf2\ub85c uefi \uc138\ud305\ucc3d \ub4e4\uc5b4\uac00\uc11c superviosr password\ub97c 4108\ub85c \uc124\uc815\ud574\uc8fc\uace0 secure boot\ub97c \ub048\ub2e4.\n</code></pre></p> <p>igpu\ub9cc \uc0ac\uc6a9 <pre><code>\uc774\ubc88\uc5d0\ub294 \ubd80\ud305\ud558\uba70 \ud558\uc580 \uae00\uc528\ub4e4\uc774 \ucb49 \ub728\uc9c0\ub9cc \uac80\uc740 \ud654\uba74\uc774 \ub5a0\ubc84\ub9bc\nnvidia \ubaa8\ub4c8\uc774 xen\uacfc \ud638\ud658\uc774 \uc548\ub418\uba70 \uc0dd\uae30\ub294 \ubb38\uc81c. \uc5b4\ucc28\ud53c dgpu\ub294 \ud328\uc2a4\uc2a4\ub8e8\ud560 \uac70\uae30\uc5d0 igpu\ub85c\ub9cc \ubd80\ud305\ud558\uc790\nuefi \ub4e4\uc5b4\uac00\uc11c \ub514\uc2a4\ud50c\ub808\uc774\ub97c optimus/dpgu only/auto select \uc911 auto select(mux) \uc120\ud0dd.\n$ sudo nano /etc/default/grub.d/xen.cfg\nGRUB_CMDLINE_XEN_DEFAULT=\"dom0_mem=16384M,max:16384M dom0_max_vcpus=10 iommu=1 driver-dma-ops=1 pciback.hide=(0000:01:00.0)(0000:01:00.1)\"\n# max\ub97c \ubd99\uc774\uba74 ballon \uae30\ub2a5\uc774 \uaebc\uc838 Dom0 \uba54\ubaa8\ub9ac \uace0\uc815\n# \ubd80\ud305 \uc9c1\ud6c4 xen \ud558\uc774\ud37c\ubc14\uc774\uc800\uc5d0\uac8c VT-d\ub97c \ud65c\uc131\ud654\ud558\ub77c\uace0 \uc9c0\uc2dc\n# Dom0 \ucee4\ub110\uc774 \uc18c\ud504\ud2b8 \ubc14\uc6b4\uc2a4 \ubc84\ud37c \ub300\uc2e0 \ud45c\uc900 dma_ops + IOMMU \uacbd\ub85c\ub97c \uc4f0\ub3c4\ub85d \uac15\uc81c\n# xen \uc2dc\uc791 \ub2e8\uacc4\uc5d0\uc11c \ud574\ub2f9 PCI \ud568\uc218\ub97c xen-pciback\uc774 \uc120\uc810\ud574 Dom0 \ucee4\ub110\uc774 \ubabb \uc7a1\uac8c \ub9cc\ub4e6.\nsudo update-grub                    # \ucee4\ub110 \uc774\ubbf8\uc9c0 \ub2e4\uc2dc \ub9cc\ub4e4\uae30\nsudo apt purge 'nvidia*'            # nvidia \uad00\ub828\ub41c\uac70 \uc81c\uac70 \ubc0f \ube14\ub799\ub9ac\uc2a4\ud2b8\necho \"blacklist nouveau\" | sudo tee /etc/modprobe.d/blacklist-nouveau.conf    # nouveau\ub3c4 \ube14\ub799\ub9ac\uc2a4\ud2b8\necho xen_pciback | sudo tee -a /etc/initramfs-tools/modules   # xen-pciback\uc744 initramfs\uc5d0 \ud3ec\ud568\nsudo update-initramfs -u            # \ub514\uc2a4\ud06c \uc774\ubbf8\uc9c0 \ub2e4\uc2dc \ub9cc\ub4e4\uae30\n</code></pre></p> <p>PCI \uc8fc\uc18c \ud655\uc778 <pre><code>(0000:01:00.0)(0000:01:00.1)\uc774 \ub9de\ub294\uc9c0 \ud639\uc2dc \ubab0\ub77c \ud655\uc778\n$ lspci -nn | grep -i -e vga -e audio\n0000:00:02.0 VGA compatible controller [0300]: Intel Corporation Device [8086:a788] (rev 04)\n0000:00:1f.3 Multimedia audio controller [0401]: Intel Corporation Device [8086:7a50] (rev 11)\n0000:01:00.0 VGA compatible controller [0300]: NVIDIA Corporation Device [10de:28e0] (rev a1)\n0000:01:00.1 Audio device [0403]: NVIDIA Corporation Device [10de:22be] (rev a1)\n$ for g in /sys/kernel/iommu_groups/*; do\n  echo \"Group $(basename $g):\"; ls -l $g/devices; echo; done\nGroup 15:\n\ud569\uacc4 0\nlrwxrwxrwx 1 root root 0  8\uc6d4  5 21:49 0000:01:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0\nlrwxrwxrwx 1 root root 0  8\uc6d4  5 21:49 0000:01:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.1\n</code></pre></p> <p>wayland \ub300\uc2e0 xorg\ub85c \ubcc0\uacbd <pre><code>\ub85c\uadf8\uc778 \ud654\uba74\uae4c\uc9c0\ub294 \ub5b4\uc9c0\ub9cc \ucda9\ub3cc\uc774 \ub09c\uac74\uc9c0 \uba48\ucdb0\ubc84\ub9bc\n$ sudo journalctl -k -b -1 -n 300 --no-pager | less   # \uc9c1\uc804 \ubd80\ud305 \ucee4\ub110 \ub85c\uadf8 \ub9c8\uc9c0\ub9c9 300\uc904\nkernel: BUG: Bad page state in process gdm-wayland-ses  pfn:103249\n$ sudoedit /etc/gdm3/custom.conf\nWaylandEnable=false\nDefaultSession=gnome-xorg.desktop\n$ sudo systemctl restart gdm3\n</code></pre></p> <p>sof \uc624\ub514\uc624 \ubaa8\ub4c8 \ub044\uae30 <pre><code>\uc774\uc81c \ub4e4\uc5b4\uac00\uc9c0\uc9c0\ub9cc \ubb58 \ud2c0\uc5b4\ub3c4 \uc2e4\ud589\uc774 \uacc4\uc18d \ub85c\ub529\uc911\uc784\n$ sudo journalctl -k -b -1 -n 300 --no-pager | less   # \uc9c1\uc804 \ubd80\ud305 \ucee4\ub110 \ub85c\uadf8 \ub9c8\uc9c0\ub9c9 300\uc904\nSOF \uc624\ub514\uc624(snd_sof_*)\u00b7i915 \ud45c\uc900 \ucd08\uae30\ud654 \uba54\uc2dc\uc9c0\ub9cc \ud758\ub7ec\uac00\ub2e4 \uba48\ucda4\n\uc18c\ubb38\ub09c \uc5d0\uc774\uc11c 12~14\uc138\ub300 \ub178\ud2b8\ubd81 \uc774\uc288. SOF DSP\uac00 \ud38c\uc6e8\uc5b4 \ub85c\ub4dc\uc5d0\uc11c \uc218 \uc2ed \ucd08 \ube14\ub85c\ud0b9\u00b7GDM \ud0c0\uc784\uc544\uc6c3 \uc720\ubc1c\n# sof \uc624\ub514\uc624 \ubaa8\ub4c8 \ub044\uae30\n$ echo 'options snd_intel_dspcfg dlg_support=0' | sudo tee /etc/modprobe.d/disable-sof.conf\n# sof \uacc4\uc5f4 \ubaa8\ub4c8 \uc804\ubd80 \ube14\ub799\ub9ac\uc2a4\ud2b8\n$ echo \"blacklist snd_sof_pci_intel_tgl\nblacklist snd_sof_intel_hda_common\nblacklist snd_sof_pci\nblacklist snd_sof\n\" | sudo tee /etc/modprobe.d/blacklist-sof.conf\n# HDA \ubaa8\ub4dc\ub9cc \uac15\uc81c\n$ echo 'options snd_intel_dspcfg dsp_driver=1' | sudo tee /etc/modprobe.d/force-hda.conf\n$ sudo update-initramfs -u\n</code></pre></p>"},{"location":"11-xen-22.04/#xen_2","title":"Xen \ubd80\ud305","text":"<p>\uc798 \ub4e4\uc5b4\uac00\uc9c0\ub2c8 \ub4e4\uc5b4\uac00 \uc124\uc815\uc744 \ud574\uc8fc\uaca0\ub2e4</p> <p>\uc7a5\uce58 modprobe <pre><code>$ grep -i \"Xen version\" /var/log/dmesg\n[    0.983837] kernel: Xen version: 4.19.2 (preserve-AD)\n$ sudo modprobe xenfs xen_privcmd xen_evtchn xen_gntdev xen_gntalloc\n$ ls -ld /proc/xen\ndr-xr-xr-x 2 root root 0  8\uc6d4  6 01:19 /proc/xen\n$ ls -l /dev/xen/privcmd\ncrw------- 1 root root 10, 119  8\uc6d4  6 01:23 /dev/xen/privcmd\n$ lsmod | grep -E 'xen(fs|_evtchn|_privcmd)'\nxenfs                  12288  0\nxen_privcmd            32768  1 xenfs\n$ sudo xl info | head\nhost                   : kkongnyang2-Predator-PHN16-72\nrelease                : 6.8.0-65-generic\nversion                : #68~22.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue Jul 15 18:06:34 UTC 2\nmachine                : x86_64\nnr_cpus                : 20\nmax_cpu_id             : 19\nnr_nodes               : 1\ncores_per_socket       : 10\nthreads_per_core       : 2\ncpu_mhz                : 2803.200\n</code></pre></p> <p>\ub370\ubaac \uacbd\ub85c \ubcc0\uacbd <pre><code>\uc77c\ubc18\uc801\uc73c\ub85c /usr\uac00 \uc815\uc0c1\uc774\uc9c0\ub9cc /usr/local\uc5d0 \uc124\uce58\ub410\uc5c8\uc74c.\n\uadf8\ub798\uc11c xenstored \uc18c\ucf13\uc744 \ud1b5\ud574 \ub3c4\uba54\uc778 \uc815\ubcf4\ub97c \uac00\uc838\uc640\uc57c \ud558\ub294\ub370 \ub370\ubaac\uc774 \uc5c6\uc5b4 xl list\uac00 \uadf8\ub300\ub85c \ube14\ub85d\ub428\n$ sudo ln -s /usr/local/sbin/xenstored /usr/sbin/xenstored\n$ sudo systemctl daemon-reload\n$ sudo systemctl start xenstored\n$ sudo xl list\nName                                        ID   Mem VCPUs  State   Time(s)\nDomain-0                                     0 16384    10     r-----     298.0\n</code></pre> wget https://download.qemu.org/qemu-8.2.2.tar.xz tar xf qemu-8.2.2.tar.xz cd qemu-8.2.2 ./configure --target-list=x86_64-softmmu,i386-softmmu \\             --enable-xen              \\             --enable-system           \\             --disable-docs make -j\"$(nproc)\" sudo make install         # /usr/local/bin/qemu-system-x86_64 \ub4f1 sudo ldconfig sudo ln -sf /usr/local/bin/qemu-system-x86_64 /usr/local/lib/xen/bin/ sudo ln -sf /usr/local/bin/qemu-system-i386   /usr/local/lib/xen/bin/</p>"},{"location":"11-xen-22.04/#libvmi-drakvuf","title":"libvmi + DRAKVUF \uc124\uce58","text":"<p>libvmi? vmi\ub97c \uc704\ud55c c \ub77c\uc774\ube0c\ub7ec\ub9ac \uc5d4\uc9c4 drakvuf? \ucd94\uc801, \ub364\ud504\ud558\ub294 C \ud504\ub85c\uadf8\ub7a8 drakvuf-sandbox? \ucd1d\ud569 \uc790\ub3d9\ud654 \ud328\ud0a4\uc9c0</p> <p>libvmi \ub77c\uc774\ube0c\ub7ec\ub9ac \uc124\uce58 <pre><code>sudo apt install libjson-c-dev doxygen cmake\ngit clone https://github.com/libvmi/libvmi\ncd libvmi\nmkdir build &amp;&amp; cd build\nrm -rf *\ncmake .. \\\n  -DCMAKE_BUILD_TYPE=Release \\\n  -DENABLE_XEN=ON  -DENABLE_KVM=OFF \\\n  -DENABLE_JSONC=ON\nmake -j$(nproc)\nsudo make install\nsudo ldconfig\n</code></pre></p> <p>DRAKVUF \ud504\ub85c\uadf8\ub7a8 \uc124\uce58 <pre><code>sudo apt install clang-15 lld-15 llvm-15 llvm-15-dev\nsudo ln -s /usr/bin/lld-15 /usr/bin/ld.lld\nsudo ln -sf /usr/bin/llvm-ar-15 /usr/bin/llvm-ar\ngit clone https://github.com/tklengyel/drakvuf\ncd drakvuf\nmeson setup build --native-file llvm.ini\nninja -C build\nsudo ninja -C build install\nsudo ldconfig\nwhich drakvuf\n/usr/local/bin/drakvuf\ndrakvuf --version\n</code></pre></p>"},{"location":"11-xen-22.04/#drakvuf-sandbox","title":"drakvuf-sandbox \uc0ac\uc6a9","text":"<p>root\ub85c \uc258 \uc811\uc18d <pre><code>sudo passwd root        # root\uc6a9 \ube44\ubc00\ubc88\ud638 \uc124\uc815\n\uc2e0\uaddc \ube44\ubc00\ubc88\ud638 : 4108\nsu                      # root\ub85c \uc811\uc18d\nexit                    # \uc885\ub8cc \uba85\ub839\uc5b4\n</code></pre></p> <p>\uc2e4\ud589 <pre><code>apt install iptables tcpdump dnsmasq qemu-utils bridge-utils libmagic1 redis-server python3.10-venv\npython3 -m venv /opt/venv\nsource /opt/venv/bin/activate\npip install --upgrade pip\npip install drakvuf-sandbox\n</code></pre></p> <p>vm \uc0dd\uc131 <pre><code>\uc708\ub3c4\uc6b0 \uc774\ubbf8\uc9c0 \uc124\uce58\ub97c \uc704\ud574\uc120 \ub450 \uac1c\uc758 iso \ud30c\uc77c\uacfc \ube48 \ud558\ub4dc\ub514\uc2a4\ud06c \ud558\ub098\uac00 \ud544\uc694\ud558\ub2e4.\n\nwin10_22H2_English_x64.iso : \ubd80\ud305 \uac00\ub2a5\ud55c DVD \uc5ed\ud560. vm\uc774 \uc774\uac78\ub85c \uccab \ubd80\ud305\ud558\uba70 \uc708\ub3c4\uc6b0 setup \uc2e4\ud589.\nvirtio-win.iso : \ub4dc\ub77c\uc774\ubc84 CD \uc5ed\ud560. setup\uc774 \uc774 viostor.inf\uc640 NetKVM.inf \ub97c \uc77d\uc5b4 virtio \uac00\uc0c1 HDD\ub97c \uc778\uc2dd\ud558\ub3c4\ub85d \ud568\nwin10.qcow2 : \ube48 \ud558\ub4dc\ub514\uc2a4\ud06c. setup\uc774 \uc5ec\uae30 \ud30c\ud2f0\uc158\uc744 \ub9cc\ub4e4\uace0 \uc708\ub3c4\uc6b0 \ud30c\uc77c\uc744 \ubcf5\uc0ac\ud558\uc5ec \uc7ac\ubd80\ud305\uc774 \ub05d\ub098\uba74 \uc708\ub3c4\uc6b0\uac00 \ub4e4\uc5b4 \uc788\ub294 \ub514\uc2a4\ud06c\uac00 \ub428.\n\nhttps://www.microsoft.com/software-download/windows10 \ub4e4\uc5b4\uac00 \uc601\uc5b4(\ubbf8\uad6d) 64\ube44\ud2b8 \ub2e4\uc6b4\ub85c\ub4dc. Win10_22H2_English_x64v1.iso\nhttps://fedorapeople.org/groups/virt/virtio-win/direct-downloads/ \ub4e4\uc5b4\uac00 stable-virtio/virtio-win-0.1.271.iso \ub2e4\uc6b4\n\nsudo apt install qemu-system-x86 ovmf\ndrakrun install \\\n    \"/home/kkongnyang2/\ub2e4\uc6b4\ub85c\ub4dc/Win10_22H2_English_x64v1.iso\" \\\n    --memory 12288 --vcpus 8\n</code></pre></p> <p>\u26a0\ufe0f \uc2e4\ud328. vm\uc774 \uc548\ub9cc\ub4e4\uc5b4\uc9d0. ovmf \ud638\ud658 \ubb38\uc81c\uc600\uc74c. \ub2e4\uc74c\uc5d4 seabios\ub85c \ud558\uba74 \ud574\uacb0\ub420\ub4ef?</p>"},{"location":"12-xen-backlist/","title":"12 xen backlist","text":""},{"location":"12-xen-backlist/#xen-vmi","title":"xen \ubc29\uc2dd\uc73c\ub85c vmi\ub97c \uad6c\ud604\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-15</p> <p>bios \uc124\uc815 <pre><code>VT-x, VT-d \ucf1c\uae30\nSecure boot \ub044\uae30(\uc11c\uba85 \ubb38\uc81c \ud68c\ud53c\uc5d0 \uc720\ub9ac. \ubc14\ub85c \uc548\uaebc\uc9c0\uba74 \ubc14\uc774\uc624\uc2a4 \ube44\ubc88 \uc124\uc815\ud55c \ud6c4 \ub048 \ud6c4 \ube44\ubc88 \ub2e4\uc2dc \uc5c6\uc560\uba74 \ub428)\nvmd controller \ub044\uae30(advanced-main\uc5d0\uc11c ctrl+s \ub20c\ub7ec \ud788\ub4e0\uc635\uc158 \ub744\uc6b0\uba74 \ub428)\ndisplay mode : optimus\n</code></pre> * optimus = igpu \uc9c1\uacb0, dgpu \ub3c4\uc6c0 * dgpu only = dgpu \uc9c1\uacb0 * auto select = \uc704 \ub450\uac1c \uc911\uc5d0 \uc790\ub3d9\uc120\ud0dd</p> <p>24.04 \uc124\uce58\uc2dc \ub4dc\ub77c\uc774\ubc84 \ub450\uac1c \ub2e4 \ubbf8\uccb4\ud06c <pre><code>$ lspci -nnk | grep -A3 -Ei 'vga|3d|display'\n00:02.0 VGA compatible controller [0300]: Intel Corporation Raptor Lake-S UHD Graphics [8086:a788] (rev 04)\n    Subsystem: Acer Incorporated [ALI] Raptor Lake-S UHD Graphics [1025:1731]\n    Kernel driver in use: i915\n    Kernel modules: i915, xe\n--\n01:00.0 VGA compatible controller [0300]: NVIDIA Corporation AD107M [GeForce RTX 4060 Max-Q / Mobile] [10de:28e0] (rev a1)\n    Subsystem: Acer Incorporated [ALI] AD107M [GeForce RTX 4060 Max-Q / Mobile] [1025:1731]\n    Kernel driver in use: nouveau\n    Kernel modules: nvidiafb, nouveau\n</code></pre></p> <p>\ud328\ud0a4\uc9c0 \uc124\uce58 <pre><code>$ sudo apt update\n$ sudo apt install -y xen-system-amd64 ovmf qemu-system-x86\n</code></pre></p> <p>1\ucc28 \uc2dc\ub3c4 <pre><code>xen \ubd80\ud305\ud558\uba74\uc11c e\nsystemd.unit=multi-user.target module_blacklist=nvidia,nvidia_drm,nvidia_modeset nouveau.modeset=0 \ucd94\uac00\ud558\uace0 f10\n</code></pre> * \uc548\ucf1c\uc9d0</p> <p>2\ucc28 \uc2dc\ub3c4 <pre><code>$ sudo nano /etc/gdm3/custom.conf\nWaylandEnable=false\n$ sudo systemctl restart gdm\n\uc544\uae4c\ucc98\ub7fc \ubd80\ud305\n</code></pre> * \uc548\ucf1c\uc9d0</p> <p>3\ucc28 \uc2dc\ub3c4 <pre><code>$ sudo journalctl -k -b -1 -n 300 --no-pager | less\n\uc624\ub514\uc624 \ub4dc\ub77c\uc774\ubc84\uac00 \uc624\ub7ab\ub3d9\uc548 \uc2dc\uac04\ub04c\ub2e4 \uc548\ub4e4\uc5b4\uac04 \ub85c\uadf8 \ud655\uc778\n$ echo 'options snd-intel-dspcfg dsp_driver=1' | sudo tee /etc/modprobe.d/alsa-base.conf\n$ sudo update-grub\n$ sudo update-initramfs -u\n\uc544\uae4c\ucc98\ub7fc \ubd80\ud305\n</code></pre> * \uc548\ucf1c\uc9d0</p> <p>4\ucc28 \uc2dc\ub3c4 <pre><code>$ sudo journalctl -k -b -1 -n 300 --no-pager | less\n\ub0b4 igpu\uc778 a788\uc774 i915\ub97c \uac70\ubd80\ud558\ub294\uac70 \ud655\uc778. xe\ub85c \uad50\uccb4\ud558\ub77c\ud568\n$ echo \"options xe force_probe=a788\" | sudo tee /etc/modprobe.d/xe-force.conf\noptions xe force_probe=a788\n$ echo \"options i915 force_probe=!a788\" | sudo tee /etc/modprobe.d/i915-noforce.conf\nbash: !a788: event not found\n$ echo 'options i915 force_probe=!a788' | sudo tee /etc/modprobe.d/i915-noforce.conf\n$ echo -e \"blacklist nvidia\\nblacklist nvidia_drm\\nblacklist nvidia_modeset\\nblacklist nouveau\" \\\n| sudo tee /etc/modprobe.d/blacklist-nvidia.conf\nblacklist nvidia\nblacklist nvidia_drm\nblacklist nvidia_modeset\nblacklist nouveau\n$ sudo nano /etc/default/grub\ni915.force_probe=!a788 xe.force_probe=a788\n$ sudo tee /etc/modprobe.d/blacklist-audio.conf &gt;/dev/null &lt;&lt;'EOF'\n# SOF(PCI/Intel) \uacc4\uc5f4 \uc804\ubd80 \ucc28\ub2e8\nblacklist snd_sof_pci\nblacklist snd_sof\nblacklist snd_sof_intel_hda_common\nblacklist snd_sof_intel_hda\nblacklist snd_sof_pci_intel_tgl\nblacklist snd_sof_pci_intel_mtl\nblacklist snd_sof_pci_intel_lnl\n# HDA \uc778\ud154 \ub4dc\ub77c\uc774\ubc84/\ucf54\ub371 \ucc28\ub2e8(\uc644\uc804 \ubb34\uc74c\uc774 \ubaa9\uc801\uc77c \ub54c)\nblacklist snd_hda_intel\nblacklist snd_hda_codec_hdmi\n# (\uc120\ud0dd) \uc0ac\uc6b4\ub4dc\uc640\uc774\uc5b4\ub3c4 \ud568\uaed8 \ucc28\ub2e8\nblacklist soundwire_intel\nEOF\n$ sudo update-grub\n$ sudo update-initramfs -u\n\uc544\uae4c\ucc98\ub7fc \ubd80\ud305\n</code></pre> * \uc548\ucf1c\uc9d0</p> <p>5\ucc28 \uc2dc\ub3c4 <pre><code>$ sudo journalctl -k -b -1 -n 300 --no-pager | less\n\uad50\uccb4\ud55c xe \ub610\ud55c \ub0b4 igpu\uc778 a788\uc774 \uac70\ubd80\ud558\ub294\uac78 \ud655\uc778\n$ lspci -nn -d 8086: -k | sed -n '/VGA/,+2p'\n00:02.0 VGA compatible controller [0300]: Intel Corporation Raptor Lake-S UHD Graphics [8086:a788] (rev 04)\n    Subsystem: Acer Incorporated [ALI] Raptor Lake-S UHD Graphics [1025:1731]\n    Kernel driver in use: xe\n$ sudo rm -f /etc/modprobe.d/xe-force.conf /etc/modprobe.d/i915-noforce.conf\n# i915\ub97c \uac15\uc81c \ud504\ub85c\ube0c + PSR \ub044\uae30(\ubcf4\uc218)\n$ echo 'options i915 force_probe=a788 enable_psr=0' | sudo tee /etc/modprobe.d/i915-force.conf\n$ sudo nano /etc/default/grub\n# GRUB_CMDLINE_LINUX_DEFAULT= \uc5d0 \ub2e4\uc74c\uc744 \ud3ec\ud568\n#   intel_iommu=on,igfx_off\n$ sudo update-grub\n$ sudo update-initramfs -u\n\uc544\uae4c\ucc98\ub7fc \ubd80\ud305\n</code></pre> * \uc548\ucf1c\uc9d0</p> <p>6\ucc28 \uc2dc\ub3c4 <pre><code>$ sudo journalctl -k -b -1 -n 300 --no-pager | less\n\ubc31\ub77c\uc774\ud2b8 \ubb38\uc81c \ud655\uc778\n$ lspci -nn -d 8086: -k | sed -n '/VGA/,+2p'\n00:02.0 VGA compatible controller [0300]: Intel Corporation Raptor Lake-S UHD Graphics [8086:a788] (rev 04)\n    Subsystem: Acer Incorporated [ALI] Raptor Lake-S UHD Graphics [1025:1731]\n    Kernel driver in use: i915\n$ ls -1 /sys/class/backlight\nnvidia_wmi_ec_backlight\n$ sudo nano /etc/default/grub\nacpi_backlight=native video.use_native_backlight=1 i915.enable_dpcd_backlight=1 i915.enable_psr=0\n</code></pre> * \uc548\ucf1c\uc9d0</p> <p>\ubb50\uac00 \ubb38\uc81c\ub0d0? xen \ud558\uc774\ud37c\ubc14\uc774\uc800\uc5d0\uc11c\ub294 \ubcf4\uc548/\uaca9\ub9ac\ub97c \uc704\ud574 \uba54\ubaa8\ub9ac\ub97c \ubcf4\uc218\uc801\uc73c\ub85c \uc7a1\uc74c. \ubca0\uc5b4\uba54\ud0c8\uc5d0\uc11c\ub294 a788\uc774 \uc694\uccad\ud558\ub294 dma api\uac00 iommu\uc5d0\uc11c \ubc14\ub85c \uc218\uc6a9\ub418\ub294\ub370 xen \ud558\uc774\ud37c\ubc14\uc774\uc800\uc5d0\uc11c\ub294 swiotlb\ub97c \ud1b5\ud574 \ubc14\uc6b4\uc2a4\ud558\uae30\uc5d0 a788\uac00 \uc694\uccad\ud558\ub294 \ud06c\uae30/\uc5f0\uc18d\uc131/\uc815\ub82c/\uc77c\uad00\uc131\uc744 \ub9cc\uc871\ud558\uc9c0 \ubabb\ud568.</p> <p>\u26a0\ufe0f \uc2e4\ud328. \ud654\uba74\uc774 \uc548\ub738. grub \uc124\uc815 \uc798 \ud558\uba74 \ud654\uba74 \ud574\uacb0\ub420\ub4ef?</p>"},{"location":"13-xen-pciback/","title":"13 xen pciback","text":""},{"location":"13-xen-pciback/#xen-vmi","title":"xen \ubc29\uc2dd\uc73c\ub85c vmi\ub97c \uad6c\ud604\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-17</p>"},{"location":"13-xen-pciback/#_1","title":"\uc774\ubc88 \uc138\ud305","text":"<p>bios \uc124\uc815 <pre><code>VT-x, VT-d \ucf1c\uae30\nSecure boot \ub044\uae30(\uc11c\uba85 \ubb38\uc81c \ud68c\ud53c\uc5d0 \uc720\ub9ac. \ubc14\ub85c \uc548\uaebc\uc9c0\uba74 \ubc14\uc774\uc624\uc2a4 \ube44\ubc88 \uc124\uc815\ud55c \ud6c4 \ub048 \ud6c4 \ube44\ubc88 \ub2e4\uc2dc \uc5c6\uc560\uba74 \ub428)\nvmd controller \ub044\uae30(advanced-main\uc5d0\uc11c ctrl+s \ub20c\ub7ec \ud788\ub4e0\uc635\uc158 \ub744\uc6b0\uba74 \ub428)\ndisplay mode : auto select\n</code></pre> * optimus = igpu \uc9c1\uacb0, dgpu \ub3c4\uc6c0 * dgpu only = dgpu \uc9c1\uacb0 * auto select = nvidia \ub4dc\ub77c\uc774\ubc84\uac00 mux\ub97c \uc870\uc815\ud574 \uc704 \ub450\uac1c \uc911\uc5d0 \uc790\ub3d9\uc120\ud0dd</p> <p>\uc124\uce58 \uc2dc \ub4dc\ub77c\uc774\ubc84 \ub450\uac1c \ub2e4 \ubbf8\uccb4\ud06c <pre><code>$ lspci -nnk | grep -A3 -Ei 'vga|3d|display|Audio'\n00:02.0 VGA compatible controller [0300]: Intel Corporation Raptor Lake-S UHD Graphics [8086:a788] (rev 04)\n    Subsystem: Acer Incorporated [ALI] Raptor Lake-S UHD Graphics [1025:1731]\n    Kernel driver in use: i915\n    Kernel modules: i915, xe\n--\n00:1f.3 Multimedia audio controller [0401]: Intel Corporation Raptor Lake High Definition Audio Controller [8086:7a50] (rev 11)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n    Kernel driver in use: sof-audio-pci-intel-tgl\n    Kernel modules: snd_hda_intel, snd_soc_avs, snd_sof_pci_intel_tgl\n00:1f.4 SMBus [0c05]: Intel Corporation Raptor Lake-S PCH SMBus Controller [8086:7a23] (rev 11)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n--\n01:00.0 VGA compatible controller [0300]: NVIDIA Corporation AD107M [GeForce RTX 4060 Max-Q / Mobile] [10de:28e0] (rev a1)\n    Subsystem: Acer Incorporated [ALI] AD107M [GeForce RTX 4060 Max-Q / Mobile] [1025:1731]\n    Kernel driver in use: nouveau\n    Kernel modules: nvidiafb, nouveau\n01:00.1 Audio device [0403]: NVIDIA Corporation Device [10de:22be] (rev a1)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n    Kernel driver in use: snd_hda_intel\n    Kernel modules: snd_hda_intel\n</code></pre></p>"},{"location":"13-xen-pciback/#xen-ubuntu","title":"xen ubuntu \ub9cc\ub4e4\uae30","text":"<p>xen \uc124\uce58 \ubc0f dpgu \ud558\uc774\ub529 <pre><code>sudo apt install -y xen-system-amd64 ovmf qemu-system-x86\n\necho 'GRUB_CMDLINE_XEN=\"iommu=1 iommu=verbose dom0_mem=4096M,max:4096M\"' | sudo tee /etc/default/grub.d/xen.cfg\n\necho 'GRUB_CMDLINE_LINUX_XEN_REPLACE=\"xen-pciback.hide=(01:00.0)(01:00.1) modprobe.blacklist=nvidia,nvidia_drm,nvidia_modeset,nouveau\"' \\\n| sudo tee -a /etc/default/grub.d/xen.cfg\n\nsudo update-grub\n</code></pre></p> <p>xen ubuntu\ub85c \ub4e4\uc5b4\uac00\uae30 <pre><code>$ sudo xl info | head\nhost                   : acer\nrelease                : 6.14.0-27-generic\nversion                : #27~24.04.1-Ubuntu SMP PREEMPT_DYNAMIC Tue Jul 22 17:38:49 UTC 2\nmachine                : x86_64\nnr_cpus                : 20\nmax_cpu_id             : 19\nnr_nodes               : 1\ncores_per_socket       : 10\nthreads_per_core       : 2\ncpu_mhz                : 2803.195\n\n$ sudo xl list\nName                                        ID   Mem VCPUs  State   Time(s)\nDomain-0                                     0  4096    20     r-----     415.7\n\n$ cat /sys/hypervisor/type\nxen\n</code></pre></p>"},{"location":"13-xen-pciback/#pciback","title":"pciback \ud65c\uc131\ud654","text":"<p>pciback \ubaa8\ub4c8 \ud65c\uc131\ud654 <pre><code>$ lsmod | grep xen_pciback || sudo modprobe xen_pciback\n$ lspci -nnk | grep -A3 -Ei 'vga|3d|display|Audio'\n00:02.0 VGA compatible controller [0300]: Intel Corporation Raptor Lake-S UHD Graphics [8086:a788] (rev 04)\n    Subsystem: Acer Incorporated [ALI] Raptor Lake-S UHD Graphics [1025:1731]\n    Kernel driver in use: i915\n    Kernel modules: i915, xe\n--\n00:1f.3 Multimedia audio controller [0401]: Intel Corporation Raptor Lake High Definition Audio Controller [8086:7a50] (rev 11)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n    Kernel driver in use: sof-audio-pci-intel-tgl\n    Kernel modules: snd_hda_intel, snd_soc_avs, snd_sof_pci_intel_tgl\n00:1f.4 SMBus [0c05]: Intel Corporation Raptor Lake-S PCH SMBus Controller [8086:7a23] (rev 11)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n--\n01:00.0 VGA compatible controller [0300]: NVIDIA Corporation AD107M [GeForce RTX 4060 Max-Q / Mobile] [10de:28e0] (rev a1)\n    Subsystem: Acer Incorporated [ALI] AD107M [GeForce RTX 4060 Max-Q / Mobile] [1025:1731]\n    Kernel driver in use: pciback\n    Kernel modules: nvidiafb, nouveau\n01:00.1 Audio device [0403]: NVIDIA Corporation Device [10de:22be] (rev a1)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n    Kernel driver in use: snd_hda_intel\n    Kernel modules: snd_hda_intel\n</code></pre> * \uc624\ub514\uc624 \uc7a5\uce58\ub97c \uc544\uc9c1\ub3c4 pciback\uc774 \uc544\ub2c8\ub2e4. \uc5b8\ubc14\uc778\ub4dc \ud6c4 \ubc14\uc778\ub4dc\ub97c \ud574\uc8fc\uaca0\ub2e4.</p> <p>\uc624\ub514\uc624 \uc5b8\ubc14\uc778\ub4dc \ud6c4 \ubc14\uc778\ub4dc <pre><code>$ DRVDIR=$(ls -d /sys/bus/pci/drivers/pciback /sys/bus/pci/drivers/xen-pciback 2&gt;/dev/null | head -n1)\n$ echo \"$DRVDIR\"\n/sys/bus/pci/drivers/pciback\n$ echo 0000:01:00.1 | sudo tee /sys/bus/pci/devices/0000:01:00.1/driver/unbind\n0000:01:00.1\n$ echo \"10de 22be\" | sudo tee \"$DRVDIR/new_id\"\n10de 22be\ntee: /sys/bus/pci/drivers/pciback/new_id: File exists\n$ echo 0000:01:00.1 | sudo tee \"$DRVDIR/bind\"\n0000:01:00.1\n$ lspci -nnk | grep -A3 -Ei 'vga|3d|display|Audio'\n00:02.0 VGA compatible controller [0300]: Intel Corporation Raptor Lake-S UHD Graphics [8086:a788] (rev 04)\n    Subsystem: Acer Incorporated [ALI] Raptor Lake-S UHD Graphics [1025:1731]\n    Kernel driver in use: i915\n    Kernel modules: i915, xe\n--\n00:1f.3 Multimedia audio controller [0401]: Intel Corporation Raptor Lake High Definition Audio Controller [8086:7a50] (rev 11)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n    Kernel driver in use: sof-audio-pci-intel-tgl\n    Kernel modules: snd_hda_intel, snd_soc_avs, snd_sof_pci_intel_tgl\n00:1f.4 SMBus [0c05]: Intel Corporation Raptor Lake-S PCH SMBus Controller [8086:7a23] (rev 11)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n--\n01:00.0 VGA compatible controller [0300]: NVIDIA Corporation AD107M [GeForce RTX 4060 Max-Q / Mobile] [10de:28e0] (rev a1)\n    Subsystem: Acer Incorporated [ALI] AD107M [GeForce RTX 4060 Max-Q / Mobile] [1025:1731]\n    Kernel driver in use: pciback\n    Kernel modules: nvidiafb, nouveau\n01:00.1 Audio device [0403]: NVIDIA Corporation Device [10de:22be] (rev a1)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n    Kernel driver in use: pciback\n    Kernel modules: snd_hda_intel\n$ sudo xl pci-assignable-list\n0000:01:00.0 \n0000:01:00.1 \n</code></pre></p>"},{"location":"13-xen-pciback/#vm","title":"vm \uc0dd\uc131","text":"<p>vm \uc708\ub3c4\uc6b010 \uc0dd\uc131 <pre><code>https://www.microsoft.com/ko-kr/software-download/windows10 \ub4e4\uc5b4\uac00 \uc601\uc5b4(\ubbf8\uad6d) 64\ube44\ud2b8 \ub2e4\uc6b4\ub85c\ub4dc.\n\n$ sudo install -d -o root -g root -m 755 /var/lib/xen/images\n$ sudo install -d -o root -g root -m 755 /var/lib/xen/iso\n\n$ sudo qemu-img create -f qcow2 /var/lib/xen/images/win10.qcow2 60G\nFormatting '/var/lib/xen/images/win10.qcow2', fmt=qcow2 cluster_size=65536 extended_l2=off compression_type=zlib size=64424509440 lazy_refcounts=off refcount_bits=16\n$ sudo mv ~/Downloads/Win10_22H2_English_x64v1.iso /var/lib/xen/iso/Win10.iso\n\n$ sudo chown root:root /var/lib/xen/iso/Win10.iso /var/lib/xen/images/win10.qcow2\n$ sudo chmod 644 /var/lib/xen/iso/Win10.iso\n$ sudo chmod 644 /var/lib/xen/images/win10.qcow2\n$ sudo chmod 755 /var/lib/xen /var/lib/xen/iso /var/lib/xen/images\n\n$ sudo nano /etc/xen/win10.cfg\nname = \"win10\"\ntype = \"hvm\"\nmemory = 4096\nvcpus  = 2\n\nbios  = \"seabios\"\nboot  = \"dc\"\n\ndevice_model_version  = \"qemu-xen\"\ndevice_model_override = \"/usr/libexec/xen-qemu-system-i386\"\n\nvga = \"stdvga\"\nvideoram = 32\ngraphics = \"vnc\"\nvnc = 1\nvncunused = 1\nvnclisten = \"127.0.0.1\"\n\nvif = []\n\ndisk = [\n  'format=qcow2,vdev=hda,access=rw,target=/var/lib/xen/images/win10.qcow2',\n  'format=raw,vdev=hdc,devtype=cdrom,access=ro,target=/var/lib/xen/iso/Win10.iso'\n]\n\n$ sudo xl -vvv create /etc/xen/win10-seabios.cfg\n$ sudo xl list\nName                                        ID   Mem VCPUs  State   Time(s)\nDomain-0                                     0  4096    20     r-----    6300.0\nwin10-seabios                               22  4096     1     r-----       4.3\n\n$ sudo apt install -y tigervnc-viewer\n$ vncviewer 127.0.0.1:5900          # \ud639\uc740 sudo xl vncviwer win10-seabios\n                                    # \ud3ec\ud2b8 = 5900 + vncdisplay\n\ud654\uba74 \ubcf4\uba74\uc11c \uc708\ub3c4\uc6b0 \uc124\uce58 \uc644\ub8cc\n</code></pre></p>"},{"location":"13-xen-pciback/#_2","title":"\ub124\ud2b8\uc6cc\ud06c \uc5f0\uacb0","text":"<p>wifi \ube0c\ub9bf\uc9c0 \ub9cc\ub4e4\uae30 <pre><code>$ ip -br link\nlo               UNKNOWN        00:00:00:00:00:00 &lt;LOOPBACK,UP,LOWER_UP&gt; \nenp68s0          UP             38:a7:46:0f:3b:be &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; \nwlp0s20f3        UP             2c:7b:a0:8d:53:ba &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; \n\n$ sudo nmcli connection add type bridge ifname xenbr0 con-name xenbr0\nConnection 'xenbr0' (73ed640e-e780-434e-ac81-454bbb63a13f) successfully added.\n\n$ sudo nmcli con mod xenbr0 ipv4.method auto ipv6.method ignore bridge.stp no bridge.forward-delay 0\n\n$ sudo nmcli connection add type bridge-slave ifname enp68s0 master xenbr0\nConnection 'bridge-slave-enp68s0' (3b3f8c28-d977-4851-9e61-f94cdb2d323e) successfully added.\n\n$ sudo nmcli connection down \"$(nmcli -t -f NAME,TYPE c show --active | awk -F: '$2==\"ethernet\"{print $1; exit}')\" 2&gt;/dev/null || true\n\n$ sudo nmcli device disconnect enp68s0\nDevice 'enp68s0' successfully disconnected.\n\n$ sudo nmcli con up bridge-slave-enp68s0\nConnection successfully activated (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/18)\n\n$ sudo nmcli con up xenbr0\nConnection successfully activated (master waiting for slaves) (D-Bus active path: /org/freedesktop/NetworkManager/ActiveConnection/19)\n\n$ nmcli device status\nDEVICE             TYPE      STATE                                  CONNECTION           \nxenbr0             bridge    connected                              xenbr0               \nwlp0s20f3          wifi      connected                              KT_GiGA_5G_1D39      \nenp68s0            ethernet  connected                              bridge-slave-enp68s0          \nlo                 loopback  connected (externally)                 lo                   \np2p-dev-wlp0s20f3  wifi-p2p  disconnected                           --                   \n</code></pre></p> <p>\ucc38\uace0\ub85c \uc0ad\uc81c\ud558\ub824\uba74 <pre><code>sudo nmcli con down xenbr0\nsudo nmcli con down bridge-slave-enp68s0\nsudo nmcli con delete xenbr0\nsudo nmcli con delete bridge-slave-enp68s0\n</code></pre></p> <p>wifi \ucd94\uac00 <pre><code>$ sudo nano /etc/xen/win10.cfg\n\nboot  = \"c\" \ub85c \ubcc0\uacbd\n\nvif = [ 'bridge=xenbr0,model=e1000,script=vif-bridge,mac=52:54:00:12:34:56' ] \ub85c \ubcc0\uacbd\n\ndisk = [\n  'format=qcow2,vdev=hda,access=rw,target=/var/lib/xen/images/win10.qcow2'\n]\n\ub85c \ubcc0\uacbd\n\n$ sudo xl create /etc/xen/win10-wifi.cfg\n$ vncviewer 127.0.0.1:5900\n</code></pre></p>"},{"location":"13-xen-pciback/#dgpu","title":"dgpu \ud328\uc2a4\uc2a4\ub8e8","text":"<p>dgpu \ud328\uc2a4\uc2a4\ub8e8 \ucd94\uac00 <pre><code>$ sudo nano /etc/xen/win10.cfg \n\npci = [\n  '0000:01:00.0,permissive=1'\n]\n\ucd94\uac00\n\n$ sudo xl create /etc/xen/win10.cfg\n$ vncviewer 127.0.0.1:5900\n\nhdmi\uc5d0 \uc678\ubd80 \ubaa8\ub2c8\ud130 \uc5f0\uacb0\ud574\uc11c \ub728\uba74 \ub514\uc2a4\ud50c\ub808\uc774 \ubcf5\uc81c\ub85c \ubcc0\uacbd\n</code></pre></p>"},{"location":"13-xen-pciback/#libvmi","title":"libvmi \uc124\uce58","text":"<p>libvmi \uc124\uce58 <pre><code>$ sudo apt install -y \\\n  build-essential cmake pkg-config libtool check\n$ sudo apt install -y \\\n  libglib2.0-dev libjson-c-dev libxen-dev xenstore-utils\n$ sudo apt install -y \\\n  flex bison git python3-venv python3-pip\n\n$ git clone https://github.com/libvmi/libvmi.git\ncd libvmi\nmkdir build &amp;&amp; cd build\n\n$ cmake .. -DCMAKE_BUILD_TYPE=Release \\\n         -DENABLE_XEN=ON -DENABLE_KVM=OFF\n$ make -j\"$(nproc)\"\n$ sudo make install\n$ sudo ldconfig\n</code></pre> * \uc124\uce58\uac00 \ub05d\ub098\uba74 /usr/local/bin/ \uc544\ub798\uc5d0 vmi-* \uc608\uc81c\uac00 \uae54\ub9bc</p> <p>vmi-win-guid <pre><code>$ sudo vmi-win-guid name win10\nWindows Kernel found @ 0x2800000\n    Version: 64-bit Windows 10\n    PE GUID: bca5a8dd1046000\n    PDB GUID: b6121da15ddcf625c8c7273c0d85eb101\n    Kernel filename: ntkrnlmp.pdb\n    Multi-processor without PAE\n    Signature: 17744.\n    Machine: 34404.\n    # of sections: 33.\n    # of symbols: 0.\n    Timestamp: 3164973277.\n    Characteristics: 34.\n    Optional header size: 240.\n    Optional header type: 0x20b\n    Section 1: .rdata\n    Section 2: .pdata\n    Section 3: .idata\n    Section 4: .edata\n    Section 5: PROTDATA\n    Section 6: GFIDS\n    Section 7: Pad1\n    Section 8: .text\n    Section 9: PAGE\n    Section 10: PAGELK\n    Section 11: POOLCODE\n    Section 12: PAGEKD\n    Section 13: PAGEVRFY\n    Section 14: PAGEHDLS\n    Section 15: PAGEBGFX\n    Section 16: INITKDBG\n    Section 17: TRACESUP\n    Section 18: KVASCODE\n    Section 19: RETPOL\n    Section 20: MINIEX\n    Section 21: INIT\n    Section 22: Pad2\n    Section 23: .data\n    Section 24: ALMOSTRO\n    Section 25: CACHEALI\n    Section 26: PAGEDATA\n    Section 27: PAGEVRFD\n    Section 28: INITDATA\n    Section 29: Pad3\n    Section 30: CFGRO\n    Section 31: Pad4\n    Section 32: .rsrc\n    Section 33: .reloc\n</code></pre></p> <p>vmi-dump-memory <pre><code>$ sudo mkdir -p /root/dumps\n$ sudo install -d -m 755 /root/dumps\n$ sudo vmi-dump-memory win10 /root/dumps/mem.bin\n$ sudo strings -el /root/dumps/mem.bin | grep -F \"##4729193##\"\n##4729193##5\n</code></pre></p>"},{"location":"13-xen-pciback/#volatility","title":"volatility \ud504\ub85c\ud30c\uc77c \uc5f0\uacb0","text":"<p>volatility \uc124\uce58\ud574 \ud504\ub85c\ud30c\uc77c \ub9cc\ub4e4\uae30 <pre><code>$ python3 -m venv ~/vol3-venv\n$ source ~/vol3-venv/bin/activate\n(vol3-venv) $ pip install --upgrade pip\n(vol3-venv) $ pip install volatility3\n\n(vol3-venv) $ python3 -m volatility3.framework.symbols.windows.pdbconv \\\n  -p ntkrnlmp.pdb \\\n  -g b6121da15ddcf625c8c7273c0d85eb101 \\\n  -o ntkrnlmp.json\ndeactivate\n\n$ sudo install -d -m 755 /root/symbols\n$ sudo cp -i ~/ntkrnlmp.json /root/symbols/ntkrnlmp.json\n$ sudo chown root:root /root/symbols/ntkrnlmp.json\n$ sudo chmod 644 /root/symbols/ntkrnlmp.json\n\n$ sudo nano /etc/libvmi.conf\nwin10 {\n    volatility_ist = \"/root/symbols/ntkrnlmp.json\";\n}\n</code></pre></p> <p>\uc774\uc81c \uc774\uac8c \uc788\uc73c\uba74 \ud504\ub85c\uc138\uc2a4 \uad6c\uc870\uccb4\uc640 \uc2ec\ubcfc \uc624\ud504\uc14b\uc774 \uc788\uc5b4 vmi-process-list\ub97c \uc2e4\ud589\ud560 \uc218 \uc788\uc74c</p> <p>vmi-process-list <pre><code>$ sudo vmi-process-list win10\nProcess listing for VM win10 (id=31)\n[    4] System (struct addr:ffffd184a6891040)\n[   92] Registry (struct addr:ffffd184a7a05040)\n[  328] smss.exe (struct addr:ffffd184a7674040)\n[  420] csrss.exe (struct addr:ffffd184ab7c5080)\n[  496] wininit.exe (struct addr:ffffd184ab8f2080)\n[  636] services.exe (struct addr:ffffd184ab949080)\n[  652] lsass.exe (struct addr:ffffd184ab8ec080)\n[  756] svchost.exe (struct addr:ffffd184ab9a9240)\n[  764] fontdrvhost.ex (struct addr:ffffd184ab9aa300)\n[  876] svchost.exe (struct addr:ffffd184ac64c2c0)\n[  928] svchost.exe (struct addr:ffffd184ac653240)\n[    8] svchost.exe (struct addr:ffffd184ac6ea2c0)\n[  356] svchost.exe (struct addr:ffffd184ac6ec300)\n[  368] svchost.exe (struct addr:ffffd184ac70e280)\n...\n[ 9084] msedge.exe (struct addr:ffffd184b04130c0)\n[ 3088] msedge.exe (struct addr:ffffd184b04350c0)\n[ 6472] notepad.exe (struct addr:ffffd184adb04080)\n[ 3840] svchost.exe (struct addr:ffffd184ad7b3080)\n[  568] svchost.exe (struct addr:ffffd184b04d6340)\n[ 4744] SystemSettings (struct addr:ffffd184ad7a6080)\n[ 7744] MoUsoCoreWorke (struct addr:ffffd184ad9f0080)\n[ 7112] UserOOBEBroker (struct addr:ffffd184ac69f080)\n[ 6216] msedge.exe (struct addr:ffffd184ad54f080)\n[ 3772] msedge.exe (struct addr:ffffd184ae31e300)\n[ 3580] smartscreen.ex (struct addr:ffffd184aecc8280)\n[ 2032] FileCoAuth.exe (struct addr:ffffd184aee84240)\n[ 4584] msedge.exe (struct addr:ffffd184ac39a0c0)\n[ 3784] msedge.exe (struct addr:ffffd184ae4850c0)\n[ 4152] msedge.exe (struct addr:ffffd184ac3d8300)\n[ 2704] msedge.exe (struct addr:ffffd184ae5e80c0)\n[ 3912] msedge.exe (struct addr:ffffd184b004b0c0)\n[ 4204] svchost.exe (struct addr:ffffd184affdb0c0)\n[ 3748] msedge.exe (struct addr:ffffd184b0dda0c0)\n[ 7292] msedge.exe (struct addr:ffffd184b0deb0c0)\n</code></pre></p>"},{"location":"13-xen-pciback/#_3","title":"\ud30c\uc774\uc36c \ubc14\uc778\ub529","text":"<p>\ud30c\uc774\uc36c \ubc14\uc778\ub529 \uc124\uce58 <pre><code># (\uc100\ub3c4\uc789 \ubc29\uc9c0) \ud648\uc758 C \uc18c\uc2a4 \ud3f4\ub354 \uc774\ub984 \ubcc0\uacbd\n[ -d ~/libvmi ] &amp;&amp; mv ~/libvmi ~/libvmi-src\n\n# \ud30c\uc774\uc36c \ubc14\uc778\ub529 \uc124\uce58 (libvmi/python \uacf5\uc2dd)\nsudo apt -y install python3-pip python3-cffi python3-pkgconfig\n$ python3 -m venv ~/vmi-venv\n$ ~/vmi-venv/bin/pip install --upgrade pip\n$ ~/vmi-venv/bin/pip install 'libvmi@git+https://github.com/libvmi/python@v3.7.1'\n</code></pre></p> <p>\ud655\uc778 <pre><code>$ ~/vmi-venv/bin/python3 - &lt;&lt;'PY'\nfrom libvmi import Libvmi\nimport libvmi, inspect\nprint(\"OK:\", Libvmi)\nprint(\"Loaded from:\", getattr(libvmi, \"__file__\", None))\nPY\nOK: &lt;class 'libvmi.libvmi.Libvmi'&gt;\nLoaded from: /home/kkongnyang2/vmi-venv/lib/python3.12/site-packages/libvmi/__init__.py\n</code></pre></p> <p>\uc774\uc81c \uc774\uac8c \uc788\uc73c\uba74 C API \ub9d0\uace0 \ud30c\uc774\uc36c \ud568\uc218\ub85c \ubc14\uc778\ub529\ud574 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc74c</p>"},{"location":"13-xen-pciback/#_4","title":"\uac00\uc0c1\ud658\uacbd\uc774\ub780","text":"<p>\uc65c Volatility3\ub294 venv(\uac00\uc0c1\ud658\uacbd)\ub85c \uc124\uce58\ud588\uc744\uae4c?</p> <p>Volatility3\ub294 \uc758\uc874\uc131\uc774 \ub9ce\uace0 \uc790\uc8fc \ubc14\ub00c\ub294 \ud234\uc774\uc57c. \uc774\uac78 \uc2dc\uc2a4\ud15c \ud30c\uc774\uc36c(\uc6b0\ubd84\ud22c\uac00 \ub0b4\ubd80\uc5d0\uc11c \uc4f0\ub294 \ud30c\uc774\uc36c)\uc5d0 \uc11e\uc5b4 \uc124\uce58\ud558\uba74 apt\ub85c \uad00\ub9ac\ub418\ub294 \ud328\ud0a4\uc9c0\uc640 \ubc84\uc804 \ucda9\ub3cc\uc774 \ub098\uac70\ub098, /usr/lib/python3/dist-packages \uac19\uc740 \uc2dc\uc2a4\ud15c \ub514\ub809\ud130\ub9ac\ub97c \uc624\uc5fc\uc2dc\ucf1c\uc11c \ub2e4\ub978 \uc2dc\uc2a4\ud15c \ub3c4\uad6c(apt, Ansible, cloud-init \ub4f1)\uac00 \ub9dd\uac00\uc9c8 \uc218 \uc788\uc5b4. \uadf8\ub798\uc11c \ub3c5\ub9bd\ub41c venv\uc5d0 \ub123\uc5b4\ub450\uba74 \uadf8 venv \uc548\uc5d0\uc11c\ub9cc pip \ud328\ud0a4\uc9c0\uac00 \uae54\ub9bc \u2192 \ucda9\ub3cc/\uc624\uc5fc \ubc29\uc9c0, \uc6d0\ud558\ub294 \ubc84\uc804\uc73c\ub85c \uc790\uc720\ub86d\uac8c \uc124\uce58/\uc5c5\ub370\uc774\ud2b8 \uac00\ub2a5, \uc2e4\ud5d8 \ub05d\ub098\uba74 \ud3f4\ub354\ub9cc \uc9c0\uc6b0\uba74 \uae68\ub057\ud558\uac8c \uc0ad\uc81c</p> <p>\uc989 \uc2dc\uc2a4\ud15c \uc548\uc815\uc131 + \uc758\uc874\uc131 \uace0\ub9bd \ub54c\ubb38\uc5d0 Volatility3\ub294 venv\uc5d0 \ub450\ub294 \uac8c \uc548\uc804\ud55c \u201c\uad00\ub840\u201d\uc57c.</p> <p>\ud30c\uc774\uc36c \u201c\ud658\uacbd/\uc124\uce58\u201d\uac00 \uc5b4\ub5bb\uac8c \ub098\ub258\ub294\uc9c0?</p> <p>\uc6b0\ubd84\ud22c(24.04 \uae30\uc900)\uc5d0\ub294 \ubcf4\ud1b5 \uc2dc\uc2a4\ud15c \ud30c\uc774\uc36c\uc774 \uc788\uc5b4 (\uc608: /usr/bin/python3).</p> <p>\uc5ec\uae30\uc5d0 \ud30c\uc774\uc36c \ud328\ud0a4\uc9c0\uac00 \uae54\ub9ac\ub294 \uacbd\ub85c\ub294 \ud06c\uac8c \ub124 \uc885\ub958\uc57c:</p> <p>\uc2dc\uc2a4\ud15c(apt) \uc601\uc5ed /usr/lib/python3/dist-packages apt\ub85c \uc124\uce58\ub418\ub294 \ud328\ud0a4\uc9c0\uac00 \ub4e4\uc5b4\uac10 (\uc11e\uc73c\uba74 \uc704\ud5d8)</p> <p>\uc2dc\uc2a4\ud15c-\uc804\uc5ed pip \uc601\uc5ed /usr/local/lib/python3.X/dist-packages root\ub85c pip install \ud558\uba74 \uc5ec\uae30\uc5d0 \ub4e4\uc5b4\uac08 \uc218 \uc788\uc74c (\uad8c\uc7a5 X)</p> <p>\uc0ac\uc6a9\uc790 pip \uc601\uc5ed ~/.local/lib/python3.X/site-packages pip install --user \ub85c \uae54\ub9ac\ub294 \uacf3 (\uc2dc\uc2a4\ud15c\uacfc \ubd84\ub9ac\ub418\uc9c0\ub9cc, \uc5ec\uc804\ud788 \uc804\uc5ed PATH\uc5d0 \uc11e\uc77c \uc218 \uc788\uc74c)</p> <p>\uac00\uc0c1\ud658\uacbd(venv) ~/vol3-venv/lib/python3.X/site-packages \ud574\ub2f9 venv \uc548\uc5d0\uc11c\ub9cc \ubcf4\uc774\ub294 \u201c\ub3c5\ub9bd \uacf5\uac04\u201d \u2192 \uac00\uc7a5 \uc548\uc804</p>"},{"location":"13-xen-pciback/#_5","title":"\ud655\ucda9","text":"<p>\uc6a9\ub7c9 \ud655\ucda9 <pre><code>$ sudo qemu-img resize -f qcow2 /var/lib/xen/images/win10.qcow2 200G\n\ub4e4\uc5b4\uac00\uc11c \uadf8\ub0e5 \ucd94\uac00\ub41c 140GB\ub97c \ub4dc\ub77c\uc774\ubc84 D\ub85c \ub9cc\ub4e4\uc5b4\uc90c\n</code></pre></p> <p>\uc131\ub2a5 \ud655\ucda9, \ub9c8\uc6b0\uc2a4 \uc548\uc815\ud654 <pre><code>$ sudo nano /etc/xen/win10-all.cfg \nname = \"win10\"\ntype = \"hvm\"\nmemory = 16384\nvcpus  = 10\n\nbios  = \"seabios\"\nboot  = \"c\"\n\ndevice_model_version  = \"qemu-xen\"\ndevice_model_override = \"/usr/libexec/xen-qemu-system-i386\"\n\nvga = \"stdvga\"\nvideoram = 32\ngraphics = \"vnc\"\nvnc = 1\nvncunused = 1\nvnclisten = \"127.0.0.1\"\n\nvif = [ 'bridge=xenbr0,model=e1000,script=vif-bridge,mac=52:54:00:12:34:56' ]\n\ndisk = [\n  'format=qcow2,vdev=hda,access=rw,target=/var/lib/xen/images/win10.qcow2'\n]\n\npci = [\n  '0000:01:00.0,permissive=1'\n]\n\nusb = 1\nusbdevice = [ 'tablet' ]\n\n$ sudo xl create /etc/xen/win10-all.cfg\n$ vncviewer 127.0.0.1:5900\n</code></pre></p> <p>\ud504\ub85c\uadf8\ub7a8 <pre><code>\ubc30\ud2c0\ub137 \uc124\uce58\ud558\uace0 \ub4dc\ub77c\uc774\ubc84 D\uc5d0 \uc624\ubc84\uc6cc\uce582 \uc124\uce58\nCheat engine 7.5 window \ud504\ub85c\uadf8\ub7a8 \ub2e4\uc6b4\n</code></pre></p>"},{"location":"13-xen-pciback/#_6","title":"\ucd5c\uc885","text":"<p>vnc \uc81c\uac70 <pre><code>$ sudo nano /etc/xen/win10-monitor.cfg  \nname = \"win10\"\ntype = \"hvm\"\nmemory = 16384\nvcpus  = 10\n\nbios  = \"seabios\"\nboot  = \"c\"\n\ndevice_model_version  = \"qemu-xen\"\ndevice_model_override = \"/usr/libexec/xen-qemu-system-i386\"\n\nvif = [ 'bridge=xenbr0,model=e1000,script=vif-bridge,mac=52:54:00:12:34:56' ]\n\ndisk = [\n  'format=qcow2,vdev=hda,access=rw,target=/var/lib/xen/images/win10.qcow2'\n]\n\npci = [\n  '0000:01:00.0,permissive=1'\n]\n\n$ sudo xl create /etc/xen/win10-monitor.cfg\n</code></pre></p> <p>\uc774\ubca4\ud2b8 \uc7a1\uc544\ub0b4\uae30 \uae30\ub2a5 \ucd94\uac00 <pre><code>$ sudo sed -i -E 's/^(GRUB_CMDLINE_XEN=\")([^\"]*)\"/\\1\\2 altp2m=1\"/' /etc/default/grub.d/xen.cfg\n$ sudo update-grub\n\uc7ac\ubd80\ud305\n$ sudo nano /etc/xen/win10-monitor.cfg\naltp2m = \"external\" \ucd94\uac00\n</code></pre></p> <p>usb \uac1c\ubcc4\ub85c attach <pre><code>$ lsusb -t\n\uae30\ubcf8 \ub8e8\ud2b8 \ud5c8\ube0c\ub294 bus 1,2,3,4\uc758 \uac01\uac01 \ud3ec\ud2b81\n\uc2e4\uc81c \uc0ac\uc6a9 \uc7a5\uce58\ub294 bus 1\uc758 \ud3ec\ud2b83, \ud3ec\ud2b86, \ud3ec\ud2b814 \uc0ac\uc6a9\uc911 \ud655\uc778\n\uac8c\uc2a4\ud2b8\uc5d0 \ub118\uae38 \ucd94\uac00\ub41c \ud3ec\ud2b8\ub294 bus 1\uc758 \ud3ec\ud2b84, \ud3ec\ud2b89\n\n$ lsusb\nBus 001 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\nBus 001 Device 002: ID 046d:c54d Logitech, Inc. USB Receiver\nBus 001 Device 003: ID 04f2:b76f Chicony Electronics Co., Ltd ACER HD User Facing\nBus 001 Device 004: ID 8087:0033 Intel Corp. AX211 Bluetooth\nBus 001 Device 005: ID 3554:f58a Compx VXE NordicMouse 1K Dongle\nBus 001 Device 006: ID 046d:c31c Logitech, Inc. Keyboard K120\nBus 002 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub\nBus 003 Device 001: ID 1d6b:0002 Linux Foundation 2.0 root hub\nBus 004 Device 001: ID 1d6b:0003 Linux Foundation 3.0 root hub\n\uc7a5\uce58 5,6 \ud655\uc815\n\n$ sudo xl usbctrl-attach win10 type=auto version=3 ports=15\n$ sudo xl usbdev-attach  win10 hostbus=1 hostaddr=5 controller=0 port=1\n$ sudo xl usbdev-attach  win10 hostbus=1 hostaddr=6 controller=0 port=2\n</code></pre></p>"},{"location":"14-summary/","title":"14 summary","text":""},{"location":"14-summary/#debug","title":"\uc131\uacf5\ube44\uacb0. debug","text":"<p>(1) auto select\uc640 optimus \ucc28\uc774 \uc9c0\uae08\uae4c\uc9c0\ub294 optimus\ub294 \ubc31\ub77c\uc774\ud2b8 \ubc1d\uae30 \uc870\uc808\uc774 \uc548\ub418\ub294\uac70\ubc16\uc5d0 \uc5c6\uc74c. \ub458\ub2e4 \uc798 \ubd80\ud305\ub428</p> <p>(2) secure boot \ub044\uae30 \uacc4\uc18d \uc11c\uba85 \ubb38\uc81c\ub97c \uc77c\uc73c\ud0b4</p> <p>(3) vmd controller \ub044\uae30 \uacc4\uc18d ssd \uc778\uc2dd \ubb38\uc81c\ub97c \uc77c\uc73c\ud0b4</p> <p>(4) 24.04 \ubc84\uc804 \uc0ac\uc6a9 \uad6c\ubc84\uc804\uc740 \ucd5c\uc2e0 \ud558\ub4dc\uc6e8\uc5b4\ub4e4\uc744 \uc798 \ubabb\ubc1b\ub294 \ucee4\ub110\uc784</p> <p>(5) \ud654\uba74 \uc774\uc288. grub \ucee4\ub9e8\ub4dc <pre><code>echo 'GRUB_CMDLINE_XEN=\"iommu=1 iommu=verbose dom0_mem=4096M,max:4096M\"' | sudo tee /etc/default/grub.d/xen.cfg\necho 'GRUB_CMDLINE_LINUX_XEN_REPLACE=\"xen-pciback.hide=(01:00.0)(01:00.1) modprobe.blacklist=nvidia,nvidia_drm,nvidia_modeset,nouveau\"' \\\n| sudo tee -a /etc/default/grub.d/xen.cfg\n</code></pre> kvm\uc744 \ud558\ub4e0 xen\uc744 \ud558\ub4e0 grub\uc5d0\uc11c nvidia gpu\ub97c \uc798 \uc228\uae30\ub294 \uac8c \uad00\uac74\uc778\ub4ef.</p> <p>(6) ovmf\ub300\uc2e0 seabios\ub85c vm \uc0dd\uc131 seabios win10 \ud558\ub2c8\uae4c vm \ub9cc\ub4e4\uc5b4\uc9d0</p> <p>(7) libvmi conf \ud30c\uc77c \ud615\uc2dd <pre><code>$ sudo nano /etc/libvmi.conf\nwin10-seabios {\n    volatility_ist = \"/root/symbols/ntkrnlmp.json\";\n}\n</code></pre> \ud558\ub2c8\uae4c \uc5f0\uacb0\ub428</p> <p>\uc774\uac70 \uc774\uc6a9\ud558\uba74 \ub2e4\ub978 \ubc29\uc2dd\ub3c4 \uc131\uacf5\ud560 \uc218 \uc788\uc744\uac78\ub85c \uc0dd\uac01.</p>"},{"location":"14-summary/#_1","title":"\uad00\ub9ac","text":"<p>\uc55e\uc73c\ub85c ubuntu on xen hypervisor \ub4e4\uc5b4\uac00\uc11c </p> <p>\uad00\ub9ac\ubaa8\ub4dc <pre><code>lsmod | grep xen_pciback || sudo modprobe xen_pciback \nDRVDIR=$(ls -d /sys/bus/pci/drivers/pciback /sys/bus/pci/drivers/xen-pciback 2&gt;/dev/null | head -n1)\necho 0000:01:00.1 | sudo tee /sys/bus/pci/devices/0000:01:00.1/driver/unbind\necho 0000:01:00.1 | sudo tee \"$DRVDIR/bind\"\nsudo xl pci-assignable-list\n\ub79c\uc120 \uc5f0\uacb0\nsudo xl create /etc/xen/win10-all.cfg\nhdmi \uc5f0\uacb0\nvncviewer 127.0.0.1:5900\n</code></pre></p> <p>\uc2e4\uc804\ubaa8\ub4dc <pre><code>lsmod | grep xen_pciback || sudo modprobe xen_pciback \nDRVDIR=$(ls -d /sys/bus/pci/drivers/pciback /sys/bus/pci/drivers/xen-pciback 2&gt;/dev/null | head -n1)\necho 0000:01:00.1 | sudo tee /sys/bus/pci/devices/0000:01:00.1/driver/unbind\necho 0000:01:00.1 | sudo tee \"$DRVDIR/bind\"\nsudo xl pci-assignable-list\n\ub79c\uc120 \uc5f0\uacb0\nsudo xl create /etc/xen/win10-monitor.cfg\nhdmi \uc5f0\uacb0\nlsusb\nsudo xl usbctrl-attach win10 type=auto version=3 ports=15\nsudo xl usbdev-attach  win10 hostbus=1 hostaddr=5 controller=0 port=1\nsudo xl usbdev-attach  win10 hostbus=1 hostaddr=6 controller=0 port=2\n</code></pre></p> <p>\uc544\uc774\ucf58\uc73c\ub85c \ub9cc\ub4e4\uc5b4\ub193\uc74c <pre><code>kkongnyang2@acer:~$ mkdir -p ~/bin\nkkongnyang2@acer:~$ nano ~/bin/win10-monitor-setup.sh\n#!/usr/bin/env bash\nset -euo pipefail\n\n# --------- Helper: pretty print ----------\nsay() { printf \"\\n\\033[1;36m[ \uc548\ub0b4 ]\\033[0m %s\\n\" \"$*\"; }\nrun() { echo -e \"\\033[1;33m$ $*\\033[0m\"; eval \"$@\"; }\n\n# --------- 0) \uc0ac\uc6a9\uc790 \uc548\ub0b4 ----------\nsay \"\ub79c\uc120\uc744 \uc5f0\uacb0\ud574\uc8fc\uc138\uc694.\"\nsleep 5\n\nsay \"\ubaa8\ub2c8\ud130\ub97c \ucf1c\uace0 \ucf00\uc774\ube14\uc744 \uc5f0\uacb0\ud574\uc8fc\uc138\uc694.\"\nsleep 5\n\n# --------- 1) xen-pciback \ubaa8\ub4c8 \uc900\ube44 ----------\nif ! lsmod | grep -qE '^xen_pciback\\s'; then\n  say \"xen_pciback \ubaa8\ub4c8\uc744 \uc801\uc7ac\ud569\ub2c8\ub2e4.\"\n  run sudo modprobe xen_pciback\nelse\n  say \"xen_pciback \ubaa8\ub4c8\uc774 \uc774\ubbf8 \uc801\uc7ac\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4.\"\nfi\n\n# --------- 2) GPU \uc624\ub514\uc624 \ud568\uc218(0000:01:00.1) pciback\ub85c \uc7ac\ubc14\uc778\ub529 ----------\n# (\ud544\uc694 \uc2dc \uc7a5\uce58 \uc8fc\uc18c\ub97c \ubc14\uafd4\uc8fc\uc138\uc694)\nBDF_AUDIO=\"0000:01:00.1\"\n\n# \ub4dc\ub77c\uc774\ubc84 \ub514\ub809\ud130\ub9ac \ud0d0\uc0c9\nDRVDIR=$(ls -d /sys/bus/pci/drivers/pciback /sys/bus/pci/drivers/xen-pciback 2&gt;/dev/null | head -n1 || true)\nif [[ -z \"${DRVDIR:-}\" ]]; then\n  echo \"pciback \ub4dc\ub77c\uc774\ubc84 \ub514\ub809\ud130\ub9ac\ub97c \ucc3e\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.\"; exit 1\nfi\n\n# \ubc14\uc778\ub529 \ubcc0\uacbd\nif [[ -e \"/sys/bus/pci/devices/$BDF_AUDIO/driver/unbind\" ]]; then\n  say \"$BDF_AUDIO \uc7a5\uce58\ub97c \ud604\uc7ac \ub4dc\ub77c\uc774\ubc84\uc5d0\uc11c \ubd84\ub9ac(unbind)\ud569\ub2c8\ub2e4.\"\n  echo \"$BDF_AUDIO\" | sudo tee \"/sys/bus/pci/devices/$BDF_AUDIO/driver/unbind\" &gt;/dev/null\nfi\nsay \"$BDF_AUDIO \uc7a5\uce58\ub97c pciback\uc5d0 \ubc14\uc778\ub4dc\ud569\ub2c8\ub2e4. ($DRVDIR/bind)\"\necho \"$BDF_AUDIO\" | sudo tee \"$DRVDIR/bind\" &gt;/dev/null\n\n# \ud655\uc778\nsay \"\uc9c0\uae08 \ud560\ub2f9 \uac00\ub2a5\ud55c PCI \ub9ac\uc2a4\ud2b8\ub97c \ud655\uc778\ud569\ub2c8\ub2e4.\"\nrun sudo xl pci-assignable-list || true\n\n# --------- 3) \uac8c\uc2a4\ud2b8 \ubd80\ud305 ----------\nCFG=\"/etc/xen/win10-monitor.cfg\"\nif [[ ! -f \"$CFG\" ]]; then\n  echo \"Xen cfg \ud30c\uc77c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4: $CFG\"; exit 1\nfi\n\nsay \"\uc708\ub3c4\uc6b0 VM\uc744 \ucf2d\ub2c8\ub2e4: $CFG\"\nrun sudo xl create \"$CFG\"\n\nsay \"\ucf1c\ub294 \uc911\uc785\ub2c8\ub2e4. \ubbf8\ub9ac \ud0a4\ubcf4\ub4dc\uc640 \ub9c8\uc6b0\uc2a4\ub97c \uc5f0\uacb0\ud574\uc8fc\uc138\uc694.\"\nsleep 15\n\n# --------- 4) USB \uc2dd\ubcc4 (lsusb \ud30c\uc2f1) ----------\nsay \"lsusb \ub85c \uc7a5\uce58\ub97c \uc2dd\ubcc4\ud569\ub2c8\ub2e4.\"\nrun lsusb\n\n# \ub300\uc0c1 \uc7a5\uce58 ID (\ud544\uc694\ud558\uba74 \uc544\ub798 \ub450 \uc904\ub9cc \uc218\uc815)\nID_MOUSE=\"3554:f58a\"   # Compx VXE NordicMouse 1K Dongle\nID_KEYBD=\"1a2c:4c5e\"   # China Resource Semico USB Keyboard\n\nparse_bus_dev() {\n  # stdin: lsusb \ud55c \uc904\n  # stdout: \"&lt;bus&gt; &lt;dev&gt;\" (\uc22b\uc790)\n  awk '{b=$2; d=$4; gsub(\":\",\"\",d); printf(\"%d %d\\n\", b, d); exit}'\n}\n\nLSUSB_OUT=\"$(lsusb)\"\n\nMOUSE_LINE=$(grep -i \"$ID_MOUSE\" &lt;&lt;&lt;\"$LSUSB_OUT\" || true)\nKEYBD_LINE=$(grep -i \"$ID_KEYBD\" &lt;&lt;&lt;\"$LSUSB_OUT\" || true)\n\nif [[ -z \"$MOUSE_LINE\" || -z \"$KEYBD_LINE\" ]]; then\n  echo \"\ud544\uc694\ud55c USB \uc7a5\uce58\ub97c \ucc3e\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4.\n- \ub9c8\uc6b0\uc2a4($ID_MOUSE): ${MOUSE_LINE:-\uc5c6\uc74c}\n- \ud0a4\ubcf4\ub4dc($ID_KEYBD): ${KEYBD_LINE:-\uc5c6\uc74c}\n\uc7a5\uce58\ub97c \ube90\ub2e4 \ub2e4\uc2dc \uaf42\uc740 \ub4a4 \ub2e4\uc2dc \uc2e4\ud589\ud574\ubcf4\uc138\uc694.\"\n  exit 1\nfi\n\nread MOUSE_BUS MOUSE_DEV &lt; &lt;(echo \"$MOUSE_LINE\" | parse_bus_dev)\nread KEYBD_BUS KEYBD_DEV &lt; &lt;(echo \"$KEYBD_LINE\" | parse_bus_dev)\n\nsay \"\uac10\uc9c0\ub41c \uc7a5\uce58:\"\necho \"  - Mouse : Bus ${MOUSE_BUS} Device ${MOUSE_DEV} ($ID_MOUSE)\"\necho \"  - Keyboard: Bus ${KEYBD_BUS} Device ${KEYBD_DEV} ($ID_KEYBD)\"\n\n# --------- 5) USB \ucee8\ud2b8\ub864\ub7ec/\ub514\ubc14\uc774\uc2a4 \ubd80\ucc29 ----------\n# \uba3c\uc800 USB3 \uc2dc\ub3c4 (type=auto version=3), \uc2e4\ud328 \uc2dc version=2\ub85c \ud3f4\ubc31\nsay \"USB \ucee8\ud2b8\ub864\ub7ec \ubd80\ucc29 (\uc6b0\uc120 USB3 \uc2dc\ub3c4, \uc2e4\ud328 \uc2dc USB2\ub85c \ud3f4\ubc31)\"\nif ! sudo xl usbctrl-attach win10 type=auto version=3 ports=15; then\n  echo \"USB3 \ubd80\ucc29 \uc2e4\ud328 \u2192 USB2\ub85c \uc7ac\uc2dc\ub3c4\"\n  run sudo xl usbctrl-attach win10 type=auto version=2 ports=15\nfi\n\n# \ud3ec\ud2b8 \ub9e4\ud551: \ub9c8\uc6b0\uc2a4 port=1, \ud0a4\ubcf4\ub4dc port=2\nsay \"USB \ub514\ubc14\uc774\uc2a4\ub97c \ucee8\ud2b8\ub864\ub7ec\uc5d0 \ubd80\ucc29\ud569\ub2c8\ub2e4.\"\nrun sudo xl usbdev-attach win10 hostbus=\"${MOUSE_BUS}\" hostaddr=\"${MOUSE_DEV}\" controller=0 port=1\nrun sudo xl usbdev-attach win10 hostbus=\"${KEYBD_BUS}\" hostaddr=\"${KEYBD_DEV}\" controller=0 port=2\n\n# --------- 6) \uc644\ub8cc ----------\nsay \"\uc124\uc815\uc774 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.\"\nsleep 1\nexit 0\nkkongnyang2@acer:~$ chmod +x ~/bin/win10-monitor-setup.sh\nkkongnyang2@acer:~$ mkdir -p ~/.local/share/applications\nkkongnyang2@acer:~$ nano ~/.local/share/applications/win10-monitor.desktop\n# \uc800\uc7a5 \uacbd\ub85c: ~/.local/share/applications/win10-monitor.desktop\n[Desktop Entry]\nType=Application\nName=Win10 \ubaa8\ub2c8\ud130 \ubd80\ud305 &amp; USB \uc138\ud305\nComment=\ub79c\uc120/\ubaa8\ub2c8\ud130 \uc548\ub0b4 \ud6c4 Xen VM \ubd80\ud305 \ubc0f USB \uc790\ub3d9 \uc5f0\uacb0\nExec=gnome-terminal -- bash -lc '~/bin/win10-monitor-setup.sh'\nIcon=computer\nTerminal=false\nCategories=Utility;\nkkongnyang2@acer:~$ chmod +x ~/.local/share/applications/win10-monitor.desktop\nkkongnyang2@acer:~$ cp ~/.local/share/applications/win10-monitor.desktop ~/Desktop/\nkkongnyang2@acer:~$ chmod +x ~/Desktop/win10-monitor.desktop\n\ubc14\ud0d5\ud654\uba74 \uc544\uc774\ucf58 \uc6b0\ud074\ub204\ub974\uace0 allow launching\n</code></pre></p> <p>\uc5c5\ub370\uc774\ud2b8 \ud558\uace0\ub098\uba74 <pre><code>sudo vmi-win-guid name win10\nPDB GUID: f388d1c459c2dc9e81f891d0760a56cd1\nsource ~/vol3-venv/bin/activate\npython3 -m volatility3.framework.symbols.windows.pdbconv \\\n  -p ntkrnlmp.pdb \\\n  -g f388d1c459c2dc9e81f891d0760a56cd1 \\\n  -o ntkrnlmp.json   \ndeactivate\nsudo cp -i ~/ntkrnlmp.json /root/symbols/ntkrnlmp.json\ny\n</code></pre></p>"},{"location":"15-CE-tutorial/","title":"15 CE tutorial","text":""},{"location":"15-CE-tutorial/#cheat-engine","title":"cheat engine \ud29c\ud1a0\ub9ac\uc5bc\uc744 \uc5f0\uc2b5\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-07-14</p>"},{"location":"15-CE-tutorial/#ce-tutorial-14","title":"CE tutorial 1~4","text":"<p>\uc8fc\uc18c \ud0d0\uc0c9 <pre><code>newscan \ub204\ub974\uae30\n\ucc3d\uc5d0 initial \uac12 \uc785\ub825 \ud6c4 firstscan\n\uac12 \ubcc0\ud654\uc2dc\ud0a4\uae30\n\ucc3d\uc5d0 second \uac12 \uc785\ub825 \ud6c4 nextscan\n\ubaa9\ub85d \ucd94\ub824\uc9c0\uba74 \ud074\ub9ad\ud574\uc11c \uc544\ub798 \uc791\uc5c5\ubc14\uc5d0 \ub0b4\ub9ac\uace0 \uac12 \uc870\uc791\n</code></pre></p>"},{"location":"15-CE-tutorial/#_1","title":"\ube4c\ub4dc\uc640 \ub7f0 \uc774\ud574\ud558\uae30","text":"<p>\ube4c\ub4dc = \uc18c\uc2a4 \ud30c\uc77c\uc744 \uc2e4\ud589 \ud30c\uc77c\ub85c \ucef4\ud30c\uc77c. \ub2e8 \ud55c\ubc88. \ub7f0 = \uadf8 \uc2e4\ud589 \ud30c\uc77c\uc774 \uba54\ubaa8\ub9ac\uc5d0 \uc62c\ub77c\uc640\uc11c \ud504\ub85c\uc138\uc2a4\ub85c \ub3cc\uc544\uac10.</p> <p>\ube4c\ub4dc\ub294 \uc18c\uc2a4 \ud30c\uc77c\uc758 \ubaa8\ub4e0 \ud568\uc218\ub97c \uc5b4\uc148\ube14\ub9ac\uc5b4\ub85c \ub9cc\ub4e4\uace0 .text\uc640 .data \ub4f1 \uc139\uc158\uc744 \ub098\ub220 \uc800\uc7a5\ud55c\ub2e4. \uc5b4\ucc28\ud53c \uc804\ubd80 \uac00\uc0c1\uc8fc\uc18c\uae34 \ud574\ub3c4 \ud568\uc218 \uac04\uc758 \uc624\ud504\uc14b\uc740 \uc644\ubcbd\ud558\uac8c \uace0\uc815\ub41c\ub2e4. \uadf8\ub807\uae30\uc5d0 press_button() \ud568\uc218\uc5d0\uc11c hp_edit() \ud568\uc218\ub85c, struct player \ub370\uc774\ud130\ub85c, \uc774 \uc0ac\uc774\uc5d0\ub294 \uc815\ud574\uc9c4 \uac70\ub9ac\uac00 \uc788\uc5b4 \uadf8\ub807\uac8c \ud638\ucd9c\uc774 \uac00\ub2a5\ud558\ub2e4. \uadf8\uac78 \uc624\ud504\uc14b\uc774\ub77c \ubd80\ub978\ub2e4.</p> <p><pre><code># foo() \uc548\uc5d0\uc11c bar() \ud638\ucd9c (x86-64 PIE)\ncall  [rip + 0x34]   ; \u2190 0x34\ub294 bar \uae4c\uc9c0\uc758 \uac70\ub9ac\n\n# \ub9cc\uc57d \uc9c4\uc9dc \uc678\ubd80\uc5d0 \uc788\uc73c\uba74?(\ub77c\uc774\ube0c\ub7ec\ub9ac \ub4f1)\n# \uc678\ubd80 \uc2ec\ubcfc bar() \ud638\ucd9c\ncall  QWORD PTR [rip + .got.plt.bar]  ; GOT \uc2ac\ub86f\uc5d0 patch\ub41c \uc808\ub300\uc8fc\uc18c\ub97c \uc77d\uc74c\n</code></pre> <pre><code>0x000055f4_9c8a0000  \u2500\u2500 [\ud14d\uc2a4\ud2b8]  \u2190 PIE \ubca0\uc774\uc2a4 (ASLR\ub85c \ub9e4 \uc2e4\ud589\ub9c8\ub2e4 \ubcc0\ub3d9)\n                     \u251c\u2500 [rodata]\n                     \u251c\u2500 [data]     \u2190 g_player\n                     \u251c\u2500 [bss]\n                     \u251c\u2500 (heap)     \u2190 malloc() \uad6c\uc870\uccb4\ub4e4 \u2026 \u2191 \uc131\uc7a5\n0x00007f3d_40000000  \u2500\u2500 [libc.so]  \u2190 \uacf5\uc720 \ub77c\uc774\ube0c\ub7ec\ub9ac \ubca0\uc774\uc2a4\n                     \u251c\u2500 \uae30\ud0c0 .so \u2026\n                     \u251c\u2500 (\uc775\uba85 mmap/JIT \uc601\uc5ed)\n0x00007ffe_fffe0000  \u2500\u2500 [stack]    \u2190 \uc2a4\ub808\ub4dc\ub9c8\ub2e4 \uc0c8\ub85c, \uc704\uc5d0\uc11c \u2193 \uc131\uc7a5\n</code></pre></p> <p>\uc6b0\ub9ac\uac00 \uc774\uac78 \ub7f0\ud558\uba74 \uc0c8\ub85c \uc21c\ucc28\uc801\uc73c\ub85c \ucf54\ub4dc\ub4e4\uc774 \uc0dd\uae30\ub294 \uac8c \uc544\ub2c8\ub77c \uc774 \ube4c\ub4dc \uc2e4\ud589 \ud30c\uc77c \uc548\uc5d0\uc11c \uc704\uce58\ub9cc \uc62e\uaca8\uac00\uba70 \uac01 \uc904\uc744 cpu\ub85c \uc791\ub3d9\uc2dc\ud0a4\ub294 \uac83\uc774\ub2e4. \ubaa8\ub4e0 \ud589\ub3d9\uc740 \uc774\ubbf8 \uc644\ubcbd\ud558\uac8c \uaddc\uc728\ub85c \uc9c0\uc815\ub418\uc5b4 \uc788\ub2e4. \ud558\ub4dc\uc6e8\uc5b4 \uc778\ud130\ub7fd\ud2b8\uac00 \ucee4\ub110 \ub2e8\uc5d0\uc11c \uc791\ub3d9\ub418\uba74 \uadf8\uac8c \uc5b4\ub290 \uc8fc\uc18c\ub85c \ud5a5\ud558\uace0 \uadf8 \ub2e4\uc74c\uc740 \uc5b4\ub514\ub85c \uc815\ud574\uc838 \uc788\ub294\uc9c0\uc758 \ubb38\uc81c\uc774\ub2e4. \ubb3c\ub860 \uc778\ud130\ub7fd\ud2b8\uc5d0 \uc758\ud574 \uc0c8\ub85c \ud560\ub2f9\ub418\ub294 \ub370\uc774\ud130\ub4e4\ub3c4 \uc788\uae34 \ud558\ub2e4. \uc774\uac83\ub4e4\uc740 \ud799, \uc2a4\ud0dd\ub4e4\ub85c \uc313\uc778\ub2e4.</p> <p>\uc989, \ube4c\ub4dc\ub294 \uc644\ubcbd\ud788 \uace0\uc815\ub41c \ud37c\uc990, \ub7f0\uc740 \ubca0\uc774\uc2a4 \uc8fc\uc18c\ub97c \uae30\ubc18\uc73c\ub85c \uadf8 \ud37c\uc990 \uc804\uccb4\ub97c \uadf8\ub300\ub85c \uc62c\ub9ac\uace0, \uc0ac\uc6a9\uc790 \uc778\ud130\ub7fd\ud2b8\uc5d0 \uc758\ud574 \ucd94\uac00 \ub370\uc774\ud130\uac00 \ub354 \ud560\ub2f9\ub418\ub294 \uac83.</p> <pre><code>\u250c\u2500[\ube4c\ub4dc \ub2e8\uacc4]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \u2460 \ubaa8\ub4e0 \ucf54\ub4dc\u00b7\uc804\uc5ed\u00b7\uc0c1\uc218 \u2192 \ud55c \ud37c\uc990\ucc98\ub7fc \u201c\uc138\uadf8\uba3c\ud2b8 + \uc624\ud504\uc14b\u201d \uace0\uc815 \u2502\n\u2502    (.text / .rodata / .data / .bss)                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2193 execve()\n\u250c\u2500[\ub7f0\ud0c0\uc784: \ud504\ub85c\uc138\uc2a4 \uc2dc\uc791]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \u2461 \ucee4\ub110\u00b7ld.so\uac00 \ubca0\uc774\uc2a4 \uc8fc\uc18c(ASLR)\ub9cc \uc815\ud574 mmap       \u2502\n\u2502    \u2500\u2500&gt; \u201c\ud37c\uc990\u201d \uc804\uccb4\ub97c \ud55c \ubc88\uc5d0 \uac00\uc0c1\uacf5\uac04\uc5d0 \uc62c\ub9bc        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2193 \uac8c\uc784 \uc9c4\ud589\n\u250c\u2500[\ub7f0\ud0c0\uc784: \ub3d9\uc801 \ub3d9\uc791]\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 \u2462 \uc0ac\uc6a9\uc790 \uc785\ub825\u00b7\ub124\ud2b8\uc6cc\ud06c \uc774\ubca4\ud2b8 \ub4f1 \u2192 \ud799/\uc2a4\ud0dd/mmap\uc5d0 \u2502\n\u2502    \uc0c8 \uac1d\uccb4\u00b7\ubc84\ud37c\ub97c **\ud544\uc694\ud560 \ub54c\ub9c8\ub2e4** \ucd94\uac00           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n</code></pre> <p>\ucc38\uace0\ub85c \ubaa8\ub4e0 \ud504\ub85c\uc138\uc2a4\ub4e4\uc740 \uba54\ubaa8\ub9ac \ub4b7\ubd80\ubd84\uc5d0 \ucee4\ub110\uc744 \uacf5\ud1b5\uc73c\ub85c \uac00\uc9c0\uace0 \uc788\ub2e4.</p>"},{"location":"15-CE-tutorial/#ce-tutorial-57","title":"CE tutorial 5,7","text":"<p>\ucf54\ub4dc \ubb34\ud6a8\ud654 <pre><code>\uac12 \uc8fc\uc18c \ud0d0\uc0c9 \ud6c4 what writes this address \ub4e4\uc5b4\uac00\uc11c \ub514\uc2a4\uc5b4\uc148\ube14\ub7ec \ubcf4\uae30. \ud574\ub2f9 \uc904 \ucf54\ub4dc\ub97c replace with code that does nothing \ub610\ub294 add 2\ub85c \ubc14\uafb8\uba74 \uccb4\ub825\uac12\uc744 \uc4f0\ub294 \ucf54\ub4dc\uac00 \ubb34\ud6a8\ud654\ub418\uac70\ub098 \uc624\ud788\ub824 \ud50c\ub7ec\uc2a4\ub85c \ubc14\ub010\ub2e4.\n</code></pre></p> <p>\ucf54\ub4dc \uc778\uc81d\uc158 <pre><code>\ub514\uc2a4\uc5b4\uc148\ube14\ub9ac\uc5d0\uc11c ctrl+A \ub20c\ub7ec \uc5b4\uc148\ube14\ub7ec \ucc3d \uc5f4\uae30. code injection\uc744 \ud074\ub9ad\ud558\uace0 \uc6d0\ud558\ub294 \ubd80\ubd84\uc758 \ub0b4\uc6a9 \uc218\uc815\n</code></pre></p> <p>\ud504\ub9ac\uc9d5 <pre><code>active X\ub97c \uccb4\ud06c\ud574\uc8fc\uba74 \uc774\uc81c \uadf8 \uc77c\ubc18 \uc8fc\uc18c \ub610\ub294 \uccb4\uc778 \uc8fc\uc18c\ub294 \ud65c\ub3d9\uc744 \ubabb\ud558\uac8c\ub428. \ud504\ub85c\uadf8\ub7a8 \ubca0\uc774\uc2a4\uac00 \ubc14\ub00c\uace0 \ubb58 \uc4f0\ub824\ud574\ub3c4 \uacc4\uc18d \uccb4\uc778 \ucad3\uc544\uac00\uc11c \ub05d\uc5d0 \ub0b4\uac00 \uc368\uc900 \uac12\uc73c\ub85c \ub36e\uc5b4\uc4f0\uae30\ud568.\n</code></pre></p>"},{"location":"15-CE-tutorial/#ce-tutorial-68","title":"CE tutorial 6,8","text":"<p>\uac8c\uc784 \uc9c4\ud589 \ub3c4\uc911 \uc0c8 \ud50c\ub808\uc774\uc5b4\uc758 hp\uc640 ammo\ub97c \uc5b4\ub5bb\uac8c \ud560\ub2f9\ud560\uae4c?</p> <p>struct player *p = malloc(sizeof *p);   // (1) rax \u2190 \uc0c8 \ud799 \uc8fc\uc18c g_local_player   = p;                   // (2) \ucf54\ub4dc\uac00 \uc804\uc5ed \ubcc0\uc218\uc5d0 \uc800\uc7a5</p> <p>\uc774\ub7f0 \uad6c\uc870\ub97c \ud1b5\ud574 \ud560\ub2f9\ud55c\ub2e4. \ub530\ub77c\uc11c \uc6b0\ub9ac\ub294 \ud50c\ub808\uc774\uc5b4 \ub9c8\ub2e4 \uac12\uc774 \uc801\ud78c \uc8fc\uc18c\ub97c \uc77c\uc77c\ud788 \ucc3e\uc544\ub2e4\ub2d0\uac8c \uc544\ub2c8\ub77c, \uc800 \ud560\ub2f9\ud558\uace0 \ud3ec\uc778\ud130\ud558\ub294 (\ubca0\uc774\uc2a4 \uc8fc\uc18c \uae30\uc900\uc73c\ub85c)\uace0\uc815\ub41c \uc9c4\uc6d0\uc9c0 \uc790\uccb4\ub97c \ucc3e\uc544\uc57c \ud55c\ub2e4.</p> <pre><code>[game.bin+0x1BCF30]   \u2192 0x0000006002A000   (\uc804\uc5ed \ud3ec\uc778\ud130, \uc624\ud504\uc14b \uace0\uc815)\n                                    \u2502\n                                    \u251c\u2500 hp  = *(+0x00)\n                                    \u251c\u2500 ammo= *(+0x04)\n                                    \u2514\u2500 pos  = *(+0x08) \u2026\n</code></pre> <p>\uc6b0\ub9ac\ub294 \uc800 \uac12\uc774 \ub2f4\uae34 \uc8fc\uc18c\ub97c \ub204\uac00 access \ud558\ub294\uc9c0 \uc9c4\uc6d0\uc9c0\ub97c \ucc3e\uc744 \uac83\uc774\ub2e4. \ud29c\ud1a0\ub9ac\uc5bc\uc5d0\uc11c change value\ub77c\ub294 \ubc84\ud2bc\uc744 \ub20c\ub7ec\uc11c \uac12\uc744 \ud560\ub2f9\ud558\uace0 \uc4f0\uae30 \uba85\ub839\uc744 \ub0b4\ub838\ub2e4 \ud588\uc744 \ub54c \uc774\ub97c \ub530\ub77c\uac00\ubcf4\uc790.</p> <p>\uba3c\uc800 \uc6a9\uc5b4 \uc815\ub9ac. \ubca0\uc774\uc2a4 \uc8fc\uc18c\ub294 \ub7f0\ud560\ub54c \uc815\ud574\uc9c0\ub294 \uc601\uc810 \uc870\uc808 \uac19\uc740 \uac83\uc774\ub2e4. game.bin \ud3ec\uc778\ud130\ub294 \uac12 \ubd80\ubd84\uc5d0 \uc218\uce58\ub97c \uc785\ub825\ud558\ub294\uac8c \uc544\ub2c8\ub77c \uc8fc\uc18c\ub97c \uc785\ub825\ud558\ub294 4\ubc14\uc774\ud2b8(64\ube44\ud2b8 os\uba74 8\ubc14\uc774\ud2b8)\ub2e4. 0x0000006002A000\ub77c\ub294 \uc8fc\uc18c\uac12\uc744 \uc801\uc5b4\uc900\ub2e4. \uc624\ud504\uc14b\uc740 \uace0\uc815\ub41c \ud37c\uc990\uc5d0\uc11c\uc758 \uac70\ub9ac\ub97c \ub73b\ud55c\ub2e4. +\ub4a4\uc5d0 \uc801\ud78c \uac78 \uc758\ubbf8\ud55c\ub2e4.</p> <p>\ub9cc\uc57d \ube4c\ub4dc \ub54c \uc774\ubbf8 \uc704\uce58\uac00 \uc815\ud574\uc9c4 \uc815\uc801 \ub370\uc774\ud130\uba74 \ud3ec\uc778\ud130\ub97c \uc4f8 \ud544\uc694\ub3c4 \uc5c6\uc774 \uac70\ub9ac\ub85c \ubc14\ub85c \uc77d\uc73c\uba74 \ub41c\ub2e4.</p> <p>\uac12\uc5d0\uc11c\ubd80\ud130 \uccb4\uc778 \ub530\ub77c\uac00\uae30 <pre><code>Find out what writes to this address -&gt; \uc4f0\uae30 \ud0c0\uc785 \uba85\ub839\ub9cc\nFind out what accesses this address -&gt; \ubaa8\ub4e0 \ud0c0\uc785 \uba85\ub839(\ucc38\uc870 \ub4f1\ub4f1)\n\n# \uac12\uc774 \ub2f4\uae34 \uc8fc\uc18c \ud0d0\uc0c9\n# 15C4508. what writes\n# \uccb4\ub825\uac12 16F\ub97c 15C44F0 + 18 \uc704\uce58\uc5d0 \uc801\uc73c\ub77c\ub294 \ucf54\ub4dc \ubc1c\uacac\n\"Tutorial-x86_64.exe\"+4910A:\n10004910A - 89 46 18  - mov [rsi+18],eax &lt;&lt;\nRAX=000000000000016F\nRSI=00000000015C44F0\n\n# 15C44F0\ub97c \ud3ec\uc778\ud305 \ud558\ub294 \uc8fc\uc18c \ud0d0\uc0c9\n# 1642E30. what access\n# 1642E30 \uc704\uce58\uc5d0 \uc788\ub358 \uac12 15C44F0\uc744 \ubd88\ub7ec\uc624\ub294 \ucf54\ub4dc \ubc1c\uacac\n\"Tutorial-x86_64.exe\"+490C8:\n1000490C8 - 48 8B 36  - mov rsi,[rsi] &lt;&lt;\nRAX=0000000001642E30\nRSI=00000000015C44F0\n\n# 1642E30\uc744 \ud3ec\uc778\ud305 \ud558\ub294 \uc8fc\uc18c \ud0d0\uc0c9\n# 162A838. what access\n# 162A820 + 18 \uc704\uce58\uc5d0 \uc788\ub358 \uac12 1642E30\uc744 \ubd88\ub7ec\uc624\ub294 \ucf54\ub4dc \ubc1c\uacac\n\"Tutorial-x86_64.exe\"+4907C:\n10004907C - 48 8B 76 18  - mov rsi,[rsi+18] &lt;&lt;\nRAX=000000000162A820\nRSI=0000000001642E30\n\n# 162A820\uc744 \ud3ec\uc778\ud305 \ud558\ub294 \uc8fc\uc18c \ud0d0\uc0c9\n# 162A5B0. what access\n# 162A5A0 + 10 \uc704\uce58\uc5d0 \uc788\ub358 \uac12 162A820\uc744 \ubd88\ub7ec\uc624\ub294 \ucf54\ub4dc \ubc1c\uacac\n\"Tutorial-x86_64.exe\"+49034:\n100049034 - 48 8B 76 10  - mov rsi,[rsi+10] &lt;&lt;\nRAX=000000000162A5A0\nRSI=000000000162A820\n\n# 162A5A0\uc744 \ud3ec\uc778\ud305 \ud558\ub294 \uc8fc\uc18c \ud0d0\uc0c9\n# \"tutorial-x86_64.exe\"+34ECA0.\n\n10034ECA0 -&gt; 162A5A0 + 10 -&gt; 162A820 + 18 -&gt; 1642E30 -&gt; 15C44F0 + 18 -&gt; 16F\n\n# add address manually \ub204\ub974\uace0 tutorial-x86_64.exe \ubd80\ud130 \uccb4\uc778 \uc5f0\uacb0\ud574\uc8fc\uba74 \ub428\n</code></pre> </p>"},{"location":"15-CE-tutorial/#_2","title":"\ubaa8\ub4c8 \ubca0\uc774\uc2a4 \ud655\uc778\ubc95","text":"<pre><code>memory viewer \uc5f4\uae30\n\uc0c1\ub2e8 \uba54\ub274 view -&gt; \"Enumerate DLLs and Symbols\" \ud074\ub9ad\n</code></pre>"},{"location":"15-CE-tutorial/#_3","title":"\uba54\ubaa8\ub9ac \uc804\uc218 \uc790\ub3d9 \uc2a4\uce90\ub108","text":"<p>\uccb4\uc778\uc758 \uad6c\uc870\ub97c \uc774\ud574\ud588\uc73c\uba74 \uc55e\uc73c\ub85c \ud3b8\ud558\uac8c \ubf51\uc73c\uba74 \ub41c\ub2e4</p> <p>\uba54\ubaa8\ub9ac \uc804\uc218 \uc2a4\uce94 <pre><code>\uac12 \ud0d0\uc0c9\ud574\uc11c \uc8fc\uc18c \ucc3e\uae30\npointer scan for this address(\uc790\ub3d9 \uc2a4\uce90\ub108 \uc774\uc6a9)\nscan for address\uc73c\ub85c \ub178\ub4dc\ub2f9 offset \uac00\uc9c0, offset \ucd5c\ub300 value, level\uc744 \uc801\uc5b4\uc8fc\uace0 ptr \ud30c\uc77c \uc800\uc7a5\n\uce58\ud305 \uc911\uc778 \ud504\ub85c\uadf8\ub7a8 \uc885\ub8cc \ud6c4 \uc7ac\uc2e4\ud589, CE\ub3c4 \uc7ac\uc811\uc18d\n\ub2e4\uc2dc \uac12 \ud0d0\uc0c9\ud574\uc11c \uc8fc\uc18c \ucc3e\uae30\npointer scan for this address \ub204\ub974\uace0 \ud398\uc774\uc9c0 \ub4e4\uc5b4\uc640\uc9c0\uba74 file\uc5d0\uc11c \uc774\uc804 ptr \ud30c\uc77c \ubd88\ub7ec\uc624\uae30\n\uc0c8 \uc8fc\uc18c\ub85c rescan\ud558\uba74 \ud6c4\ubcf4\uac00 \uc904\uc5b4\ub4e4\uc74c\n\ubc18\ubcf5\n\ud558\ub098\ub9cc \ub0a8\uc73c\uba74 \ud074\ub9ad\ud558\uba74 \uc791\uc5c5\ubc14\uc5d0 \ucd94\uac00\ub428\n</code></pre></p> <p>\ud639\uc740 \ub300\ud615 \ud504\ub85c\uadf8\ub7a8 \uba54\ubaa8\ub9ac \uc804\uc218 \uc2a4\uce94 <pre><code>\uac12 \ud0d0\uc0c9\ud574\uc11c \uc8fc\uc18c \ucc3e\uae30\npointer scan for this address(\uc790\ub3d9 \uc2a4\uce90\ub108 \uc774\uc6a9)\ngenerate pointermap\uc73c\ub85c \uccab\ubc88\uc9f8 ptr \ud30c\uc77c \uc800\uc7a5\n\uce58\ud305 \uc911\uc778 \ud504\ub85c\uadf8\ub7a8 \uc885\ub8cc \ud6c4 \uc7ac\uc2e4\ud589, CE\ub3c4 \uc7ac\uc811\uc18d\n\ub2e4\uc2dc \uac12 \ud0d0\uc0c9\ud574\uc11c \uc8fc\uc18c \ucc3e\uae30\npointer scan for this address \ub204\ub974\uace0 generate pointermap\uc73c\ub85c \ub450\ubc88\uc9f8 ptr \ud30c\uc77c \uc800\uc7a5\n\uc774\uc81c scan for address\ub85c \uc804\ud658\ud558\uace0 use saved pointermap \uccb4\ud06c\ud574 \uccab\ubc88\uc9f8 ptr \ud30c\uc77c \uc120\ud0dd\nCompare results with other saved pointermap \uccb4\ud06c\ud574 \ub450\ubc88\uc9f8 ptr \ud30c\uc77c \uc120\ud0dd\n\uc5ec\ub7ec\ubc88 \ud574\uc11c \ud558\ub098\ub9cc \ub0a8\uc73c\uba74 \ud074\ub9ad\ud558\uba74 \uc791\uc5c5\ubc14\uc5d0 \ucd94\uac00\ub428\n</code></pre></p>"},{"location":"15-CE-tutorial/#_4","title":"\uadf8 \ubc16\uc758 \uae30\uc220\ub4e4","text":"<p>Structures</p> <p>\"\uc774 \ubca0\uc774\uc2a4 \uc8fc\uc18c\ub97c \uc2dc\uc791\uc73c\ub85c 0x0, 0x4, 0x8\u2026 \uc624\ud504\uc14b\ub9c8\ub2e4 \ud544\ub4dc\ub97c \ud574\uc11d\ud574 \uad6c\uc870\uccb4\ucc98\ub7fc \ubcf4\uc790\" \u2460 Add address: \ubca0\uc774\uc2a4(\uc608: [[playerBasePtr]+0x30])\ub97c \uc5f4 \uae30\uc900\uc73c\ub85c \ucd94\uac00 \u2461 Define new structure: \ud06c\uae30 \uc785\ub825(\ubcf4\ud1b5 0x400~0x1000) \u2192 \ucd08\uae30 \ud15c\ud50c\ub9bf \uc0dd\uc131 \u2462 Auto-fill/Guess field type: \ud328\ud134\uc744 \ubcf4\uace0 4 Byte \uc815\uc218\u00b7Float\u00b7Pointer \ub4f1\uc744 \uc790\ub3d9 \ucd94\uc815 \u2463 Column compare: \ub3d9\uc77c \uad6c\uc870\uccb4\ub97c \ub450 \uc778\uc2a4\ud134\uc2a4(\ud50c\ub808\uc774\uc5b4 1 vs 2)\ub85c \ub098\ub780\ud788 \ubc30\uce58, \ucc28\uc774\uac00 \ub098\ub294 \uc624\ud504\uc14b \uac15\uc870 \u2464 \ud544\ub4dc\uba85\u00b7\ud0c0\uc785 \ub354\ube14\ud074\ub9ad \u2192 Rename &amp; Re-type \uc9c0\uc6d0</p> <p>AoB \uc2a4\uce94</p> <p>\uc77c\ub828\uc758 \uba85\ub839\uc5b4 \ubc14\uc774\ud2b8 \uc2dc\ud000\uc2a4(\uc608: 48 8B 05 ?? ?? ?? ?? 89 83)\ub97c \uc57c\uc0dd\uc758 \uace0\uc720\uc9c0\ubb38\ucc98\ub7fc \uc800\uc7a5\ud574 \ub450\uc5c8\ub2e4\uac00, \ub2e4\uc74c \uc2e4\ud589\uc5d0\uc11c \ub2e4\uc2dc \uac80\uc0c9\ud558\uc5ec \uac19\uc740 \ucf54\ub4dc \uc704\uce58\ub97c \ucc3e\ub294 \ubc29\uc2dd. \uc5c5\ub370\uc774\ud2b8\ub85c \ubaa8\ub4c8 \ud06c\uae30\uc640 \ubca0\uc774\uc2a4\uac00 \ubc14\ub00c\uc5b4\ub3c4 \ud328\ud134\uc73c\ub85c \ucc3e\ub294 \uac70\uae30\uc5d0 \uc131\uacf5\ub960\uc774 \ub192\uc74c.</p> <p>Dissect code</p> <p>\"\uc774 \ubaa8\ub4c8(\uc608: game.exe)\uc758 \ucf54\ub4dc \uad6c\uc131\uc744 \ud1b5\uc9f8\ub85c \ud574\ubd80\ud574\uc11c \ud568\uc218\u00b7\ubd84\uae30\u00b7\ud638\ucd9c \uad00\uacc4\ub97c \ud0d0\uc0c9\ud558\uc790.\" \u2460 \ubaa8\ub4c8/\uc601\uc5ed \uc120\ud0dd \u2192 .text(\uc2e4\ud589 \ucf54\ub4dc) \uc139\uc158 \uc804\uccb4\ub97c \ube60\ub974\uac8c \uc2a4\uce94 \u2461 Function list \uc0dd\uc131: CE\uac00 ret\u00b7call \ud328\ud134\uc744 \uae30\ubc18\uc73c\ub85c \ud568\uc218 \uacbd\uacc4 \uc790\ub3d9 \ucd94\uc815 \u2462 X-ref(\uad50\ucc28 \ucc38\uc870): \ud574\ub2f9 \uc8fc\uc18c\ub97c \ud638\ucd9c\u00b7\uc810\ud504\ud558\ub294 \ubaa8\ub4e0 \uc9c0\uc810 \ub098\uc5f4 \u2463 \ub77c\ubca8\u00b7\uc8fc\uc11d \ub2ec\uae30, \uae30\uacc4\uc5b4 \u2194 Mnemonics(\uc5b4\uc148\ube14\ub9ac) \ubcf4\uae30 \uc804\ud658 \u2464 Graph view(\uc120\ud0dd): \uae30\ubcf8 \ube14\ub85d \ud750\ub984\ub3c4\ub97c \uc2dc\uac01\ud654</p>"},{"location":"15-CE-tutorial/#ce-pointer-scan","title":"CE pointer scan","text":"<p>\uc6b0\ub9ac\uc758 \ubaa9\ud45c\ub294 \ub17c\ub9ac\uc801\uc778 \uccb4\uc778 \uad6c\uc870\ub97c \ucc3e\ub294 \uac83. \uc624\ubc84\uc6cc\uce58\uc5d0 CE\ub97c \ubd99\uc774\uace0 \uccb4\ub825\uac12 225\ubd80\ud130 \ud53c \ub2f3\uba74 decrased value\ub85c \uccb4\ub825 component \ud6c4\ubcf4\uad70 \ub2e4\uc12f\uac1c \uc8fc\uc18c\ub97c \ucc3e\uc74c. 2448997EDE8, 2449682E418 \ub4f1\ub4f1 \ubaa8\ub4c8 \uc774\ubbf8\uc9c0 \ubca0\uc774\uc2a4\ubcf4\ub2e4 \uc55e\uc778 \ud799 \ud560\ub2f9 \uc601\uc5ed\uc784\uc744 \uc54c \uc218 \uc788\uc74c</p> <p>\uadf8\ub807\uc9c0\ub9cc pointer scan for this address\ub85c \uccb4\uc778\uc744 \ucc3e\uc73c\ub824 \ud574\ub3c4 \uc544\ubb34\uac83\ub3c4 \uc548\ub738 \uc65c? \ucf54\ub4dc\uc5d0 \ud3ec\uc778\ud130 \ubd80\ubd84\uc774 \ub09c\ub3c5\ud654 \ubc0f xor\ub85c \uac00\ub7ec\uc838\uc788\uae30 \ub54c\ubb38. \uc0c1\uc6a9 \uac8c\uc784\uc740 \ud3ec\uc778\ud130\uac00 \ud3c9\ubb38 \uac12\uc73c\ub85c \uc800\uc7a5\ub418\uc5b4 \uc788\uc9c0 \uc54a\uace0 \ub9e4\ubc88 \ubcf5\ud638\ud654 \uacc4\uc0b0\ud574\uc11c \uc5bb\ub294\ub2e4.</p>"},{"location":"15-CE-tutorial/#ce-debugger","title":"CE debugger","text":"<p>what access this address \ub610\ud55c \ubb34\uacb0\uc131 \uac80\uc0ac \uc548\ud2f0\uce58\ud2b8\uc5d0 \uc758\ud574 \ub9c9\ud78c\ub2e4.</p>"},{"location":"16-pyvmi-rw/","title":"16 pyvmi rw","text":""},{"location":"16-pyvmi-rw/#vmi-rw","title":"vmi rw \uae30\ubcf8\ucf54\ub4dc\ub97c \uc791\uc131\ud574\ub193\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-19</p>"},{"location":"16-pyvmi-rw/#_1","title":"\uace0\uc815\uc8fc\uc18c \ud3f4\ub9c1","text":"<p>\uace0\uc815\uc8fc\uc18c\ub294 \ub2e8\uc21c\ud558\uac8c \uace0\uc815 \uac00\uc0c1\uc8fc\uc18c\uc640 \uadf8\uac8c \uc5b4\ub290 \ud504\ub85c\uc138\uc2a4\uc758 \uac00\uc0c1\uc8fc\uc18c\uc778\uc9c0\ub9cc \uc54c\ub824\uc8fc\uba74 \ub41c\ub2e4.</p> <p>\uc8fc\uc18c \uc54c\uc544\ub0b4\uae30 <pre><code>notepad.exe \uc2e4\ud589 \ud6c4 \uc544\ubb34 \ud14d\uc2a4\ud2b8 \uc801\uae30\n\ud14d\uc2a4\ud2b8\ub97c \ubcc0\uacbd\ud574\uac00\uba74\uc11c CE\uc5d0\uc11c \uc8fc\uc18c \ud655\uc815: 0x21777087720\n</code></pre></p> <p>PID \uc54c\uc544\ub0b4\uae30 <pre><code>$ sudo vmi-process-list win10-seabios | grep -i notepad\n[ 11784] notepad.exe (struct addr:ffffd184ad9f1080)\n</code></pre></p> <p>\ucf54\ub4dc \uc791\uc131 <pre><code>$ nano ~/watch_va_poll_wait.py\n</code></pre> * \ub300\uae30\ud558\ub2e4\uac00 \ud574\ub2f9 \ud398\uc774\uc9c0\uac00 \uba54\ubaa8\ub9ac\uc5d0 \uc62c\ub77c\uc628 \uc21c\uac04\ubd80\ud130 \uac10\uc2dc\ud558\uc5ec \ubcc0\uacbd\uc744 \ud3f4\ub9c1\ud558\ub294 \uc2a4\ud06c\ub9bd\ud2b8</p> <p>\uc2e4\ud589 \ucee4\ub9e8\ub4dc <pre><code>$ sudo /home/kkongnyang2/vmi-venv/bin/python3 ~/watch_va_poll_wait.py \\\n  win10-seabios 11784 0x21777087720 64\n\n[.] Waiting for page to become resident... (pid=11784, va=0x21777087720) [18:52:09.471] INIT len=64 decode(utf-16le): '1334#123#1\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x08\u736f\u0217\\x00' 00000000 31 00 33 00 33 00 34 00 23 00 31 00 32 00 33 00 1.3.3.4.#.1.2.3. 00000010 23 00 31 00 00 00 00 00 00 00 00 00 00 00 00 00 #.1............. 00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030 00 00 00 00 00 00 00 00 08 00 6f 73 17 02 00 00 ..........os.... [18:52:20.162] CHANGE len=64 decode(utf-16le): '1334#123#2\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x08\u736f\u0217\\x00' 00000000 31 00 33 00 33 00 34 00 23 00 31 00 32 00 33 00 1.3.3.4.#.1.2.3. 00000010 23 00 32 00 00 00 00 00 00 00 00 00 00 00 00 00 #.2............. 00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030 00 00 00 00 00 00 00 00 08 00 6f 73 17 02 00 00 ..........os....\n</code></pre></p>"},{"location":"16-pyvmi-rw/#3","title":"\uc8fc\uc18c \ubcc0\ud658 3\ub2e8\uacc4","text":"<p>\uac8c\uc2a4\ud2b8 \uac00\uc0c1\uc8fc\uc18c (GVA, VA)    \u2514\u2500(\uac8c\uc2a4\ud2b8 \ud504\ub85c\uc138\uc2a4\uc758 \ud398\uc774\uc9c0\ud14c\uc774\ube14: CR3/DTB)\u2192 \uac8c\uc2a4\ud2b8 \ubb3c\ub9ac\uc8fc\uc18c (GPA/PA)         \u2514\u2500(\ud558\uc774\ud37c\ubc14\uc774\uc800\uc758 2\ucc28 \ubcc0\ud658: EPT/NPT)\u2192 \ud638\uc2a4\ud2b8 \ubb3c\ub9ac\uc8fc\uc18c (HPA, \uc2e4\uc81c RAM)</p> <p>EPROCESS: \ucee4\ub110\uc758 \ud504\ub85c\uc138\uc2a4 \uac1d\uccb4 \uad6c\uc870\uccb4 \ub0b4\uc6a9\ubb3c\uc740 PID, ActiveProcessLinks(\ud504\ub85c\uc138\uc2a4 \ub354\ube14\ub9c1\ud06c\ub4dc \ub9ac\uc2a4\ud2b8), DTB, Peb(PEB \uac00\uc0c1\uc8fc\uc18c)</p> <p>PEB: \uc720\uc800 \ubaa8\ub4dc\uc5d0 \uc788\ub294 \ud504\ub85c\uc138\uc2a4 \ud658\uacbd \ube14\ub85d \ub0b4\uc6a9\ubb3c\uc740 ImageBaseAddress(\uba54\uc778 exe\uc758 \ubca0\uc774\uc2a4), Ldr(\ubaa8\ub4c8 \ub9ac\uc2a4\ud2b8\ub85c \uac00\ub294 \ud3ec\uc778\ud130)</p> <p>\ubaa8\ub4c8: \ud504\ub85c\uc138\uc2a4 \uc8fc\uc18c\uacf5\uac04\uc5d0 \ub85c\ub4dc\ub41c \uba54\uc778 EXE + \uc5ec\ub7ec DLL PEB-&gt;Ldr-&gt;InMemoryOrderModuleList\uc758 \uac01 \ub178\ub4dc\ub294 LDR_DATA_TABLE_ENTRY\uc784.</p> <p>\ub0b4\uac00 \ucc3e\ub294 overwatch2.exe\uc758 \ubca0\uc774\uc2a4\ub77c\ub294 \uac74 \uc77c\ubc18\uc801\uc73c\ub85c \uba54\uc778EXE\uc758 \ubca0\uc774\uc2a4.</p> <p>\ub530\ub77c\uc11c \ubca0\uc774\uc2a4 \uad6c\ud558\ub294 \uc808\ucc28 \ucee4\ub110 \ub9ac\uc2a4\ud2b8\uc5d0\uc11c EPROCESS\ub97c \ucc3e\uace0, PEB.Ldr.InMemoryOrderModuleList\ub97c \uc21c\ud68c\ud558\uc5ec \uac01 LDR_DATA_TABLE_ENTRY.DllBase\ub97c \uc218\uc9d1. \uc774\uac78\ub85c \uac01 \ubaa8\ub4c8\uc758 \ubca0\uc774\uc2a4\ub97c \uc54c \uc218 \uc788\uace0 PEB.ImageBaseAddress\uac00 \uba54\uc778 EXE \ubca0\uc774\uc2a4</p>"},{"location":"16-pyvmi-rw/#_2","title":"\uad6c\uc131\uc694\uc18c \uae30\ub2a5","text":"<p>libvmi \ucf54\uc5b4\ub294 C API\ub85c \ub3c4\uba54\uc778\uc5d0 attach \ud558\uace0, PA/VA \uc77d\uae30\uc4f0\uae30, PID/DTB \uae30\ubc18 \ubc88\uc5ed, \uc774\ubca4\ud2b8 \ub4f1\uc758 \uae30\ub2a5\uc774 \uc788\ub2e4. \ub530\ub77c\uc11c \uc6d0\uc2dc \uba54\ubaa8\ub9ac\ub97c \uc811\uadfc\ud558\uac70\ub098 VA\ub97c PA\ub85c \ubc88\uc5ed\ud558\uac70\ub098 \ud398\uc774\uc9c0 \ud2b8\ub7a9 \ub4f1\uc758 \uc800\uc218\uc900 \uc791\uc5c5\uc774 \uac00\ub2a5\ud558\ub2e4.</p> <p>libvmi \uc608\uc81c\ub294 \uadf8 \uc704\uc5d0 \ub9cc\ub4e0 \ub370\ubaa8\ub85c \ud504\ub85c\uc138\uc2a4 \ub098\uc5f4, \uba54\ubaa8\ub9ac \ub364\ud504, GUID \ud655\uc778 \ub4f1\uc758 \ub300\ud45c \uc791\uc5c5\uc774 \uac00\ub2a5\ud558\ub2e4.</p> <p>python \ubc14\uc778\ub529\uc740 read_va, write_va\ub97c \ud638\ucd9c\ud560 \uc218 \uc788\ub2e4.</p> <p>\ud504\ub85c\ud30c\uc77c\uc740 \uad6c\uc870\uccb4\ub098 \uc2ec\ubcfc \uc624\ud504\uc14b \uc815\ubcf4\uac00 \ub4e4\uc5b4\uc788\uc5b4\uc11c(EPROCESS/PEB/LDR/UNICODE_STRING/\ubaa8\ub4c8 \ub9ac\uc2a4\ud2b8 \ub4f1) \uc774\uac8c \uc788\uc73c\uba74 vmi-process-list, PID-&gt;EPROCESS, PEB-&gt;Ldr-&gt;\ubaa8\ub4c8\ubca0\uc774\uc2a4, \ubb38\uc790\uc5f4 \uc77d\uae30 \ub4f1 \uc758\ubbf8\ub97c \ud574\uc11d\ud558\ub294 \ucf54\ub4dc\ub97c \uc791\ub3d9\ud560 \uc218 \uc788\ub2e4.</p>"},{"location":"16-pyvmi-rw/#rw","title":"\uccb4\uc778\uc8fc\uc18c r/w","text":"<p>~/game-cheat/code/chain/  \u251c\u2500 ist_helpers.py         # IST(JSON)\uc5d0\uc11c \ud544\ub4dc \uc624\ud504\uc14b \uc5bb\uae30 + UNICODE_STRING \uc77d\uae30  \u251c\u2500 vmi_helpers.py         # LibVMI \uacf5\ud1b5 \ud5ec\ud37c(\ud3ec\uc778\ud130/\uc815\uc218 \uc77d\uae30\u00b7\uc4f0\uae30, wait-present \ub4f1)  \u251c\u2500 find_module_base.py    # \ud504\ub85c\uc138\uc2a4\uc5d0\uc11c \ubaa8\ub4c8 \ubca0\uc774\uc2a4(=ImageBase/DllBase) \ucc3e\uae30  \u251c\u2500 walk_chain.py          # \ubaa8\ub4c8 \ubca0\uc774\uc2a4 + \uccb4\uc778(+\uc624\ud504\uc14b/*\uc5ed\ucc38\uc870) \ub530\ub77c \ucd5c\uc885 \uc8fc\uc18c \uacc4\uc0b0  \u2514\u2500 rw_value.py            # \ucd5c\uc885 \uc8fc\uc18c\uc5d0\uc11c \uac12 \uc77d\uae30/\uc4f0\uae30 (u32/u64/utf16)</p> <p>\ucf54\ub4dc \uc791\uc131 <pre><code>$ nano ~/game-cheat/code/chain/ist_helpers.py\n$ nano ~/game-cheat/code/chain/vmi_helpers.py\n$ nano ~/game-cheat/code/chain/find_module_base.py\n$ nano ~/game-cheat/code/chain/walk_chain.py\n$ nano ~/game-cheat/code/chain/rw_value.py\n</code></pre></p> <p>\uc5d0\ub7ec \ud574\uacb0 <pre><code>ist_helpers.py \uc5d0\uc11c [-] 'types' \uc624\ub958\uac00 \ub5a0\uc11c\n$ sudo python3 - &lt;&lt;'PY'\nimport json, gzip, lzma\np=\"/root/symbols/ntkrnlmp.json\"\nwith open(p,'rb') as f:\n    sig=f.read(6)\nop=open\nif sig.startswith(b'\\xFD7zXZ\\x00'): op=lzma.open\nelif sig.startswith(b'\\x1F\\x8B'): op=gzip.open\nwith op(p,'rt',encoding='utf-8') as fp:\n    d=json.load(fp)\nprint(\"top-level keys:\", list(d.keys())[:6])\nprint(\"has types:\", 'types' in d, \"has symbols:\", 'symbols' in d)\nPY\ntop-level keys: ['base_types', 'enums', 'metadata', 'symbols', 'user_types']\n\uc0c1\ud0dc\ub97c \uc810\uac80\ud588\ub354\ub2c8 \uc694\uc998 volatility3 isf json\uc740 types \ub300\uc2e0 user_types\ub97c \uc4f0\ub294 \uac78 \ud655\uc778. \uadf8\ub798\uc11c \ub110\ub110\ud558\uac8c \uace0\uccd0\uc90c.\n\n\uadf8\ubc16\uc5d0 \ub2e4\ub978 py\uc5d0\uc11c\ub3c4 \uc778\uc790 \uac1c\uc218\ub098 python-libvmi (v3.7.1)\uc5d4 \uc5b4\ub5a4 \ubc30\ud3ec\ubcf8\uc5d0\uc11c\ub294 Libvmi.get_process_by_pid(...) \uac19\uc740 \ud3b8\uc758 \ub798\ud37c\uac00 \ud3ec\ud568\ub418\uc9c0 \uc54a\ub294 \ubb38\uc81c \ub4f1\uc744 \ud558\ub4dc\ucf54\ub529 \ud574\uc90c.\n</code></pre></p> <p>\uc2e4\ud589 \ucee4\ub9e8\ub4dc <pre><code>$ sudo vmi-process-list win10-seabios | grep -i overwatch\n[12164] Overwatch.exe (struct addr:ffffb50fd508a280)\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 ~/game-cheat/code/chain/find_module_base.py \\\n  win10-seabios 12164 Overwatch.exe /root/symbols/ntkrnlmp.json\nVMI_WARNING: Invalid offset name in windows_get_offset (win_peb).\n0x00007ff6134e0000\n</code></pre> * \ucc38\uace0\ub85c vmi-process-list\ub294 15\ubc14\uc774\ud2b8\uae4c\uc9c0\ub9cc \ub3fc\uc11c \ubaa8\ub4c8\uba85 \ub4a4 \uc774\ub984\uc740 \uc9e4\ub9bc. \uc54c\uc544\uc11c \uc801\uc5b4\uc8fc\uae30.</p> <p>\uc2e4\ud589 \ucee4\ub9e8\ub4dc2 <pre><code>$ sudo /home/kkongnyang2/vmi-venv/bin/python3 ~/game-cheat/code/chain/walk_chain.py   win10-seabios 10220 Tutorial-x86_64.exe /root/symbols/ntkrnlmp.json \"+0x34ECA0 * +0x10 * +0x18 * +0x0 * +0x18\" 64\n[+] base=Tutorial-x86_64.exe@0x0000000100000000\n[+] final address = 0x0000000001587108\n00000000  e6 0b 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\n00000010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\n00000020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\n00000030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\n</code></pre> * 64\ub294 \uadf8 \uc8fc\uc18c\uc5d0\uc11c \uba87 \ubc14\uc774\ud2b8\ub97c \ub364\ud504\ud574\uc11c \ubcf4\uc5ec\uc904\uc9c0\ub97c \ub73b\ud558\ub294 len\uc784.</p> <p>\uc2e4\ud589 \ucee4\ub9e8\ub4dc3 <pre><code># \uc77d\uae30 (u32)\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 ~/game-cheat/code/chain/rw_value.py \\\n  win10-seabios 10220 Tutorial-x86_64.exe /root/symbols/ntkrnlmp.json \"+0x34ECA0 * +0x10 * +0x18 * +0x0 * +0x18\" --read --type u32\n[+] final address: 0x0000000001587108\nu32 = 3046 (0x00000be6)\n\n# \uc4f0\uae30 (u32)\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 ~/game-cheat/code/chain/rw_value.py \\\n  win10-seabios 10220 Tutorial-x86_64.exe /root/symbols/ntkrnlmp.json \"+0x34ECA0 * +0x10 * +0x18 * +0x0 * +0x18\" --write --type u32 --value 1337\n[+] final address: 0x0000000001587108\n[OK] wrote u32 1337 at 0x0000000001587108\n</code></pre> * u32\ub294 4bytes\ub85c \uac12 \uc77d\uae30 * \ubb38\uc790\uc5f4(UTF-16LE)\ub85c \uc4f0\uae30\ub97c \ud558\uace0 \uc2f6\ub2e4\uba74 --write --type utf16 --text \"KKN!\" \ud574\uc8fc\uba74 \ub428</p>"},{"location":"16-pyvmi-rw/#_3","title":"\ubaa8\ub4c8\ub85c \uc18c\ud658","text":"<p>\uc774\uc81c \ubaa8\ub4e0 from\uc5d0 \ub808\ud3ec \uc774\ub984\uc744 \ud3ec\ud568\uc2dc\ucf1c\ub77c(ex chain.ist_helpers) \uac19\uc740 \uacbd\ub85c\uc5d0 \uc788\ub2e4\uace0 \ud574\ub3c4 \ub9c8\ucc2c\uac00\uc9c0\uc774\ub2e4 \uadf8\ub9ac\uace0 \ubaa8\ub4e0 \ub808\ud3ec \uc55e\uc5d0 init.py\ub77c\ub294 \ube48 \ud30c\uc77c\uc744 \ub123\uc5b4\uc8fc\uba74 \uc808\ub300\uacbd\ub85c\ub97c \uc11c\ub85c \uc798 \uc778\uc2dd\ud55c\ub2e4.</p> <p>\ucee4\ub9e8\ub4dc <pre><code>$ cd ~/game-cheat\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 -m dump.vmi_list_sections \\\n  win10 4888 Overwatch.exe root/symbols/ntkrnlmp.json\n</code></pre></p>"},{"location":"17-pyvmi-dump/","title":"17 pyvmi dump","text":""},{"location":"17-pyvmi-dump/#_1","title":"\uc624\ubc84\uc6cc\uce58 \uba54\ubaa8\ub9ac\ub97c \ub364\ud504\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-30</p>"},{"location":"17-pyvmi-dump/#_2","title":"\uc139\uc158\ubcc4 \ub364\ud504\ud30c\uc77c \ub9cc\ub4e4\uae30","text":"<p>\uc624\ubc84\uc6cc\uce58 \ud504\ub85c\uc138\uc2a4 \uc774\ubbf8\uc9c0\ub97c \ub364\ud504\uc2dc\ud0a4\uace0 \ub514\uc2a4\uc5b4\uc148\ube14\ub9ac\ub85c \ud480\uc5b4\ubcf4\uc790. \uad6c\uc870 \ubc0f \ub09c\ub3c5\ud654\ub97c \uc0b4\ud3b4\ubcf4\uace0 \uc790\ub3d9 AoB\ub85c \ub8e8\ud2f4 \uc704\uce58 \ucc3e\uae30 + \ubcf5\ud638\ud654\ub85c \uc2e4\uc8fc\uc18c \uc0b0\ucd9c gamemanager - entity_rawlist - parentpool - componentparent - componentbase</p> <pre><code>$ sudo vmi-process-list win10-seabios | grep -i overwatch\n[11280] Overwatch.exe (struct addr:ffffd304d63ed080)\n\n$ cd ~/game-cheat/code\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 -m dump.vmi_list_sections \\\n  win10 11280 Overwatch.exe /root/symbols/ntkrnlmp.json\nVMI_WARNING: Invalid offset name in windows_get_offset (win_peb).\n[module] Overwatch.exe  base=0x00007ff73cdd0000\n\nName      RVA       VA(start)           VSize      RawSize   RawPtr  Perm  Chars\n--------- --------- -------------------- ---------- --------- ------- ----- ----------\n.text      0x00001000  0x00007ff73cdd1000  0x02b994fc  0x02b99600  0x000400  R-X   0x60000020\n.rdata     0x02b9b000  0x00007ff73f96b000  0x00916112  0x00916200  0x2b99a00  R--   0x40000040\n.data      0x034b2000  0x00007ff740282000  0x00c12a54  0x002ef800  0x34afc00  RW-   0xc0000040\n.pdata     0x040c5000  0x00007ff740e95000  0x0021e058  0x0021e200  0x379f400  R--   0x40000040\n_RDATA     0x042e4000  0x00007ff7410b4000  0x00030be0  0x00030c00  0x39bd600  R--   0x40000040\n.rodata    0x04315000  0x00007ff7410e5000  0x00001260  0x00001400  0x39ee200  R--   0x40000040\n.rsrc      0x04317000  0x00007ff7410e7000  0x00011350  0x00011400  0x39ef600  R--   0x40000040\n.reloc     0x04329000  0x00007ff7410f9000  0x0009f35c  0x0009f400  0x3a00a00  R--   0x42000040\n\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 -m dump.vmi_dump_section \\\n  win10 11280 Overwatch.exe /root/symbols/ntkrnlmp.json .text\nVMI_WARNING: Invalid offset name in windows_get_offset (win_peb).\n[info] module=Overwatch.exe base=0x00007ff73cdd0000\n[dumped] Overwatch.exe_.text_0x7ff73cdd1000_0x2000000.bin  ok_pages=2965 missing=5227 size=33554432/33554432\n\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 -m dump.vmi_dump_section \\\n  win10 11280 Overwatch.exe /root/symbols/ntkrnlmp.json .rdata\nVMI_WARNING: Invalid offset name in windows_get_offset (win_peb).\n[info] module=Overwatch.exe base=0x00007ff73cdd0000\n[dumped] Overwatch.exe_.rdata_0x7ff73f96b000_0x916112.bin  ok_pages=1027 missing=1300 size=9527570/9527570\n\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 -m dump.vmi_dump_section \\\n  win10 11280 Overwatch.exe /root/symbols/ntkrnlmp.json .data\nVMI_WARNING: Invalid offset name in windows_get_offset (win_peb).\n[info] module=Overwatch.exe base=0x00007ff73cdd0000\n[dumped] Overwatch.exe_.data_0x7ff740282000_0x2ef800.bin  ok_pages=452 missing=299 size=3078144/3078144\n\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 -m chain.walk_chain \\\n  win10 11280 Overwatch.exe /root/symbols/ntkrnlmp.json \"+0x03603ED0\" 64\n[+] base=Overwatch.exe@0x00007ff73cdd0000\n[+] final address = 0x00007ff7403d3ed0\n00000000  62 8c d8 ad aa 4c 47 f0 e2 82 dc ad aa 4c 47 f0   b....LG......LG.\n00000010  8a 80 ae ea 41 cf 47 f0 22 17 15 2b 49 4f 47 f0   ....A.G.\"..+IOG.\n00000020  62 b7 a9 ea 41 cf 47 f0 22 a7 a9 ea 41 cf 47 f0   b...A.G.\"...A.G.\n00000030  32 b4 a9 ea 41 cf 47 f0 a2 82 af ea 41 cf 47 f0   2...A.G.....A.G.\n</code></pre>"},{"location":"17-pyvmi-dump/#_3","title":"\uc804\uccb4 \ub364\ud504\ud30c\uc77c \uc0dd\uc131","text":"<p>\ubaa8\ub4c8 \uc774\ubbf8\uc9c0 \ubfd0 \uc544\ub2c8\ub77c heap \uc601\uc5ed\uae4c\uc9c0 \ud3ec\ud568</p> <pre><code>$ cd ~/game-cheat/code\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 -m dump.vmi_dump_process_quick \\\n  --domain win10 \\\n  --pid 4888 \\\n  --module Overwatch.exe --ist /root/symbols/ntkrnlmp.json \\\n  --out-dir /home/kkongnyang2/ow_full_dump \\\n  --va-min 0x10000 --va-max 0x00007FFFFFFFFFFF \\\n  --slot-offs 0x3603ed0 0x3603f30 --steps 0 8 24 \\\n  --chunk 0x100000 --page 0x1000 \\\n  --verbose\n\n[dump] wrote /home/kkongnyang2/ow_full_dump/va_00007ffaf08a0000_1000.bin  (0x1000 bytes)\n[dump] wrote /home/kkongnyang2/ow_full_dump/va_00007ffaf08b0000_167000.bin  (0x167000 bytes)\n[dump] wrote /home/kkongnyang2/ow_full_dump/va_00007ffaf0a19000_6000.bin  (0x6000 bytes)\n[dump] wrote /home/kkongnyang2/ow_full_dump/va_00007ffaf0a21000_87000.bin  (0x87000 bytes)\n[i] VM resumed\n[+] Wrote manifest -&gt; /home/kkongnyang2/ow_full_dump/manifest.json\n[+] Done.\n</code></pre> <p>[ Module Image ]</p> <p>.text   0x00007FF627195000 \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510            \u2502  \ud568\uc218 \ubcf8\ubb38/\ubd84\uae30/\uc810\ud504\ud14c\uc774\ube14 \uc77c\ubd80                                \u2502   .rdata  0x00007FF629CFB000 \u2500\u2500\u252c\u2500\u25ba vtable(\ud568\uc218\ud3ec\uc778\ud130 \ud14c\uc774\ube14) \u2500\u2500\u25ba .text     \u2502            \u2502                   \u2514\u2500 (XOR key: 0x00007FF627195000)             \u2502   .data   0x00007FF62A612000 \u2500\u2500\u252c\u2500\u25ba \uc804\uc5ed/\uc2f1\uae00\ud1a4 \ud3ec\uc778\ud130(\uc77c\ubd80 XOR)             \u2502            \u2502                   \u2514\u2500\u25ba [component manager] \u2192 (heap \ubc30\uc5f4)  \u2190 \ucc3e\ub294 \uc911   heap    0x000002EF00006000 \u2500\u2500\u252c\u2500\u25ba \uac1d\uccb4/\ucee8\ud14c\uc774\ub108/\ud14c\uc774\ube14(\uc774\ubc88\uc5d0 A/B/C \ud655\uc7a5) \u2502            \u2502                    \u2514\u2500\u25ba [component* \ubc30\uc5f4] (\uc5f0\uc18d \ud3ec\uc778\ud130)         \u2502            \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518</p> <p>Deobf: decoded = raw ^ 0x00007FF627195000  (\ucf54\ub4dc/\ud14c\uc774\ube14\uc6a9 \ud655\uc778\uc644\ub8cc)</p> <p>vftable = \uac00\uc0c1 \ud568\uc218 \uc8fc\uc18c \ud14c\uc774\ube14. \uc0c1\uc218 \ub370\uc774\ud130\ub97c \uc801\uc5b4\ub193\ub294 rdata \uc139\uc158\uc5d0 \uc874\uc7ac\ud55c\ub2e4. \uac1d\uccb4 \uba54\ubaa8\ub9ac(\uad6c\uc870\uccb4)\uc758 \ubcf4\ud1b5 \uccab \ud544\ub4dc\uc5d0 vftable \ud3ec\uc778\ud130\ub97c \uc801\uc5b4\ub193\ub294\ub2e4. \uc5ec\uae30\uc11c \uac00\uc0c1 \ud568\uc218 \uc8fc\uc18c\ub97c \ucc3e\uc544\uc11c \ub3cc\uc544\uc628\ub2e4. \uac00\uc0c1 \ud568\uc218\ub780? base* p\uac00 \uac00\ub974\ud0a4\ub294 \uc2e4\uc81c \ud0c0\uc785\uc774 \ubb50\ub0d0\uc5d0 \ub530\ub77c \ub2e4\ub978 \ub3d9\uc791\uc744 \ub7f0\ud0c0\uc784\uc5d0 \uace0\ub974\ub294 \uba54\ucee4\ub2c8\uc998. \uc27d\uac8c \ub9d0\ud574 \ub9c8\uc6b0\uc2a4 \uc88c\ud074\uc744 \ub20c\ub800\ub0d0, \uc6b0\ud074\uc744 \ub20c\ub800\ub0d0\uc5d0 \ub530\ub77c \ub2e4\ub978 \ubd84\uae30\ub85c \uac00\uac8c \ub418\uc796\uc544. \uc774 \ucf00\uc774\uc2a4\ub4e4\uc744 \ubbf8\ub9ac \uac00\uc0c1 \ud568\uc218\ub85c \ub9cc\ub4e4\uc5b4\uc11c \uc8fc\uc18c \ud14c\uc774\ube14\uc5d0 \uc801\uc5b4\ub193\uc73c\uba74 \uac1d\uccb4 \uba54\ubaa8\ub9ac\uc5d0\uc11c vftable\uc744 \ub4a4\uc838\uc11c \uc0ac\uc6a9\ud558\ub294 \uac83. \uadf8\ub0e5 \uad6c\uc870\uccb4\uc5d0 \ubd84\uae30 \ud3ec\uc778\ud130\ub4e4\uc744 \uc5ec\ub7ec \uac1c \ubc15\uc544\ub450\uba74 \ub418\ub294\uac70 \uc544\ub0d0? \uc6a9\ub7c9\uc774 \ucee4\uc9c0\uc796\uc544.</p>"},{"location":"17-pyvmi-dump/#_4","title":"\ubaa8\ub4c8 \uc885\ub958","text":"<p>CE - memory viewer - \uc0c1\ub2e8 \uba54\ub274 view - Enumerate DLLs and Symbols</p> <p>\uac8c\uc784 \uc790\uccb4 - Overwatch.exe: \uac8c\uc784 \uba54\uc778 \uc2e4\ud589 \ud30c\uc77c(\uac8c\uc784 \ub8e8\ud504 \uc2dc\uc791, \ucd08\uae30\ud654\uc640 \ubaa8\ub4c8 \ub85c\ub529) - Overwatch_loader.dll: \uac8c\uc784 \uc804\uc6a9 \ub85c\ub354/\ubd80\ud2b8\uc2a4\ud2b8\ub7a9 DLL(\uc790\uc6d0\uacfc \uc5d4\uc9c4 \ucd08\uae30\ud654 \ubd84\ub9ac) - bink2w64.dll: Bink 2 \ub3d9\uc601\uc0c1 \ucf54\ub371(\uc778\ud2b8\ub85c\uc640 \ucef7\uc2e0 \uc7ac\uc0dd) - nvngx_dlss.dll: DLSS(\uc5c5\uc2a4\ucf00\uc77c/\ud504\ub808\uc784 \uc0dd\uc131)\uc6a9 NGX \uac8c\uc784 \uce21 \uc2a4\ud141 - vivoxsdk.dll: Vivox \ubcf4\uc774\uc2a4 \ucc44\ud305 SDK(\uc778\uac8c\uc784 \uc74c\uc131 \ud1b5\uc2e0)</p> <p>nvidia \ub4dc\ub77c\uc774\ubc84 - _nvngx.dll: nvidia ngx \ub7f0\ud0c0\uc784(\ub4dc\ub77c\uc774\ubc84 \uce21 DLSS/Reflex \uc5f0\ub3d9) - nvapi64.dll: nvidia \uc804\uc6a9 gpu/\ub514\uc2a4\ud50c\ub808\uc774 \uc81c\uc5b4 api - nvcuda64.dll: CUDA \ub4dc\ub77c\uc774\ubc84 api - nvldumdx.dll: D3D11 UMD \ub85c\ub354(\uc0ac\uc6a9\uc790 \ubaa8\ub4dc \ub4dc\ub77c\uc774\ube0c \uc9c4\uc785\uc810) - nvwgf2umx.dll: D3D11 \uc0ac\uc6a9\uc790 \ubaa8\ub4dc \ub4dc\ub77c\uc774\ubc84 \ubcf8\uccb4 - nvdxgdmal64.dll: DGX/DMA \uacbd\ub85c \uad00\ub828 nvidia \uad6c\uc131\uc694\uc18c - nvgpucomp64.dll: nvidia \uc170\uc774\ub354/\ud30c\uc774\ud504\ub77c\uc778 \ucef4\ud30c\uc77c \uad6c\uc131\uc694\uc18c - nvmessagebus.dll: nvidia \ub0b4\ubd80 \uba54\uc2dc\uc9c0</p> <p>directX/\uadf8\ub798\ud53d - d3d11.dll: Direct3D 11 \ub80c\ub354\ub9c1 API(OW2 \uae30\ubcf8 \ub80c\ub354\ub7ec) - dxgi.dll: \uc2a4\uc651\uccb4\uc778/\uc5b4\ub311\ud130/\ud45c\uba74 \uad00\ub9ac - dxcore.dll: DXCore(\uc5b4\ub311\ud130 \uc5f4\uac70 \ubc0f \uc120\ud0dd) - d3d12.dll: D3D12 \ub7f0\ud0c0\uc784 - D3DSCache.dll: D3D \uc170\uc774\ub354 \uce90\uc2dc \ub9e4\ub2c8\uc800 - directxdatabasehelper.dll: \ub4dc\ub77c\uc774\ubc84/\uc170\uc774\ub354 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ud5ec\ud37c - dcomp.dll: DirectComposition(\ud569\uc131,UI \ud6a8\uacfc) - dwmapi.dll: DWM(\ucc3d \ud569\uc131) \uc778\ud130\ud398\uc774\uc2a4 - Microsoft.Internal.WarPal.dll: WARP(\uc18c\ud504\ud2b8\uc6e8\uc5b4 \ub798\uc2a4\ud130\ub77c\uc774\uc800) \uad00\ub828 \uad6c\uc131\uc694\uc18c</p> <p>\uc785\ub825 - Xinput1_4.dll: \uac8c\uc784\ud328\ub4dc(\uc5d1\uc2a4\ubc15\uc2a4 \ud328\ub4dc) \uc785\ub825 - HID.DLL: HID(\ub9c8\uc6b0\uc2a4/\ud0a4\ubcf4\ub4dc/\ud328\ub4dc) \uc800\uc218\uc900 \uc785\ub825 API - IMM32.DLL/MSCTF.dll: \ud0a4\ubcf4\ub4dc/IME(\ud14d\uc2a4\ud2b8 \uc11c\ube44\uc2a4 \ud504\ub808\uc784\uc6cc\ud06c) - inputhost.dll/textinputframwork.dll: \ud604\ub300 \uc785\ub825 \uc2a4\ud0dd(\ud130\uce58/\uac00\uc0c1\ud0a4\ubcf4\ub4dc)</p> <p>UI - oreMessaging.dll / CoreUIComponents.dll / Windows.UI.dll: \ud604\ub300 UI/\uba54\uc2dc\uc9c0 \ud38c\ud504 \uad6c\uc131\uc694\uc18c. - uxtheme.dll / USER32.dll / GDI32.dll / gdi32full.dll / shcore.dll: \uc708\ub3c4\uc6b0 UI/\uadf8\ub9bc(\uc2a4\ucf00\uc77c\ub9c1 \ud3ec\ud568)</p> <p>\ubcf4\uc548 - amsi.dll: AMSI(\uc548\ud2f0\uba40\uc6e8\uc5b4 \uc2a4\uce94 \uc778\ud130\ud398\uc774\uc2a4, \uc2a4\ud06c\ub9bd\ud2b8/\ucee8\ud150\uce20 \uc2a4\uce94 \ud6c5) - wldp.dll: Windows Lockdown Policy(AppX/\uc11c\uba85 \uc815\ucc45) - WINTRUST.dll/ CRYPT43.dll/ cryptnet.dll: \uc11c\uba85 \uac80\uc99d/\uc778\uc99d\uc11c/CRL - bcrypt.dll / bcryptPrimitives.dll: \ud574\uc2dc/\ub300\uce6d\ud0a4 \ub4f1 CNG \uc6d0\uc2dc \uc5f0\uc0b0. - ncrypt.dll / ncryptsslp.dll: \ud0a4 \uc2a4\ud1a0\ub9ac\uc9c0/SSL \uc81c\uacf5\uc790 \uc5f0\uacc4. - MpOav.dll: Microsoft Defender \uc2e4\uc2dc\uac04 \uac80\uc0ac(\ud30c\uc77c/\uba54\ubaa8\ub9ac \uc811\uadfc \uc2dc \ud6c4\ud0b9).</p> <p>\uc624\ub514\uc624, \ub124\ud2b8\uc6cc\ud0b9, \ubcf4\uc774\uc2a4, \uc7a5\uce58, \uc708\ub3c4\uc6b0 \ub7f0\ud0c0\uc784 \ubaa8\ub4c8\uc740 \uc0dd\ub7b5</p>"},{"location":"18-drakvuf-heap/","title":"18 drakvuf heap","text":""},{"location":"18-drakvuf-heap/#_1","title":"\uc2e4\uc2dc\uac04 \ud560\ub2f9 \ud6c4\ubcf4\uad70\uc744 \uad00\ucc30\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-09-16</p>"},{"location":"18-drakvuf-heap/#xen","title":"xen \ud398\uc774\uc9c0 \uc7a1\uae30","text":"<p>\uac8c\uc2a4\ud2b8 \ucf54\ub4dc  \u2500\u2500(HP \uac31\uc2e0)\u2500\u2500\u25ba [\uac00\uc0c1\uc8fc\uc18c GVA] \u2192 \ud398\uc774\uc9c0 \ud14c\uc774\ube14 \u2192 [\uac8c\uc2a4\ud2b8\ubb3c\ub9ac GPA]                                            \u2502                               \ud558\uc774\ud37c\ubc14\uc774\uc800\uc758 2\ub2e8 \ubcc0\ud658(EPT/NPT)                                            \u2193              EPT \uad8c\ud55c \ube44\ud2b8(R/W/X)\ub85c \ud398\uc774\uc9c0\ub97c \uc758\ub3c4\uc801\uc73c\ub85c \ub9c9\uc544\ub460                                            \u2193                  \uc811\uadfc \ubc1c\uc0dd \u2192 EPT violation \u2192 VM-exit(\ud638\uc2a4\ud2b8\ub85c)                                            \u2193    VM-exit \uc815\ubcf4: \uc811\uadfc\uc885\ub958(R/W/X), GLA(\uc120\ud0dd\uc801), GPA, RIP, CR3(DTB) \ub4f1                                            \u2193   \ubd84\uc11d\uae30(\uc608: LibVMI/Drakvuf)\uac00 RIP \uc8fc\ubcc0 \uba85\ub839 \ub514\ucf54\ub4dc \u2192 \uc4f0\uae30 \ud06c\uae30/\ub300\uc0c1 \ud30c\uc545                                            \u2193             (\uc635\uc158) \uc77c\uc2dc \ud5c8\uc6a9+\ub2e8\uc77c \uc2a4\ud15d \ud6c4 \uc7ac\ubcf4\ud638(re-arm)\ub85c \uacc4\uc18d \ucd94\uc801</p> <p>\uc2e4\uc2dc\uac04 vmi \ud658\uacbd\uc5d0\uc11c \ud560\ub2f9\ub418\ub294 \ud398\uc774\uc9c0\ub97c \ud6c5\ud0b9\ud574 VM-exit \ud2b8\ub7a9\uc73c\ub85c \uac10\uc2dc</p>"},{"location":"18-drakvuf-heap/#drakvuf","title":"drakvuf \uc124\uce58","text":"<p>drakvuf \uc124\uce58 <pre><code>ubuntu on xen\uc73c\ub85c \ub4e4\uc5b4\uac00\uc11c\n$ sudo apt install meson ninja-build clang llvm lld libglib2.0-dev libjson-c-dev\n$ git clone --recursive https://github.com/tklengyel/drakvuf\n$ cd drakvuf\n$ meson setup build --native-file llvm.ini\n$ ninja -C build\n$ sudo ninja -C build install\n$ sudo ldconfig\n</code></pre></p> <p>\uae30\ub2a5 \ud655\uc778 <pre><code>$ sudo xl list        # \uba87\ubc88\uc778\uc9c0 \ud655\uc778\n$ sudo drakvuf -r /root/symbols/ntkrnlmp.json -d 1 -a procmon\n</code></pre></p>"},{"location":"18-drakvuf-heap/#drakvuf_1","title":"drakvuf \ucee4\uc2a4\ud140 \ud50c\ub7ec\uadf8\uc778 \uc81c\uc791","text":"<p>\ub370\uc774\ud130\ub97c \uc11c\ubc84\uc5d0\uc11c \ubc1b\uc544\uc624\uba74 ntdll.dll\uc774 \ube44\uc5b4\uc788\ub294 \uc8fc\uc18c\uc5d0 \ud799 \ud560\ub2f9\uc744 \ud558\uace0 \uadf8 \uc8fc\uc18c\ub97c \ub9ac\ud134\ud574\uc900\ub2e4. \uadf8\ub7ec\uba74 overwatch.exe\ub294 \uadf8\uac78 \ud14c\uc774\ube14\uc5d0 \uc800\uc7a5\ud574\ub480\ub2e4\uac00 \ud544\uc694\ud560\ub54c\ub9c8\ub2e4 \ucc3e\uc544\uac00\uc11c read &amp; write\ub97c \ud574\uc900\ub2e4. </p> <p>\uadf8\ub7fc \uc774 \ud560\ub2f9\uc744 \uc5b4\ub5bb\uac8c \uc7a1\uc544\uc62c \uc218 \uc788\ub0d0? \uc708\ub3c4\uc6b0 \ub0b4\ubd80\uc5d0\uc11c\ub294 \ucee4\ub110\uc758 \ud560\ub2f9 \ud568\uc218\ub4e4\uc744 \ucad2\ub294\ub2e4. vmi \ud658\uacbd\uc5d0\uc11c\ub294 \ud2b9\uc815 \uad6c\uc5ed\ub4e4\uc5d0 vm-exit \uac78\uc5b4\ub193\uc544 \uac70\uae30\uc5d0 write\ud558\ub824\ud558\uba74 \ubb34\uc870\uac74 \uc608\uc678\ucc98\ub9ac\ub85c \ud655\uc778\ub41c\ub2e4. \uc774 \ubc29\uc2dd\uc774 drakvuf\uc5d0 \uad6c\ud604\ub418\uc5b4 \uc788\ub2e4.</p> <p>drakvuf\uc758 syscall + memaccess\ub97c \uc774\uc6a9\ud574 drakvuf \ucee4\uc2a4\ud140 \ud50c\ub7ec\uadf8\uc778\uc73c\ub85c \ud574\uc8fc\uc790. 1. syscalls \ud6c4\ud0b9: NtAllocateVirtualMemory, NtMapViewOfsection 2. \ub9ac\ud134 \uc131\uacf5 \uc2dc *BaseAddress, *RegionSize \uc77d\uc5b4\uc11c [base,size) \uad6c\uac04 \ud655\ubcf4 3. VA \ud544\ud130 : (base..base+size)\uac00 0x 0000 0200 0000 0000 ~ 0x 0000 02FF FFFF FFFF\uc640 \uad50\ucc28\ud558\uba74 \ub300\uc0c1 \ucc98\ub9ac 4. \ud398\uc774\uc9c0\ubcc4 W-\ud2b8\ub7a9 \ub4f1\ub85d: \ud574\ub2f9 \uad6c\uac04\uc744 4KB \ud398\uc774\uc9c0\ub85c \ucabc\uac1c memaccess \ub4f1\ub85d 5. memaccess \ucf5c\ubc31: (pid, tid, rip, gva, gfn)\ub85c\uae45 -&gt; \uc2f1\uae00\uc2a4\ud15d 1\ud68c \ud5c8\uc6a9 -&gt; \ub2e4\uc2dc W \uae08\uc9c0 6. free/unmap \uc2dc : \ucd94\uc801 \ud14c\uc774\ube14\uc5d0\uc11c \ud2b8\ub7a9 \ud574\uc81c</p>"},{"location":"18-drakvuf-heap/#pid_va_writewatch","title":"pid_va_writewatch","text":"<p>drakvuf/ \u2514\u2500 src/    \u2514\u2500 plugins/       \u251c\u2500 meson.build              \u2190 \uc5ec\uae30\uc5d0 \ud55c \uc904 \ucd94\uac00       \u2514\u2500 pid_va_writewatch/          \u251c\u2500 pid_va_writewatch.cpp \u2190 \uc0c8\ub85c \ucd94\uac00          \u2514\u2500 pid_va_writewatch.h   \u2190 \uc0c8\ub85c \ucd94\uac00</p> <p>\ucee4\uc2a4\ud140 \ud50c\ub7ec\uadf8\uc778 \uc81c\uc791 <pre><code>$ cd ~/drakvuf/src/plugins\n$ mkdir pid_va_writewatch\n$ nano pid_va_writewatch/pid_va_writewatch.h\n$ nano pid_va_writewatch/pid_va_writewatch.cpp\n$ nano meson.build\nplugin_sources = [\n  # (\uae30\uc874\ub4e4)\n  'pid_va_writewatch/pid_va_writewatch.cpp',\n  'pid_va_writewatch/pid_va_writewatch.h',\n]\n$ nano plugins.h\n\ud50c\ub7ec\uadf8\uc778 \ub9ac\uc2a4\ud2b8 drakvuf_plugin_t \uc758 \ub9c8\uc9c0\ub9c9 __DRAKVUF_PLUGIN_LIST_MAX \uc55e\uc904\uc5d0\n    PLUGIN_PID_VA_WRITEWATCH,\n\uc774\ub984 \ub9ac\uc2a4\ud2b8 static const char* drakvuf_plugin_names[] \uc5d0\n    [PLUGIN_PID_VA_WRITEWATCH] = \"pid_va_writewatch\",\nos \uc9c0\uc6d0 \ub9ac\uc2a4\ud2b8 drakvuf_plugin_os_support \uc5d0\n    [PLUGIN_PID_VA_WRITEWATCH] = { [VMI_OS_WINDOWS] = 1, [VMI_OS_LINUX] = 1 },\n$ nano plugins.cpp\n#include \"pid_va_writewatch/pid_va_writewatch.h\"\ndrakvuf_plugins::start \uc548\uc758 \ud070 switch\uc5d0 case \ucd94\uac00\ncase PLUGIN_PID_VA_WRITEWATCH:\n{\n    this-&gt;plugins[plugin_id] = std::make_unique&lt;pid_va_writewatch&gt;(this-&gt;drakvuf, this-&gt;output);\n    break;\n}\n</code></pre></p> <p>\uc7ac\ube4c\ub4dc <pre><code>$ cd ~/drakvuf\n$ meson setup build --reconfigure\n$ ninja -C build\n$ sudo ninja -C build install\n$ sudo ldconfig\n</code></pre></p> <p>\ucee4\ub9e8\ub4dc <pre><code>sudo env WRITEWATCH_PID=4972 \\\n         WRITEWATCH_RANGE=0x0000020000000000-0x000002FFFFFFFFFF \\\n  drakvuf -r /root/symbols/ntkrnlmp.json -d 1 -a pid_va_writewatch\n</code></pre></p>"},{"location":"18-drakvuf-heap/#pfn_writewatch","title":"pfn_writewatch","text":"<p>\ud799 \ud560\ub2f9\ub41c va\uc5d0 \uac12\uc774 \ubcc0\ud654\ud558\ub294\uac8c CE\uc5d0\uc11c \ubcf4\uc784\uc5d0\ub3c4 \uc5ec\uae30\uc11c\ub294 \uac19\uc740 seed\uc758 va write\ub97c \ubabb\uc7a1\uc544\uc634. \uc77c\ubc18 read\uc5d0\uc11c\ub294 \uc77d\uc5b4\uc624\ub294 \uac78 \ubcf4\uba74 \ud504\ub85c\uc138\uc2a4\uac00 \uc544\ub2cc \ub2e4\ub978 \uacf3\uc5d0\uc11c \ud574\ub2f9 gpa\uc5d0 write \ud558\ub294 \uac78\ub85c \ucd94\uc815. \uc989 \uacb0\uacfc write\ub294 \uc77d\uc744 \uc218 \uc788\uc9c0\ub9cc \uc2e4\uc2dc\uac04 \ub9dd\uc5d0\ub294 \ud3ec\ucc29\ub418\uc9c0 \uc54a\ub294\ub2e4\ub294 \ub73b. va\ub97c gpa\ub85c \ubc88\uc5ed\ud55c \ud6c4 write\ub97c \uc7a1\uc544\uc624\ub3c4\ub85d \uace0\uce5c\ub2e4.</p> <p>drakvuf/ \u2514\u2500 src/    \u2514\u2500 plugins/       \u251c\u2500 meson.build              \u2190 \uc5ec\uae30\uc5d0 \ud55c \uc904 \ucd94\uac00       \u2514\u2500 pfn_writewatch/          \u251c\u2500 pfn_writewatch.cpp \u2190 \uc0c8\ub85c \ucd94\uac00          \u2514\u2500 pfn_writewatch.h   \u2190 \uc0c8\ub85c \ucd94\uac00</p> <p>\ucee4\uc2a4\ud140 \ud50c\ub7ec\uadf8\uc778 \uc81c\uc791 <pre><code>$ cd ~/drakvuf/src/plugins\n$ mkdir pfn_writewatch\n$ nano pfn_writewatch/pfn_writewatch.h\n$ nano pfn_writewatch/pfn_writewatch.cpp\n$ nano meson.build\nplugin_sources = [\n  # (\uae30\uc874\ub4e4)\n  'pfn_writewatch/pfn_writewatch.cpp',\n  'pfn_writewatch/pfn_writewatch.h',\n]\n$ nano plugins.h\n\ud50c\ub7ec\uadf8\uc778 \ub9ac\uc2a4\ud2b8 drakvuf_plugin_t \uc758 \ub9c8\uc9c0\ub9c9 __DRAKVUF_PLUGIN_LIST_MAX \uc55e\uc904\uc5d0\n    PLUGIN_PFN_WRITEWATCH,\n\uc774\ub984 \ub9ac\uc2a4\ud2b8 static const char* drakvuf_plugin_names[] \uc5d0\n    [PLUGIN_PFN_WRITEWATCH] = \"pfn_writewatch\",\nos \uc9c0\uc6d0 \ub9ac\uc2a4\ud2b8 drakvuf_plugin_os_support \uc5d0\n    [PLUGIN_PFN_WRITEWATCH] = { [VMI_OS_WINDOWS] = 1, [VMI_OS_LINUX] = 1 },\n$ nano plugins.cpp\n#include \"pfn_writewatch/pfn_writewatch.h\"\ndrakvuf_plugins::start \uc548\uc758 \ud070 switch\uc5d0 case \ucd94\uac00\ncase PLUGIN_PFN_WRITEWATCH:\n{\n    this-&gt;plugins[plugin_id] = std::make_unique&lt;pfn_writewatch&gt;(this-&gt;drakvuf, this-&gt;output);\n    break;\n}\n</code></pre></p> <p>\uc7ac\ube4c\ub4dc <pre><code>$ cd ~/drakvuf\n$ meson setup build --reconfigure\n$ ninja -C build\n$ sudo ninja -C build install\n$ sudo ldconfig\n</code></pre></p> <p>\ucee4\ub9e8\ub4dc <pre><code>export WRITEWATCH_PFN_RANGE=0x12abc-0x12ac0\nexport WRITEWATCH_SECONDS=5\ndrakvuf -r /root/symbols/ntkrnlmp.json -d &lt;domid&gt; -a pfn_writewatch -o json\n</code></pre></p>"},{"location":"18-drakvuf-heap/#_2","title":"\uc0c1\uc704 \ud074\ub7ec\uc2a4\ud130 \uac10\uc2dc","text":"<p>watch_data_ranges.py</p> <p>\uc2e4\uc2dc\uac04\uc73c\ub85c .data \uc139\uc158\uc744 \ub364\ud504\ud558\uc5ec heap \ud3ec\uc778\ud130\ub85c \ucd94\uc815\ub418\ub294 candidate\ub97c \uc804\ubd80 \ucc3e\uace0 \uc0c1\uc704 \ud074\ub7ec\uc2a4\ud130 \ubc94\uc704 \ub2e4\uc12f\uac1c\ub97c \ucd94\ub824 pfn_writewatch \ud50c\ub7ec\uadf8\uc778\uc73c\ub85c \uac10\uc2dc\ud558\ub294 \ucf54\ub4dc .data \ub364\ud504 + candidate \ucc3e\uae30 + \uc0c1\uc704 \ud074\ub7ec\uc2a4\ud130 \ub9cc\ub4e4\uae30 + pfn \ubc88\uc5ed + writewatch + \ub0b4\uc6a9 \ubc0f \ub378\ud0c0 \ubc14\uc774\ud130 \ud655\uc778</p> <p>\uc2e4\ud589 \ucee4\ub9e8\ub4dc <pre><code>$ sudo vmi-process-list win10 | grep -i overwatch\n$ cd ~/game-cheat/code\n$ sudo /home/kkongnyang2/vmi-venv/bin/python3 -m dump.watch_data_ranges \\\n  --domain win10 --pid 2900 --module Overwatch.exe \\\n  --ist-json /root/symbols/ntkrnlmp.json \\\n  --python /home/kkongnyang2/vmi-venv/bin/python3 \\\n  --dumper-module dump.vmi_dump_section \\\n  --project-root ~/game-cheat/code \\\n  --drakvuf /usr/local/bin/drakvuf \\\n  --watch pfn \\\n  --mode cluster --topk 5 --gran-log2 22 --gap-pages 64 --pad 0x10000 \\\n  --duration 10 --interval 5 \\\n  --ww-mode both --peek-bytes 16 --max-changes 12 \\\n  --outdir /home/kkongnyang2/watch_dump --max-pfns 2048\n</code></pre> \uc57d\uac04 \ubc94\uc704\uac00 \ube57\ub098\uac10. \ub09c\ub3c5\ud654 \ub54c\ubb38\uc5d0 .data\uc5d0 \uc788\ub294 \ud3ec\uc778\ud130\ub4e4\uc774 \ubd80\uc815\ud655 \ud558\uac70\ub098, \ud799\uc5d0 \ud3ec\uc778\ud130\uac00 \uc788\ub294 \uac70 \uac19\uc74c.</p>"},{"location":"19-ow-memory/","title":"19 ow memory","text":""},{"location":"19-ow-memory/#_1","title":"\uc624\ubc84\uc6cc\uce58 \uad6c\uc870 \ub808\ud37c\ub7f0\uc2a4\ub97c \uc0b4\ud3b4\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-27</p>"},{"location":"19-ow-memory/#ecs","title":"\uc77c\ubc18\uc801\uc778 ECS \uc5d4\uc9c4","text":"<p>Entity = \ud50c\ub808\uc774\uc5b4 10\uba85\uc5d0\uac8c \ubd80\uc5ec\ud558\ub294 \uc2dd\ubcc4 ID Component = \uc0c1\ud0dc \ub370\uc774\ud130 System = \ubaa8\ub4e0 \ub85c\uc9c1 \ud568\uc218. \uc0c1\ud0dc\uc640 \uc870\uac74\uc744 \ub530\uc838 \uc0c1\ud0dc\ub97c \ubcc0\uacbd\uc2dc\ud0a4\ub294 \uc2dc\uc2a4\ud15c.</p> <p>\uc5d4\ud2f0\ud2f0\ub294 \uc544\ud0a4\ud0c0\uc785, \uc989 \uac19\uc740 \ucef4\ud3ec\ub10c\ud2b8 \uc2a4\ud2b8\ub9bc\ub4e4\uc744 \uac00\uc9c0\ub294 \uc560\ub4e4\ub85c \ubd84\ub958\ub41c\ub2e4. \uc544\ud0a4\ud0c0\uc785 A = hp, position x \uc544\ud0a4\ud0c0\uc785 B = barrier, position y</p> <p>(.data) g_world \u2500\u2500\u25ba (heap) World                       \u251c\u2500 registry \u2500\u25ba (heap) EntityLoc[Max]   // entityId \u2192 (chunk, idx)                       \u2514\u2500 pools     \u2500\u25ba Map <p>(heap) ArchetypePool     \u251c\u2500 layout \u2500\u25ba (rdata/heap) ArchetypeLayout { CompLayout[] (offset,stride) }     \u2514\u2500 chunks : vector \u2500\u25ba (heap) Chunk { count, entity_dense[], data_base \u2026 } <p>\uc8fc\uc18c = chunk.data_base + layout.comp[id].offset + local_index * layout.comp[id].stride</p> <ul> <li>\ucd5c\ucd08\uc758 \ub8e8\ud2b8 \ud3ec\uc778\ud130 : g_world \ud3ec\uc778\ud130</li> <li>world : \ub7f0\ud0c0\uc784\uc758 \ub8e8\ud2b8 \ucee8\ud14d\uc2a4\ud2b8. \uac8c\uc784 \ud55c \ud310\uc744 \ub300\ud45c\ud558\ub294 \ucd5c\uc0c1\uc704 \uadf8\ub987.</li> <li>registry : \uc5d4\ud2f0\ud2f0/\ucef4\ud3ec\ub10c\ud2b8/\uc544\ud0a4\ud0c0\uc785/\uccad\ud06c\ub97c \uc778\ub371\uc2f1\ud558\ub294 O(1) \uc911\uc559 \ud14c\uc774\ube14             EntityLoc[], FreeList, IDAllocator, ArchetypeTbale, LayoutTable</li> <li>EntityLoc : \ub808\uc9c0\uc2a4\ud2b8\ub9ac\uc758 \ud14c\uc774\ube14 \uc911 \uac00\uc7a5 \ud56b\ud568             entityId \u2192 (archetype, chunk*, local_index)</li> <li>ArchetypePool: \uc2e4\uc81c \ub370\uc774\ud130 \ucee8\ud14c\uc774\ub108 \uc9d1\ud569</li> <li>ArchetypeLayout: \uc774\ubbf8 \uac1c\ubc1c\uc790\ub4e4\uc774 \ub9cc\ub4e4\uc5b4\ub193\uc740 \ub808\uc774\uc544\uc6c3                   id, comp_count, compLayout[], chunk_data_size</li> <li>CompLayout : id, offset, stride</li> </ul> <p>\ucc3e\uc544\uac00\ub294 \ubc29\ubc95\uc740 \ub530\ub77c\uc11c \ub450\uac1c.</p> <p>g_world.registry.EntityLoc.chunk \ub3c4\ucc29\ud574\uc11c layout\ub85c offset,stride \uc5bb\uc5b4\uc11c \uc8fc\uc18c \uacc4\uc0b0 g_world.pools.ArchetypePool.chunks \ub3c4\ucc29\ud574\uc11c entity_dense \ubcf4\uace0 \uc6d0\ud558\ub294 \uc5d4\ud2f0\ud2f0/\ucef4\ud3ec\ub10c\ud2b8 \ucc3e\uae30. layout\ub85c offset,stride \uc5bb\uc5b4\uc11c \uc8fc\uc18c \uacc4\uc0b0</p> <p>\uac8c\uc784 \uc9c4\ud589</p> <ol> <li>match_start()\uc2dc \uccad\ud06c\ub4e4 \ud560\ub2f9</li> <li>10\uac1c\uc758 \uc5d4\ud2f0\ud2f0 \uc0dd\uc131 - entityID \ubc1c\uae09 \ubc0f \uc544\ud0a4\ud0c0\uc785 \uacb0\uc815</li> <li>\uc785\ub825\uac12\ub4e4\uc774 \ub4e4\uc5b4\uc624\uace0 \uc9c4\ud589\uc774 \ub418\uba74 \ub85c\uceec\uc5d0\uc11c \ub9e4 \ud504\ub808\uc784 \ub80c\ub354\ub9c1\uc2dc\uc2a4\ud15c, UI\uc2dc\uc2a4\ud15c, \uc2a4\ud0ac\uc2dc\uc2a4\ud15c \ub4f1\uc744 \ub3cc\ub9bc</li> <li>\uc5d4\ud2f0\ud2f0\ubcc4\ub85c chunk_base + comp_offset + local_index*stride\ub85c \ucc3e\uc544\uac00 write</li> <li>\ub9e4 \ud504\ub808\uc784 \uc9c4\uc9dc \uc2a4\ub0c5\uc0f7\uc774 \ub4e4\uc5b4\uc624\uba74 \ubcf4\uac04\ud574\uc11c \ub2e4\uc2dc write</li> <li>\ud2b9\uc815 \uc5d4\ud2f0\ud2f0\uac00 \uc544\ud0a4\ud0c0\uc785\uc744 \ubcc0\uacbd\ud558\uba74 \uc2a4\uc651 \uc0ad\uc81c, \uccad\ud06c \ud5e4\ub354 \ubc0f EntityLoc\uc5d0 \ubc18\uc601</li> </ol>"},{"location":"19-ow-memory/#2","title":"\uc624\ubc84\uc6cc\uce582 \uba54\ubaa8\ub9ac \uad6c\uc870 \ub808\ud37c\ub7f0\uc2a4","text":"<pre><code>namespace offset\n{\n    // PoolList\n    constexpr auto entity = 0x8;\n    constexpr auto unique_id = 0x118;\n    constexpr auto local_unique_id = 0x2E8;\n    constexpr auto link_unqiue_id = 0xD4;\n\n    constexpr auto entity_rawlist = 0x20;\n    constexpr auto entity_rawlist_count = 0x2C;\n    constexpr auto next_rawlist = 0x18;\n}\n</code></pre> <p>PoolHeader  \u251c\u2500 0x18: next (\ub2e4\uc74c \ud398\uc774\uc9c0)  \u251c\u2500 0x20: rawlist (\uc5d4\ud2b8\ub9ac \ubc30\uc5f4 \uc2dc\uc791 \uc8fc\uc18c)  \u2190 \uc5ec\uae30\ub97c \ub530\ub77c\uac00\uba74  \u2514\u2500 0x2C: count</p> <p>rawlist:  [ Entry0 ][ Entry1 ][ Entry2 ] ... (count\uac1c)               \u2514\u2500 +0x08 \uc5d0 Parent(\uc5d4\ud2f0\ud2f0) \ud3ec\uc778\ud130 (\uad6c\uc870\uccb4\ud615\uc77c \ub54c)</p> <p>\uadf8\ub807\uac8c \ucc3e\uc740 Parent(\uc989 \uc5d4\ud2f0\ud2f0) \uc8fc\uc18c\ub97c decrypt::Parent(parent, N)\uc5d0 \uc785\ub825\ud558\uba74 ComponentBase \ub9ac\ud134</p> <p>uint64_t decrypt::Parent(uint64_t Parent, uint8_t Type) //OK { try     {         if (IsValidPtr(Parent))         {             uint64_t v1 = Parent;             uint64_t v2 = (uint64_t)1 &lt;&lt; (uint64_t)(Type &amp; 0x3F);             uint64_t v3 = v2 - 1;             uint64_t v4 = Type &amp; 0x3F;             uint64_t v5 = Type / 0x3F;             uint64_t b1 = (_QWORD)(v1 + 0x60);             uint64_t b2 = (_QWORD)(v1 + 8i64 * v5 + 0xF0);             uint64_t b3 = (v2 &amp; (_QWORD)(v1 + 8i64 * v5 + 0xF0)) &gt;&gt; v4;             uint64_t b4 = (v3 &amp; b2) - (((v3 &amp; b2) &gt;&gt; 1) &amp; 0x5555555555555555i64);             uint64_t b5 = (unsigned __int8)(v5 + v1 + 272)                 + ((72340172838076673i64                     * (((b4 &amp; 0x3333333333333333i64)                         + ((b4 &gt;&gt; 2) &amp; 0x3333333333333333i64)                         + (((b4 &amp; 0x3333333333333333i64) + ((b4 &gt;&gt; 2) &amp; 0x3333333333333333i64)) &gt;&gt; 4)) &amp; 0xF0F0F0F0F0F0F0Fi64)) &gt;&gt; 56);             uint64_t Key1 = CompKey1;             uint64_t Key2 = CompKey2;             uint64_t b6 = (_QWORD)(b1 + 8 * b5);             uint64_t b7 = Key2 ^ ((unsigned int)b6 | ((unsigned int)b6 | b6 &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)((unsigned int)b6 ^ ~(unsigned int)(_QWORD)(ImageBase + 0x3ACDCA0 + (Key1 &amp; 0xFFF))) &lt;&lt; 32)) &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)((unsigned int)b6 ^ 0xBC6F2947) &lt;&lt; 32));             uint64_t b8 = (unsigned int)b7 | b7 &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)(unsigned int)(b7                 + __ROL4( (_QWORD)(ImageBase + 0x3ACDCA0 + (Key1 &gt;&gt; 52)),                     1)) &lt;&lt; 32);             return -(int)b3 &amp; ((unsigned int)b8 | b8 &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)((unsigned int)b8 ^ (unsigned int)~((_QWORD)(ImageBase + 0x3ACDCA0 + (Key1 &amp; 0xFFF)) &gt;&gt; 32)) &lt;&lt; 32));         }     }     __except (1) {}     return 0; }</p> <p>\ube44\ud2b8\ub9c8\uc2a4\ud06c/\ubca1\ud130 \uba85\ub839\uc5b4(SSE)\ub85c \ud0a4\ub97c \uc11e\uc5b4 \uacb0\uacfc \ud3ec\uc778\ud130\ub97c \ubcf5\ud638\ud654</p> <p>\ucc38\uace0\ub85c N\uc740 eComponentType</p> <p>enum eComponentType {     TYPE_ANIMATE = 0x1,     TYPE_RAY = 0x02,     TYPE_VELOCITY = 0x04,     TYPE_TEAMBIT = 0x1F,     TYPE_ROTATE = 0x2D,     TYPE_PLAYER = 0x31,     TYPE_LINK = 0x32,     TYPE_VISCHECK = 0x33,     TYPE_SKILL = 0x35,     TYPE_ROTATE2 = 0x37,     TYPE_OBJECT = 0x38,     TYPE_HEALTH = 0x39,     TYPE_CMD = 0x41,     TYPE_HEROID = 0x52,     TYPE_OUTLINE = 0x5A, };</p> <p>\ucc3e\uc740 ComponentBase\uc5d0\uc11c \uc544\ub798\uc640 \uac19\uc740 \uc624\ud504\uc14b\uc744 \ucd94\uac00\ud558\uba74 \ud574\ub2f9 \ub370\uc774\ud130 \ud56d\ubaa9</p> <p>namespace offset {     // MeshComponent     constexpr auto velocity = 0x50;     constexpr auto root_pos = 0x380;     constexpr auto bone_list = 0x810;</p> <pre><code>// TeamComponent\nconstexpr auto team = 0x58;\n\n// RotateComponent\nconstexpr auto rotate_struct = 0x7C0;\nconstexpr auto rotate_yaw = 0x8FC;\n\n// SkillComponent\nconstexpr auto skill_rawlist = 0x1868;\nconstexpr auto skill_struct = 0x22A2F00;\n\n// ObjectComponent\nconstexpr auto ObUniqueID = 0x18;\nconstexpr auto ObPos = 0xE0;\n\n// HealthComponent\nconstexpr auto health = 0xDC;\nconstexpr auto armor = 0x21C;\nconstexpr auto barrier = 0x35C;\n\n// HeroComponent\nconstexpr auto hero_id = 0xF0;\n\n// CommandComponent\nconstexpr auto input = 0x1244;\nconstexpr auto angle = 0x12A0;\n</code></pre> <p>}</p>"},{"location":"19-ow-memory/#poollist","title":"\uadf8\ub7fc PoolList\ub294 \uc5b4\ub5bb\uac8c \ucc3e\ub294\ub370?","text":"<p>XorKey, Index, Table, GM \uc21c\uc73c\ub85c \ubcf5\ud638\ud654\ud574\uc11c.</p> <p>uint64_t decrypt::GameManagerXorKey(uint64_t a1) //OK {     __try     {         __int64 v1; // rbx         unsigned __int64 v2; // rdi         unsigned __int64 v3; // r8         unsigned __int64 v4; // rax         unsigned __int64 v5; // rbx         unsigned __int64 v6; // rcx         unsigned __int64 v7; // rcx         __m128i v8; // xmm1         __m128i v9; // xmm2         __m128i v10; // xmm0         __m128i v11; // xmm1</p> <pre><code>    v1 = a1;\n    v2 = ImageBase + 0x5D14D2;\n    v3 = v2 + 0x8;\n    v4 = 0i64;\n    v5 = *(__int64*)(ImageBase + 0x3ACECC0\n        + 8 * (((unsigned __int8)v1 + 0x66) &amp; 0x7F)\n        + (((unsigned __int64)(v1 + 0xF74216354A20866i64) &gt;&gt; 7) &amp; 7)) ^ v2 ^ (v1 + 0xF74216354A20866i64);\n    v6 = (v3 - v2 + 7) &gt;&gt; 3;\n    if (v2 &gt; v3)\n        v6 = 0i64;\n    if (v6 &amp;&amp; v6 &gt;= 4)\n    {\n        v7 = v6 &amp; 0xFFFFFFFFFFFFFFFCui64;\n        ZeroMemory(&amp;v8, sizeof(v8));\n        ZeroMemory(&amp;v9, sizeof(v9));\n\n        do\n        {\n            v4 += 4i64;\n            v8 = _mm_xor_si128(v8, _mm_loadu_si128((const __m128i*)v2));\n            v10 = _mm_loadu_si128((const __m128i*)(v2 + 16));\n            v2 += 32i64;\n            v9 = _mm_xor_si128(v9, v10);\n        } while (v4 &lt; v7);\n        v11 = _mm_xor_si128(v8, v9);\n        v5 ^= _mm_xor_si128(v11, _mm_srli_si128(v11, 8)).m128i_u64[0];\n    }\n    for (; v2 &lt; v3; v2 += 8i64)\n        v5 ^= *(_QWORD*)v2;\n\n    return v5 ^ ~v3 ^ 0xF74216354A20866i64;\n}\n__except (1) {}\nreturn 0;\n</code></pre> <p>}</p> <p>int decrypt::GameManagerIndex(uint64_t a1) //OK {     __try     {         __int64 v1; // rdi         __int64 v2; // rbx         unsigned __int64 v3; // rsi         __int64 v4; // r10         __int64 v5; // r11         __int64 v6; // rax         _QWORD* v7; // r9         __int64 v8; // r10         __int64 v9; // rax</p> <pre><code>    v1 = a1;\n    v2 = ImageBase + 0x5D70D0;\n    v3 = v2 + 0xB;\n    v4 = 0xCC0BFEAA1FF95DA9i64;\n    v5 = v1 + 24;\n    v6 = 4i64;\n\n    do\n    {\n        v7 = (_QWORD*)(v5 - 16);\n        v8 = *(_QWORD*)(v5 + 8) ^ (v5 - 8) ^ (v5 - 16) ^ (v5 - 24) ^ *(_QWORD*)v5 ^ *(_QWORD*)(v5 - 24) ^ *(_QWORD*)(v5 - 8) ^ v5 ^ ~(v5 + 8) ^ v4;\n        v5 += 0x28i64;\n        v4 = *v7 ^ v8;\n        --v6;\n    } while (v6);\n\n    for (; v2 + 64 &lt; v3; LOBYTE(v4) = v9 ^ v4)\n    {\n        v9 = *(_QWORD*)v2 ^ ~v2;\n        v2 += 8i64;\n    }\n    return ((unsigned __int8)v4 ^ 6) &amp; 0xF;\n}\n__except (1) {}\nreturn 0;\n</code></pre> <p>}</p> <p>uint64_t decrypt::Table() //OK {     __try     {         uint64_t Key1 = GMKey1;         uint64_t Key2 = GMKey2;</p> <pre><code>    uint64_t qword_3AE3978 = *(uint64_t*)(ImageBase + 0x3AE3978);\n\n    uint64_t v2 = (unsigned int)Key2 ^ (unsigned int)qword_3AE3978 | (Key2 ^ ((unsigned int)qword_3AE3978 | ((unsigned int)qword_3AE3978 | qword_3AE3978 &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)(unsigned int)(557102392 - qword_3AE3978) &lt;&lt; 32)) &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)(unsigned int)(qword_3AE3978 - (*(_QWORD*)(((unsigned __int64)Key1 &gt;&gt; 52) + ImageBase + 61660320) &gt;&gt; 32)) &lt;&lt; 32))) &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)(((unsigned int)Key2 ^ (unsigned int)qword_3AE3978) + __ROL4__(*(_QWORD*)((Key1 &amp; 0xFFF) + ImageBase + 61660320), 1)) &lt;&lt; 32);\n    uint64_t v3 = (unsigned int)v2 | v2 &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)(unsigned int)(-229200722 - v2) &lt;&lt; 32);\n    uint64_t GMXorKey = decrypt::GameManagerXorKey(*(uint64_t*)(0xA0 + v3));\n\n    uint64_t XorBuf[20];\n    uint64_t v6;\n\n    for (uint64_t i = 0i64; i &lt; 20; ++i)\n    {\n        XorBuf[i] = *(_QWORD*)(v3 + 8 * i) ^ GMXorKey;\n        switch ((unsigned __int64)(GMXorKey &amp; 7))\n        {\n        case 0ui64:\n            v6 = 0xA22115FFD20A1F26i64;\n            break;\n        case 1ui64:\n            v6 = 0xC93978D9115078F0i64;\n            break;\n        case 2ui64:\n            v6 = 0xDE83BAC0690CC8A2i64;\n            break;\n        case 3ui64:\n            v6 = 0x57C00EA24B120A82i64;\n            break;\n        case 4ui64:\n            v6 = 0xB2730B23F294D216i64;\n            break;\n        case 5ui64:\n            v6 = 0x53F351AE73BE44D4i64;\n            break;\n        case 6ui64:\n            v6 = 0x3B207AD9732C7F3Ei64;\n            break;\n        default:\n            v6 = 0x1C84FF058EB23CBCi64;\n            break;\n        }\n        GMXorKey += v6;\n    }\n\n    int Idx = GameManagerIndex((uint64_t)XorBuf);\n    uint64_t result = XorBuf[Idx + 4];\n    return result;\n}\n__except (1) {}\nreturn 0;\n</code></pre> <p>}</p> <p>uint64_t decrypt::GameManager() //OK {     __try     {         uint64_t engm = (uint64_t)(Table() + 0x30);         uint64_t v1 = (uint64_t)(ImageBase + 0x3ACE14A) - 0x14737E1555DD8CD7i64;</p> <pre><code>    if (engm != v1)\n        return engm ^ v1;\n}\n__except (1) {}\nreturn 0;\n</code></pre> <p>}</p> <p>uint64_t decrypt::Ray(uint64_t GameManager) {     __try     {         uint64_t Key1 = RayKey1;         uint64_t Key2 = RayKey2;</p> <pre><code>    uint64_t  v3 = *(_QWORD*)(GameManager + 0x220);\n    uint64_t  v4 = (unsigned int)v3 | v3 &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)(unsigned int)(v3 + 0x184E9681) &lt;&lt; 32);\n    uint64_t  v5 = Key2 ^ ((unsigned int)v3 | v4 &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)(unsigned int)(v4\n        + __ROL4__(\n            *(_QWORD*)(ImageBase + 0x3ACDCA0 + ((unsigned __int64)Key1 &gt;&gt; 52)) &gt;&gt; 32,\n            1)) &lt;&lt; 32));\n    return (unsigned int)v5 | ((unsigned int)v5 | v5 &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)((unsigned int)v5 - (unsigned int)*(_QWORD*)(ImageBase + 0x3ACDCA0 + (Key1 &amp; 0xFFF))) &lt;&lt; 32)) &amp; 0xFFFFFFFF00000000ui64 ^ ((unsigned __int64)(unsigned int)(2 * v5 + 994381642) &lt;&lt; 32);\n}\n__except (1) {}\nreturn 0;\n</code></pre> <p>}</p> <p>uint64_t decrypt::Outline(uint64_t Xor) {     __int64 v1; // rbx     unsigned __int64 v2; // rdi     unsigned __int64 v3; // r8     unsigned __int64 v4; // rax     __int64 v5; // rbx     unsigned __int64 v6; // rcx     unsigned __int64 v7; // rcx     __m128i v8; // xmm1     __m128i v9; // xmm2     __m128i v10; // xmm0     __m128i v11; // xmm1     unsigned __int64 retaddr; // [rsp+28h] [rbp+0h]     char v14; // [rsp+68h] [rbp+40h]</p> <pre><code>v1 = Xor;\nv2 = ImageBase + 0x7AEC32;\nv3 = v2 + 0x8;\nv4 = 0i64;\nv5 = *(uint64_t*)(ImageBase + 0x3AA7180\n    + 8 * (((unsigned __int8)v1 - 78) &amp; 0x7F)\n    + (((unsigned __int64)(v1 + 817210438226979250i64) &gt;&gt; 7) &amp; 7)) ^ v2 ^ (v1 + 817210438226979250i64);\nv6 = (v3 - v2 + 7) &gt;&gt; 3;\nif (v2 &gt; v3)\n    v6 = 0i64;\nif (v6 &amp;&amp; v6 &gt;= 4)\n{\n    v7 = v6 &amp; 0xFFFFFFFFFFFFFFFCui64;\n    ZeroMemory(&amp;v8, sizeof(v8));\n    ZeroMemory(&amp;v9, sizeof(v9));\n\n    do\n    {\n        v4 += 4i64;\n        v8 = _mm_xor_si128(v8, _mm_loadu_si128((const __m128i*)v2));\n        v10 = _mm_loadu_si128((const __m128i*)(v2 + 16));\n        v2 += 32i64;\n        v9 = _mm_xor_si128(v9, v10);\n    } while (v4 &lt; v7);\n    v11 = _mm_xor_si128(v8, v9);\n    auto a1 = _mm_xor_si128(v11, _mm_srli_si128(v11, 8));\n    v5 ^= *(uint64_t*)&amp;a1;\n}\nfor (; v2 &lt; v3; v2 += 8i64)\n    v5 ^= *(uint64_t*)v2;\n\nreturn v5 ^ ~v3 ^ 0xB5750905542A9B2i64;\n</code></pre> <p>}</p>"},{"location":"19-ow-memory/#_2","title":"\uadf8\ub7fc \ubcf5\ud638\ud654 \ucf54\ub4dc\ub294 \uc5b4\ub5bb\uac8c \ucc3e\ub294\ub370?","text":"<p>\uc2e4\ud589 \uc911\uc5d0 \uacc4\uc18d \uc0ac\uc6a9\ub418\ub294 \ubcf5\ud638\ud654 \ucf54\ub4dc\ub294 \ubcf4\ud1b5 \uac8c\uc784 EXE \ud639\uc740 \ubcf4\uc548 DLL\uc758 .text\uc5d0 \uc788\ub2e4. \ud0a4/\uc0c1\uc218/\ud14c\uc774\ube14 \uac19\uc774 \uc790\uc8fc \ubc14\ub00c\uc9c0 \uc54a\ub294 \uc0c1\uc218\uc640 \uc154\ud50c\ub9c8\uc2a4\ud06c, RVA \ud3ec\uc778\ud130\ub4e4\uc740 .rdata\uc5d0 \ub193\uc774\ub294 \uacbd\uc6b0\uac00 \ub9ce\ub2e4. \uc138\uc158\uc774\ub098 \ud504\ub808\uc784\ubcc4\ub85c \ubc14\ub00c\ub294 \ud0a4\ub294 \ud799\uc774\ub098 TLS \uac19\uc740 \ub7f0\ud0c0\uc784 \uc800\uc7a5\uc18c\uc5d0 \uc788\ub2e4. </p> <pre><code>// Decryption\nconstexpr auto decrypt_key = 0xB3D20;\n</code></pre> <p>\ube44\ud2b8\ub9c8\uc2a4\ud06c/SSE\uac19\uc740 \uacc4\uc0b0\uc744 \ucc3e\uac70\ub098, store \uc774\uc804\uc5d0 \ub9c8\uc774\ud06c\ub85c \ud2b8\ub808\uc774\uc2a4\ub97c \ub364\ud504\uc2dc\ucf1c\uc57c \ud55c\ub2e4.</p>"},{"location":"19-ow-memory/#_3","title":"\ub370\uc774\ud130 \ubc1b\uae30","text":"<p>hp \ubc0f \uc704\uce58 \uc11c\ubc84 \uae30\uc900\uc73c\ub85c \ub0b4 \ub85c\uceec \ud50c\ub808\uc774\uc5b4\ub294 \uc5b4\ub290\uc815\ub3c4 \ubbf8\ub9ac \uc785\ub825\uac12\uc744 \ubc18\uc601\ud574 \uc791\ub3d9\ud558\ub294 \uac70\uace0, \uc11c\ubc84\uc5d0\uc11c \uc774\uc81c \uc81c\ub300\ub85c \ub41c \ub378\ud0c0\uac12\uc774 \uc624\uba74 \uc774\uc804 \uc2a4\ub0c5\uc0f7\uc5d0\uc11c \uacc4\uc0b0\ud574 \uc633\uc740 \uac12\ub4e4\uc744 \uc5c5\ub370\uc774\ud2b8\ud558\uace0 \ubc18\uc601\ud574\uc8fc\uace0, \uc11c\ubc84\uc5d0\uc11c \ud55c\ubc88\uc529 \ub378\ud0c0\uac12\uc774 \uc544\ub2c8\ub77c \ud480 \uc2a4\ub0c5\uc0f7\uc744 \ubcf4\ub0b4 \ud639\uc2dc\ub77c\ub3c4 \ud2c0\uc5b4\uc84c\uc744\uac78 \ubc29\uc9c0\ud574\uc900\ub2e4. \ud2b9\uc815 DLL\uc774 \uc544\ub2c8\ub77c Overwatch.exe\uac00 \ub4e4\uace0 \uc788\ub294 ECS \ucee8\ud14c\uc774\ub108(\uba54\ubaa8\ub9ac)\uc5d0 \uc62c\ub77c\uac00 \uc788\ub2e4.</p> <p>\uc5d0\uc14b \ub610\ud55c \\Data\\Casc\uc5d0\ub294 \uc2e4\uc2dc\uac04 \ub370\uc774\ud130\uac00 \uc544\ub2cc \uc5d0\uc14b(\ub9ac\uc18c\uc2a4) \uc815\ubcf4\ub4e4\uc774 \ub4e4\uc5b4\uc788\uc5b4\uc11c \ud544\uc694\ud560 \ub54c\ub9c8\ub2e4 \ucc38\uc870\ud55c\ub2e4. \ub124\ud2b8\uc6cc\ud06c \uacc4\uce35(BLTE\ube14\ub85d, \uc554\ud638\ud654 \ubc0f \uc555\ucd95)\uc5d0\uc11c \ubc1b\uc544\uc640 \ub85c\uceec \ud30c\uc77c\uc758 Data\\Casc\uc5d0 BLTE \ube14\ub85d(data.000..) + \uc624\ud504\uc14b \ud06c\uae30 \uc815\ubcf4\uc778 .idx\ub97c \uc800\uc7a5\ud574\ub450\uace0, \ud30c\uc77c\uba85\uc744 Ckey(\ucee8\ud150\uce20 \ud574\uc2dc)\ub85c \ub9e4\ud551 \ud6c4 Ekey(\uc778\ucf54\ub529 \ud574\uc2dc)\ub85c \ub9e4\ud551, .idx\uc5d0\uc11c BTLE \ube14\ub85d\uacfc \uc624\ud504\uc14b \uc815\ubcf4 \ucc3e\uc74c \ud574\ub2f9 \ube14\ub85d\uc744 \uac00\uc838\uc640 \ubcf5\ud638\ud654 \ubc0f \uc555\ucd95\ud574\uc81c\ud558\uc5ec \ud3c9\ubb38\uc73c\ub85c \uba54\ubaa8\ub9ac\uc5d0 \uc804\uac1c</p> <p>\ud53c\uaca9 \ud45c\uc2dc \ud074\ub77c: \ubc1c\uc0ac \u2192 \uc785\ub825(+\uc2dc\uac01/\uc2dc\ub4dc) \uc804\uc1a1, \uc608\uce21 \ud788\ud2b8\ub9c8\ucee4 \uc7a0\uae50 \ud45c\uc2dc \uc11c\ubc84: \uacfc\uac70\ub85c \ub9ac\uc640\uc778\ub4dc \u2192 \ub808\uc774\uce90\uc2a4\ud2b8 \u2192 \ud788\ud2b8 \ud655\uc815 &amp; \ud53c\ud574 \uacc4\uc0b0 \u2192 Health \uac10\uc18c \uc11c\ubc84\u2192\ud074\ub77c: \ub2e4\uc74c \ud2f1\uc5d0 \ud53c\uaca9\uc790 Health \ub378\ud0c0 + (\uc120\ud0dd) HitConfirm \uc774\ubca4\ud2b8 \uc804\uc1a1 \ud074\ub77c: Health \ubc18\uc601, \uc608\uce21 \ud788\ud2b8\ub9c8\ucee4\ub97c \ud655\uc815/\ucde8\uc18c, \uc774\ud399\ud2b8/\uc0ac\uc6b4\ub4dc \uc7ac\uc0dd</p>"},{"location":"2-cheats/","title":"2 cheats","text":""},{"location":"2-cheats/#_1","title":"\ud575 \uc885\ub958\ub97c \uc54c\uc544\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-07-10</p>"},{"location":"2-cheats/#_2","title":"&gt; \uac00\ub2a5\ud55c \uc2dc\ub098\ub9ac\uc624","text":"<p>\uc694\uc998 \ud575\uc740 \uba54\ubaa8\ub9ac\uc5d0 \ub123\ub294 internal \uce58\ud2b8\ub294 \uc904\uc5b4\ub4e4\uace0, external \uce58\ud2b8\uac00 \ub298\uc5b4\ub0ac\ub2e4. \ub0b4\ubd80 \uce58\ud2b8 : (1) \uba54\ubaa8\ub9ac \uc778\uc81d\uc158 (2) \ucee4\ub110 \ub4dc\ub77c\uc774\ubc84 \uc678\ubd80 \uce58\ud2b8 : (1) \uc7a5\uce58 \uc774\uc6a9 (2) \uac00\uc0c1\uba38\uc2e0 \uc774\uc6a9</p> <ul> <li>AES-CTR \uc554\ud638\ud654\ub85c \ub124\ud2b8\uc6cc\ud06c \ub2e8\uc5d0\uc11c \uac00\ub85c\ucc44\ub294\uac74 \uac70\uc758 \ubd88\uac00\ub2a5. \ud3c9\ubb38\uc73c\ub85c \uc801\ud78c \uba54\ubaa8\ub9ac \uc21c\uac04 \ubcc0\uc870\ud574\uc57c \ud568.</li> </ul>"},{"location":"2-cheats/#_3","title":"&gt; \uba54\ubaa8\ub9ac \uc778\uc81d\uc158","text":"<p>\uc2a4\ub0c5\uc0f7\uc774 AES-CTR\ub85c \uc554\ud638\ud654\ub41c\ub2e4\ud574\ub3c4 \ub124\ud2b8\uc6cc\ud06c \uc804\uc1a1 \uc911\uc758 \ubcc0\uc870\ub97c \ub9c9\uc544\uc904 \ubfd0, \uacb0\uad6d \ud074\ub77c\uc774\uc5b8\ud2b8 \uba54\ubaa8\ub9ac \uc548\uc5d0\uc11c\ub294 \ub2e4\uc2dc \ud3c9\ubb38\uc774 \ub41c\ub2e4. \ub530\ub77c\uc11c \uadf8\uac78 \uc77d\uc5b4\uc640 \uc0c1\ub300 \ub370\uc774\ud130\ub97c \ud30c\uc545\ud558\uace0 \uadf8\uac78 \ubc14\ud0d5\uc73c\ub85c \ubcf8\uc778 \uc804\uc1a1 command \ud328\ud0b7\uc744 \uc870\uc791\ud574\uc11c \ubcf4\ub0b4\uba74 \ub41c\ub2e4.</p> <p>\uc624\ubc84\uc6cc\uce58\ub294 \uc774\ub97c \ub9c9\uae30 \uc704\ud574 \ub2e4\uc74c\uacfc \uac19\uc740 \uc870\uce58\ub97c \ucde8\ud55c\ub2e4</p> <p>\uc11c\ubc84\uac00 \uac01 \ud074\ub77c\uc774\uc5b8\ud2b8 FOV\ub85c \ub808\uc774\uce90\uc2a4\ud305\ud574 \ubcf4\uc774\ub294 \uc624\ube0c\uc81d\ud2b8\ub9cc \uc2a4\ub0c5\uc0f7\uc5d0 \ud3ec\ud568\ud574\uc11c \ubcf4\ub0b8\ub2e4. \ubcbd \ub4a4 \uc790\ud45c, \ud788\ud2b8\ubc15\uc2a4, \ucfe8\ud0c0\uc784 \ub4f1\uc740 \uc560\ucd08\uc5d0 \ub0b4\ub824\uc624\uc9c0 \uc54a\ub294\ub2e4. \ub610\ud55c \ud074\ub77c\uc774\uc5b8\ud2b8 \uce21\uc5d0\ub3c4 \uc548\ud2f0\uce58\ud2b8\ub97c \ub123\uc5b4\ub193\ub294\ub2e4. warden \uc548\ud2f0\uce58\ud2b8\ub294 wow \uc2dc\uc808\ubd80\ud130 \uc0ac\uc6a9\ub41c \ube14\ub9ac\uc790\ub4dc \ub0b4\ubd80 \uc5d4\uc9c4\uc73c\ub85c, \uc11c\uba85 \uae30\ubc18 \ud504\ub85c\uc138\uc2a4 \uba54\ubaa8\ub9ac \uc2a4\uce94 \ubc29\uc2dd\uc774\ub2e4. Eidolon\uc740 \ucd5c\uadfc \ud328\uce58\uc5d0 \uc77c\uc2dc \ub3c4\uc785\ud558\uc5ec \uc870\uc815 \uc911\uc73c\ub85c, \ucf54\ub4dc \ud750\ub984 \ub09c\ub3c5\ud654 \ubc0f \uc548\ud2f0\ud0d0\ud37c \ubc29\uc2dd\uc774\ub2e4. \ucee4\ub110 \ub808\ubca8 \ub4dc\ub77c\uc774\ubc84\uae4c\uc9c0\ub294 \ub3c4\uc785\ud558\uc9c0 \uc54a\uc558\uc9c0\ub9cc battle.net \ub7f0\ucc98 \uad8c\ud55c\uc73c\ub85c HW \ube0c\ub808\uc774\ud06c, DMA \uc811\uadfc\uc744 \uac10\uc2dc\ud55c\ub2e4. \uc815\uc801 \ud574\uc2dc\ubfd0 \uc544\ub2c8\ub77c \ub7f0\ud0c0\uc784 \ubb34\uacb0\uc131 \uac80\uc0ac, heap Re-randomization\uc744 \uc8fc\uae30\uc801\uc73c\ub85c \ub3cc\ub824 \ud328\ud134 \uce58\ud2b8\ub97c \uc5b4\ub835\uac8c \ub9cc\ub4e0\ub2e4. \uc11c\ubc84 \uce21 Defense matrix \ubc31\uc5d4\ub4dc\ub97c \ud1b5\ud574 \uc2dc\uc98c 12 \uc804\ud6c4\ub85c AI \ubd84\uc11d + \ud589\ub3d9 \ud1b5\uacc4 \ud30c\uc774\ud504\ub77c\uc778\uc744 \uac15\ud654\ud574 50\ub9cc \uacc4\uc815 \uc77c\uad04 \ubc34, \uce58\ud130\uc640 \ud30c\ud2f0\ud55c \ub3d9\ub8cc 4\ub9cc \uacc4\uc815\ub3c4 \ucd94\uac00 \uc81c\uc7ac \ud558\uc600\ub2e4. \ucf58\uc194\uc758 XIM-\ub958 \ub9c8\uc6b0\uc2a4 \ubcc0\ud658\uae30\ub3c4 \uc2e4\uc2dc\uac04 \ud0d0\uc9c0\ud55c\ub2e4. TLS \ud130\ub110 \ub0b4\ubd80\uc5d0\uc11c\ub3c4 \uc2dc\ud000\uc2a4 \ub118\ubc84 + AES-CTR + HMAC\uc744 \uc368\uc11c \uc911\uac04 \uc0bd\uc785, \ub9ac\ud50c\ub808\uc774\ub97c \ubd09\uc1c4\ud55c\ub2e4. \uc11c\ubc84\ub294 \ubb3c\ub9ac \ud55c\uacc4 \uac80\uc99d\uc744 \ub9e4 \ud2f1\ub9c8\ub2e4 \uc218\ud589\ud574 \uc218\uce58\uac00 \ube44\uc815\uc0c1\uc774\uba74 \ubc14\ub85c \ucde8\uc18c\ud55c\ub2e4.</p>"},{"location":"2-cheats/#_4","title":"&gt; \uc7a5\uce58 \uc774\uc6a9 \ud575 \uc2dc\ub098\ub9ac\uc624","text":"<ol> <li>\uac8c\uc784 \uc2e4\ud589</li> <li>PCle \ubc84\uc2a4 \ub9c8\uc2a4\ud130\ub85c \uc6d0\ud558\ub294 \ubb3c\ub9ac\uc8fc\uc18c \uc77d\uae30</li> <li>\ucea1\ucc98\uce74\ub4dc\ub85c \uac8c\uc784 \ud654\uba74 \uc815\ubcf4 \uc77d\uae30</li> <li>\ucf00\uc774\ube14\uc744 \ud1b5\ud574 \ub450\ubc88\uc9f8 PC\ub85c \ub370\uc774\ud130 \uc804\uc1a1</li> <li>ESP/\uc5d0\uc784\ubd07 \uc571\uc774 \uc88c\ud45c, \uccb4\ub825 \ub4f1 \ud30c\uc2f1\ud574\uc11c \ud574\uc11d</li> <li>\uc624\ubc84\ub808\uc774\ub098 \ubcc4\ub3c4 \ubaa8\ub2c8\ud130\uc5d0 \uc6d4\ud575 \ud45c\uc2dc</li> <li>KMBox, Cronus Zen \ub4f1\uc774 \ud328\ub4dc/\ud0a4\ubcf4\ub4dc HID \uc2e0\ud638\ub85c \ubcc0\ud658\ud558\uc5ec \uc804\uc1a1</li> </ol>"},{"location":"2-cheats/#-dma","title":"&gt; \uba54\ubaa8\ub9ac \uac00\uc838\uc624\uae30 - DMA \uce74\ub4dc","text":"<p>Direct Memory Access \uce74\ub4dc. PCle \uc2ac\ub86f\uc5d0 \uaf42\ub294 \uc791\uc740 FPGA \ubcf4\ub4dc\uc774\ub2e4. \uc6d0\ub798\ub294 \ub514\ubc84\uae45\uc774\ub098 \ud3ec\ub80c\uc2dd \uc6a9\ub3c4\ub85c \uc2dc\uc2a4\ud15c RAM\uc744 \uace0\uc18d\uc73c\ub85c \uc77d\uac70\ub098 \uc4f8 \ub54c \uc4f0\uc774\ub294\ub370, \uce58\ud130\ub4e4\uc740 \uc774 \ub2a5\ub825\uc744 \uc774\uc6a9\ud574 CPU, OS, \uc548\ud2f0\uce58\ud2b8\uac00 \ubaa8\ub974\ub294 \uc0ac\uc774\uc5d0 \uac8c\uc784 \ud504\ub85c\uc138\uc2a4\uc758 \uba54\ubaa8\ub9ac\ub97c \uadf8\ub300\ub85c \ud6d1\uc5b4\ubcf8\ub2e4.</p> <p>\uc548\ud2f0\uce58\ud2b8\uc758 \ub300\uc751 -&gt; \uac8c\uc784 \ucabd\uc5d0\ub294 \uc18c\ud504\ud2b8\uc6e8\uc5b4\ub098 \ub4dc\ub77c\uc774\ubc84\uc870\ucc28 \uc124\uce58\ub418\uc9c0 \uc54a\uc73c\ubbc0\ub85c \uc804\ud1b5\uc801 \ud504\ub85c\uc138\uc2a4 \uac80\uc0ac\uac00 \ud1b5\ud558\uc9c0 \uc54a\ub294\ub2e4. \uc774\ub97c \ub300\uc751\ud558\uae30 \uc704\ud574 PCle \uc2ac\ub86f\uc744 \ub364\ud504\ud558\uc5ec \uc218\uc0c1\ud55c VID\ub97c block\ud55c\ub2e4. \ub610\ub294 IOMMU\ub97c \ucf1c\uc11c \uba54\ubaa8\ub9ac \ub9f5 \uc811\uadfc\ud558\ub824\uba74 DMA Remapping \ud1b5\uacfc\ub97c \ud558\ub3c4\ub85d \ud55c\ub2e4. \ub610\ub294 \uc11c\ubc84 \ud589\ub3d9\uc744 \ubd84\uc11d\ud558\uac70\ub098, PCI config \uacf5\uac04\uc758 ROM \ud574\uc2dc\ub97c \ube44\uad50\ud574 \ud38c\uc6e8\uc5b4\ub97c \uac80\uc0ac\ud55c\ub2e4.</p>"},{"location":"2-cheats/#-","title":"&gt; \ud654\uba74 \uc815\ubcf4 \uac00\uc838\uc624\uae30 - \ucea1\ucc98 \uce74\ub4dc","text":"<p>\ucea1\ucc98 \uce74\ub4dc\uac00 \ubb50\ub0d0? \ud654\uba74\uc744 \uce74\uba54\ub77c \ud53c\ub4dc\ucc98\ub7fc \ubf51\uc544\uc624\uae30. \uc6d0\ub798\ub294 PC\uc758 HDMI \ucd9c\ub825\uc744 \ubc1b\uc544 USB 3.0 \ub4f1\uc73c\ub85c \ub450\ubc88\uc9f8 PC\uc5d0 \ubcf4\ub0b4\uace0, OBS \uac19\uc740 \uc2a4\ud2b8\ub9ac\uba38 \uc571\uc774 \uc778\ucf54\ub529, \uc1a1\ucd9c\ud55c\ub2e4. \uc774\ub97c \uc774\uc6a9\ud574 AI \uc5d0\uc784\ubd07\uc5d0\uc11c\ub294 \uce58\ud2b8 PC\uc5d0 \ubcf4\ub0b4 YOLO-v8/ViT \ub4f1\uc73c\ub85c \uc801 \uc2e4\ub8e8\uc5e3, \uba38\ub9ac \uc704\uce58\ub97c \ucd94\uc801\ud55c\ub2e4. \uadf8\ub798\uc11c \uacb0\uacfc \uc88c\ud45c\ub97c Cronus Zen, KMBox \uac19\uc740 \uc785\ub825 \uc7a5\uce58\ub85c \ubcc0\ud658\ud574 \uc5ed\uc8fc\uc785 \ud558\ub294 \uac83\uc774\ub2e4.</p>"},{"location":"2-cheats/#-yolo-v8-vit","title":"&gt; \ud654\uba74 \uc815\ubcf4 \ud30c\uc2f1\ud558\uae30 - YOLO-v8 / ViT","text":"<p>\uc801 \uc2e4\ub8e8\uc5e3, \uba38\ub9ac \uc704\uce58\ub97c \ucd94\uc801\ud55c\ub2e4.</p>"},{"location":"2-cheats/#-hid-cronus-zen-xim","title":"&gt; \uac12 \uc8fc\uc785\ud558\uae30 - HID Cronus Zen / XIM","text":"<p>HID\uac00 \ubb50\ub0d0? Human Interface Device. \uc785\ub825\uc774\uba74 \ub2e4 \uc5ec\uae30\ub85c \ud1b5\uc77c. \ud0a4\ubcf4\ub4dc \ub9c8\uc6b0\uc2a4 \uac8c\uc784\ud328\ub4dc \ud130\uce58\ud328\ub4dc \uc804\ubd80. \uc6b4\uc601\uccb4\uc81c\ub294 VID(\uc81c\uc870\uc0ac)/PID(\uc81c\ud488) \uac12\ub9cc \ubcf4\uace0 \uc790\ub3d9\uc73c\ub85c \ubc94\uc6a9 \ub4dc\ub77c\uc774\ubc84\ub97c \ubd99\uc774\ubbc0\ub85c, Cronus Zen, KMBox \uac19\uc740 \uc7a5\uce58\uac00 \"\ub098\ub294 \ud3c9\ubc94\ud55c Xbox \ud328\ub4dc\ub2e4\"\ub77c\uace0\ub9cc \uc120\uc5b8\ud558\uba74 \uadf8\ub300\ub85c \ub3d9\uc791\ud55c\ub2e4. \uc548\ud2f0\uce58\ud2b8\uac00 \uc18c\ud504\ud2b8\uc6e8\uc5b4\uc801\uc73c\ub85c \uad6c\ubd84\ud558\uae30 \uc5b4\ub824\uc6b4 \uc774\uc720\uac00 \ubc14\ub85c \uc774 HID \uc704\uc7a5\uc131\uc774\ub2e4.</p> <p>\uc885\ub958\ub294 Cronus zen, XIM, Strike pack \ub4f1\uc774 \uc788\ub2e4.</p> <p>Cronus zen\uc774 \ubb50\ub0d0? \ucee8\ud2b8\ub864\ub7ec\uc5d0 \ub9e4\ud06c\ub85c\ub97c \uc2ec\ub294\ub2e4. USB \ub3d9\uae00 \ud615\ud0dc\ub85c, \ud55c\ucabd\uc740 \ud328\ub4dc, \ub2e4\ub978 \ucabd\uc740 \ucf58\uc194\uc5d0 \uc5f0\uacb0\ud55c\ub2e4. \uadf8\ub798\uc11c \uc785\ub825\uc744 \uc77d\uc5b4 \uc62c\ub9b0 \ub4a4, \ub0b4\ubd80 GPC \uc2a4\ud06c\ub9bd\ud2b8 \ub85c\uc9c1\uc744 \uc218\ud589\ud558\uc5ec \uc218\uc815\ub41c \uc785\ub825\uc744 \ub2e4\uc2dc \ud328\ub4dc\ucf58\uc194\ub85c \uc804\ub2ec\ud55c\ub2e4. OS\uc5d4 \uc21c\uc218 HID\ub85c \ubcf4\uc774\ubbc0\ub85c \ub4dc\ub77c\uc774\ube0c\ub098 \ub808\uc9c0\uc2a4\ud2b8\ub9ac \ud754\uc801\uc774 \uc5c6\ub2e4. 2025\ub144\ubd80\ud130 OW2\ub294 \ube44\uc778\uac00 VID/PID \uac10\uc9c0 \uc2dc PC \ud480 \uac15\uc81c \ub9e4\uce6d\uc744 \uc2dc\uc791\ud588\ub2e4.</p> <p>XIM\uc774 \ubb50\ub0d0? \uac01 \uac8c\uc784\uc758 \uc2a4\ud2f1 \ub9c8\uc6b0\uc2a4 \uace1\uc120\uc744 \ubd84\uc11d\ud574 \uac00\uc7a5 \uc790\uc5f0\uc2a4\ub7ec\uc6b4 \uc5d0\uc784\uc744 \uc81c\uacf5\ud55c\ub2e4.</p> <p>KMBox\ub294 DMA, AI \uc138\ud2b8\uc758 \ub85c\ubd07 \ud314\uc774\ub2e4. \uc791\uc740 FPGA/MCU \ubcf4\ub4dc\uc5d0 2\uac1c\uc758 USB(\uac8c\uc774\ubc0d PC\uc640 \uce58\ud2b8 PC)\ub85c \uad6c\uc131\ub418\uc5b4 \uc788\ub2e4. \uce58\ud2b8 PC\uac00 \uc5d0\uc784 \uac01\ub3c4 \ub4f1\uc744 \uacc4\uc0b0\ud558\uc5ec KMBox\ub85c \uba85\ub839\uc744 \uc804\uc1a1\ud558\uba74 \ubb3c\ub9ac HID \uc2e0\ud638(\uc815\uad50\ud55c \ub9c8\uc6b0\uc2a4 \ub378\ud0c0, \ud0a4 \uc785\ub825)\ub85c \ubc14\uafd4 \uac8c\uc774\ubc0d PC\uc5d0 \uc8fc\uc785\ud55c\ub2e4. \uc624\uc998\uc740 USB\uac00 \uc544\ub2c8\ub77c LAN \ud3ec\ud2b8\ub85c \ud558\uae30\ub3c4 \ud55c\ub2e4.</p>"},{"location":"2-cheats/#_5","title":"&gt; \uac00\uc0c1\uba38\uc2e0 \uc774\uc6a9 \ud575 \uc2dc\ub098\ub9ac\uc624","text":"<p>VMI (\uac00\uc0c1\ubc84\uc2e0 \uc778\ud2b8\ub85c\uc2a4\ud399\uc158) \uce58\ud2b8\ub77c\uace0 \ubd88\ub9b0\ub2e4.</p> <p>\ud558\uc774\ubc84\ubc14\uc774\uc800\uac00 \uac8c\uc2a4\ud2b8 VM \uc548\uc758 \uba54\ubaa8\ub9ac\ub97c \uc9c1\uc811 \uc5ff\ubcf4\uace0 \uac8c\uc784 \uc815\ubcf4\ub97c \ube7c\ub0b4\uac70\ub098 \uc870\uc791\ud558\ub294 \ubc29\uc2dd\uc774\ub2e4. \uce58\ud2b8 \ucf54\ub4dc\uac00 \uac8c\uc784 \ud504\ub85c\uc138\uc2a4 \uc548, \uc708\ub3c4\uc6b0 \ucee4\ub110 \uc548\uc5d0 \uc804\ud600 \uc874\uc7ac\ud558\uc9c0 \uc54a\ub294\ub2e4\ub294 \uc810\uc744 \uc774\uc6a9\ud574 \uc548\ud2f0\uce58\ud2b8\ub97c \uc6b0\ud68c\ud55c\ub2e4.</p> <p>host \ubb3c\ub9ac \uba38\uc2e0\uc5d0 KVM/XEN/Hyper-V \ub4f1 \ud558\uc774\ud37c\ubc14\uc774\uc800\uac00 \uc874\uc7ac\ud558\uace0, LibVMI\ub098 altp2m API\ub97c \ud1b5\ud574 \uac8c\uc2a4\ud2b8 RAM \ud398\uc774\uc9c0\ub97c \ub9e4\ud551\ud55c\ub2e4. \ub610\ud55c VMI Cheat \ud504\ub85c\uc138\uc2a4\ub97c \ub3cc\ub824 \uc6d4\ud575\uacfc trigger-bot \ub4f1\uc744 \uc791\ub3d9\uc2dc\ud0a8\ub2e4. Guest \uac00\uc0c1 \uba38\uc2e0\uc5d0\ub294 \uc77c\ubc18 \uc708\ub3c4\uc6b0\ub97c \uc124\uce58\ud558\uace0 \uac8c\uc784\uc774 \ub3cc\uc544\uac04\ub2e4. \ub530\ub77c\uc11c VMI \ub77c\uc774\ube0c\ub7ec\ub9ac\uac00 SLAT \ud14c\uc774\ube14\uc744 \ub530\ub77c\uac00\uc11c \uc6d0\ud558\ub294 \uac8c\uc2a4\ud2b8 \uac00\uc0c1\uc8fc\uc18c\ub97c \ud638\uc2a4\ud2b8 \ubb3c\ub9ac\uc8fc\uc18c\ub85c \ud55c\uc0b0\ud558\uc5ec \uba54\ubaa8\ub9ac\ub97c \ub364\ud504\uc2dc\ud0a4\uba74 \ub41c\ub2e4. \uadf8\ub798\uc11c \ud544\uc694\ud55c \uac12\uc744 \uc77d\uac70\ub098 \uc368\uc11c \uce58\ud2b8\ub97c \uc2e4\ud589\ud55c\ub2e4.</p> <p>\ubc29\uc2dd\uc740 \ud3f4\ub9c1\uacfc Page-guard \ubc29\uc2dd\uc774 \uc788\ub2e4. \ud3f4\ub9c1\uc740 \ucd08\ub2f9 60x \uba54\ubaa8\ub9ac \ube14\ub85d \uc77d\uc5b4 Radar / Wallhack \uc815\ubcf4\ub97c \ud68d\ub4dd\ud558\ub294 \uac83\uc774\ub2e4. page-guard \ubc29\uc2dd\uc740 \ud2b9\uc815 \uc88c\ud45c \uac12\uc774 \ubc14\ub00c\uba74 \ud2b8\ub9ac\uac70\ubd07\uc774 \ubc14\ub85c \ucd1d\uc744 \ubc1c\uc0ac\ud558\ub294 \uac83\uc774\ub2e4. \uadf8\ub9ac\uace0 OVerlay \uc2a4\ub808\ub4dc\uac00 OpenGL \uc708\ub3c4\uc6b0\uc5d0 \uc6d4\ud575 \uc2a4\ucf08\ub808\ud1a4\uc744 \ub80c\ub354\ub9c1\ud558\uace0, \uc785\ub825 \uc2a4\ub808\ub4dc\ub294 KMBox\ub97c \ud1b5\ud574 \ub9c8\uc6b0\uc2a4 \u0394 \uac12\uc744 \uc804\uc1a1\ud55c\ub2e4.</p> <p>\ud074\ub77c\uc6b0\ub4dc\ud615\uc73c\ub85c \uce58\ud2b8 \uc11c\ube44\uc2a4\ub3c4 \uac00\ub2a5\ud558\ub2e4. AWS m6a \uc778\uc2a4\ud134\uc2a4\uc5d0\uc11c\ub3c4 \uc131\uacf5 \uc0ac\ub840 \ubcf4\uace0.</p>"},{"location":"2-cheats/#vmi","title":"&gt; VMI \uce58\ud2b8\uc758 \uc548\ud2f0\uce58\ud2b8","text":"<p>\uc548\ud2f0\uce58\ud2b8\uc758 \ub300\uc751 -&gt; \uac00\uc0c1\ud654 \uc790\uccb4\ub97c \ube14\ub85c\ud0b9\ud55c\ub2e4. VM \ube44\ud2b8, Hyper-V \uc81c\uc5b4 \ub808\uc9c0\uc2a4\ud130 \uac80\uc0ac\ud558\uc5ec \ubabb\ud558\uac8c \ub9c9\ub294\ub2e4. \ud639\uc740 TPM-based Measurement\ub85c VM \ubb34\uacb0\uc131\uc744 \uac80\uc99d\ud558\uac70\ub098, \uc11c\uba85\ub418\uc9c0 \uc54a\uc740 Hyper-V \ub8e8\ud2b8\ud30c\ud2f0\uc158\uc744 \uac70\ubd80\ud55c\ub2e4. \uc544\ub2c8\uba74 EPT/PT \ub9ac\ub9f5 \ud638\ucd9c \ube48\ub3c4, LibVMI I/O \ud328\ud134\uc744 \ucee4\ub110 \ub4dc\ub77c\uc774\ubc84\uc5d0\uc11c \uce74\uc6b4\ud2b8\ud558\uc5ec \uc784\uacc4\uac12 \ucd08\uacfc\uc2dc \uc138\uc158\uc744 \ucc28\ub2e8\ud55c\ub2e4. \ub610, \ud638\uc2a4\ud2b8 AWS, Azure \ub124\ud2b8\uc6cc\ud06c \ub300\uc5ed\uc5d0\uc11c \uc0dd\uc131\ub41c \uc758\uc2ec \ub2e4\uc911 \uc138\uc158\uc744 \uc790\ub3d9 \ucd94\uc801\ud574 \uc815\uc9c0\uc2dc\ud0a8\ub2e4.</p>"},{"location":"2-cheats/#_6","title":"&gt; \ud575\uc2ec \ucc38\uace0 \uc790\ub8cc","text":"<p>VIC \ub17c\ubb38 - VMI \uae30\ubc18 \uc6d4\ud575\uacfc \ud2b8\ub9ac\uac70\ubd07\uc744 \uad6c\ud604\ud574 \ud0d0\uc9c0 \ubc29\uc9c0 \uc131\ub2a5\uc744 \uce21\uc815\ud55c\ub2e4. https://arxiv.org/pdf/2502.12322</p>"},{"location":"2-cheats/#_7","title":"&gt; \uc5f0\uad6c\uc6a9 \ucd5c\uc18c \uc7ac\ud604 \ud658\uacbd","text":"<p>VMI \uce58\ud2b8 Host OS : ubuntu 24.04 (5.15+\ucee4\ub110,KVM) \ud558\uc774\ud37c\ubc14\uc774\uc800 : qemu-kvm + intel VT-d/AMD-V (IOMMU on) GPU \ud328\uc2a4\uc2a4\ub8e8 : NVIDIA RTX 20xx \uc774\uc0c1 \ub610\ub294 AMD RDNA2 \uc774\uc0c1 VMI \ub77c\uc774\ube0c\ub7ec\ub9ac : LibVMI 0.14 + PyVMI, altp2m(Xen) \uc635\uc158 \ud544\uc694\uc2dc Xen 4.18 HID \ube0c\ub9ac\uc9c0 : KMBox(USB)\ub098 Zen\ub958\ub098 uinput+virtio-input \uc791\ub3d9 \ubc29\uc2dd : \ud3f4\ub9c1 read_pa() \ubc18\ubcf5\uc740 \uad6c\ud604\uc774 \uac04\ub2e8\ud558\uace0 \ud504\ub808\uc784 \uc601\ud5a5\uc774 \uc801\ub2e4. page-guard\ub294 \ud2b8\ub9ac\uac70\ubd07\uc5d0\ub294 \uc774\uc0c1\uc801\uc774\uc9c0\ub9cc VM \ud504\ub9ac\uc988 \uc704\ud5d8\uc774 \uc788\ub2e4. ESP \ud45c\uc2dc : host virtio-gpu 2nd head + PyOpenGL \ucc3d Trigger : host uinput \ub514\ubc14\uc774\uc2a4\uc5d0 BTN_LEFT down/up \uc4f0\uae30 \uc9c0\uc5f0 \uce21\uc815 : Guest PresentMon FPS \ub85c\uadf8 + Host time.time() \ube44\uad50</p> <p>\uc548\ud2f0\uce58\ud2b8 \uac00\uc0c1\ud654 \ud0d0\uc9c0 : CPUID bit, TSC \uc2ac\ub9bd, ACPI DMAR \ud14c\uc774\ube14 \ubcc0\uacbd \ud0d0\uc9c0 EPT \ud638\ucd9c \ud328\ud134 : KVM trace\ub85c EPT violation \ube48\ub3c4 \uce21\uc815\ud558\uc5ec ML\ub85c \ubd84\ub958 GPU \ud328\uc2a4\uc2a4\ub8e8 : PCI config vendor != 0x10DE &amp; passthru flag LibVMI \ud638\ucd9c : \uc790\uccb4 API, LibVMI symbol \uc81c\uac70 \ud6c4 \ube44\uad50</p>"},{"location":"2-cheats/#_8","title":"&gt; \uc124\uce58 \ubaa8\ub4c8","text":"<p>LibVMI - VMI\uc758 \ud45c\uc900 C \ub77c\uc774\ube0c\ub7ec\ub9ac. \uc5b8\uc5b4\ub294 C\ub85c, Xen, KVM/QEMU, VMwart, VirtualBox\ub97c \uc9c0\uc6d0\ud55c\ub2e4. VMI\uc5d0\uc11c \uac00\uc7a5 \ub110\ub9ac \uc4f0\uc774\ub294 \uc911\uac04 \uacc4\uce35 AIP\uc774\ub2e4.</p> <p>PyVMI - LibVMI\uc758 \ud30c\uc774\uc36c \ubc14\uc778\ub529 CFFI\ub85c LibVMI API\ub97c \uadf8\ub300\ub85c \ub178\ucd9c\ud55c thin wrapper. \ud30c\uc774\uc36c \ubc14\uc778\ub529\uc774\ub780 c\ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c python \uac1d\uccb4\uc640 \ud568\uc218\ub85c \uac10\uae50 \ubaa8\ub4c8\uc774\ub2e4.</p> <p>r2vmi - vmi \ub514\ubc84\uac70 \ud50c\ub7ec\uadf8\uc778 \ud558\uc774\ud37c\ubc14\uc774\uc800 \ub808\ubca8 \ub514\ubc84\uae45 \ub3c4\uad6c. radare2 \ucf58\uc194\uc5d0\uc11c r2 vmi://win10:PID \uc2dd\uc73c\ub85c vm \ub0b4\ubd80 \ud504\ub85c\uc138\uc2a4\ub97c \ubd84\uc11d \uac00\ub2a5.</p> <p>altp2m - alternate second-level page tables, \uc989 \ub2e4\uc911 EPT. Xen\uc5d0\uc11c \uc0ac\uc6a9\ud558\ub294 \uae30\uc220</p>"},{"location":"2-cheats/#_9","title":"&gt; \uba54\ubaa8\ub9ac \uc704\uce58 \ucc3e\uae30","text":"<p>\uce58\ud2b8 \uac1c\ubc1c\uc790\ub294 \uba3c\uc800 \uce58\ud2b8\uc5d0 \ud544\uc694\ud55c \uad6c\uc870\uccb4 \ubc0f \uc815\ubcf4\uac00 \uba54\ubaa8\ub9ac \uc5b4\ub514\uc5d0 \uc800\uc7a5\ub418\uc5b4 \uc788\ub294\uc9c0\ub97c \uc2dd\ubcc4\ud574\uc57c \ud55c\ub2e4. \uc774\ub7ec\ud55c \uc624\ud504\uc14b\uc744 \ucc3e\uae30 \uc704\ud55c \ucd5c\ucd08 \ubd84\uc11d \ub2e8\uacc4\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \ub3c4\uad6c\ub97c \ud1b5\ud574 \uc218\ud589\ub41c\ub2e4.</p> <p>\ub514\uc2a4\uc5b4\uc148\ube14\ub7ec : IDA, Ghidra \uba54\ubaa8\ub9ac \uc2a4\uce90\ub108 : Cheat Engine \ub364\ud37c \uac8c\uc784 \ud574\ud0b9 \ud3ec\ub7fc : MPGH, UnknwonCheats</p> <p>\uce58\ud2b8 \uac1c\ubc1c \ub3c4\uad6c - CheatEngine\uacfc ReClass CheatEngine\uc740 \ucd5c\uadfc DBVM\uc774\ub77c\ub294 Type-1 \ud558\uc774\ud37c\ubc14\uc774\uc800\ub97c \ub3c4\uc785\ud558\uc600\ub2e4. \ubd80\ud305 \uc2dc os\uc640 \ud568\uaed8 USB\ub85c \ub85c\ub4dc\ud574\uc57c\ud55c\ub2e4. \ud558\uc9c0\ub9cc \uc774\ub294 \uce58\ud2b8\uc640 \uac8c\uc784\uc774 \uac19\uc740 os\uc5d0\uc11c \uc791\ub3d9\ud574\uc57c \ud568\uc744 \uc758\ubbf8\ud55c\ub2e4. Type-2 \ud558\uc774\ud37c\ubc14\uc774\uc800\uac00 \ud6e8\uc52c \uc88b\uc740 \uad6c\uc870\uc774\ub2e4.</p>"},{"location":"2-cheats/#_10","title":"&gt; \uc704\uce58 \ucc3e\uc73c\uba74","text":"<p>step 1. \uba54\ubaa8\ub9ac \uc77d\uae30 LibVMI\ub294 \uac8c\uc2a4\ud2b8 VM\uc758 \ud398\uc774\uc9c0 \ud14c\uc774\ube14(SLAT:Second level address table)\uc5d0 \uc811\uadfc\ud55c\ub2e4. \uc774\ub294 EPT (Extended page table) \ub610\ub294 NPT (Nested Page Table)\uc744 \ud1b5\ud574 \uad6c\ud604\ub41c\ub2e4. \ub530\ub77c\uac00\uc11c \ud638\uc2a4\ud2b8 \ubb3c\ub9ac \uc8fc\uc18c\ub97c \ucc3e\uc544\ub0b4\uace0, \uadf8 \ud398\uc774\uc9c0\ub97c \uc77d\uc5b4\uc628\ub2e4. step 2. \uba54\ubaa8\ub9ac \uc4f0\uae30 \uc77d\uae30\uc640 \ub9c8\ucc2c\uac00\uc9c0\ub85c \uc704\uce58\ub97c \ucc3e\uc544 \uac1a\uc744 \ub36e\uc5b4\uc4f4\ub2e4 step 3. \ud398\uc774\uc9c0 \uac00\ub4dc \uc608\uc678 \ud2b9\uc815 \uba54\ubaa8\ub9ac \ud398\uc774\uc9c0\uc758 gfn(guest frame number) \ube44\ud2b8\ub97c \ubc14\uafd4 \ud398\uc774\uc9c0 \ud3f4\ud2b8\ub97c \uc720\ub3c4\ud558\uace0, \ucf5c\ubc31\uc744 \ub4f1\ub85d\ud55c\ub2e4. \uac12\uc774 \ubc14\ub014\ub54c\ub9cc \ucf5c\ubc31\uc774 \ubd88\ub824 \ud6a8\uc728\uc801\uc774\uba70, \ud2b8\ub9ac\uac70\ubd07\ucc98\ub7fc \uc774\ubca4\ud2b8 \uae30\ubc18 \uce58\ud2b8\uc5d0 \ucd5c\uc801. step 4. \uc785\ub825 \uc5d0\ubbac\ub808\uc774\uc158 qemu machine protocol\uc740 \uc18c\ucf13 \uae30\ubc18 json rpc. \ud638\uc2a4\ud2b8\uac00 \uac00\uc9dc \ub9c8\uc6b0\uc2a4 \uc774\ub3d9\uacfc \ud074\ub9ad\uc744 \ubcf4\ub0b4\uba74 \uac8c\uc2a4\ud2b8\ub294 \uc9c4\uc9dc HID \uc774\ubca4\ud2b8\ub85c \uc778\uc2dd\ud574 \uc548\ud2f0\uce58\ud2b8\uac00 \uad6c\ubd84 \ubd88\uac00. step 5. \uc624\ubc84\ub808\uc774 DirectX/OpenGL \ud6c5\uc744 \uc4f8 \ud544\uc694\ub3c4 \uc5c6\uc774 \ud638\uc2a4\ud2b8 OS\uc5d0\uc11c \ud22c\uba85 \ucc3d\uc744 \uc62c\ub824\ub193\ub294\ub2e4.</p>"},{"location":"2-cheats/#_11","title":"&gt; \uce58\ud2b8 \uc2a4\ub808\ub4dc \uad6c\ud604","text":"<p>\uba54\uc778 \uc2a4\ub808\ub4dc : \uac8c\uc784\uc5d0\uc11c \uc815\ubcf4\ub97c \uc77d\uc5b4\uc628\ub2e4 UI \uc2a4\ub808\ub4dc : \ud654\uba74\uc5d0 \ud544\uc694\ud55c \uc815\ubcf4\ub97c \ub80c\ub354\ub9c1\ud55c\ub2e4.</p> <p>\uba54\uc778\uc2a4\ub808\ub4dc\ub294 \ub450 \uac00\uc9c0 \ubc84\uc804\uc73c\ub85c \ub098\ub25c\ub2e4. \uc77c\uc815 \uc8fc\uae30\ub85c \uba54\ubaa8\ub9ac\ub97c \uc77d\ub294 \ubc29\uc2dd\uacfc, \ud398\uc774\uc9c0 \uac00\ub4dc \uc608\uc678\ub97c \ud65c\uc6a9\ud558\uc5ec \uc774\ubca4\ud2b8 \uae30\ubc18\uc73c\ub85c \ucf5c\ubc31\uc744 \uc2e4\ud589\ud558\ub294 \ubc29\uc2dd\uc774\ub2e4. \ub300\ubd80\ubd84\uc758 \uce58\ud2b8 \uad6c\ud604\uc5d0\uc11c \uc804\uc790\ub97c \uc0ac\uc6a9\ud558\uace0, \ud3ec\ud2b8\ub9ac\uc2a42\uc758 \ud2b8\ub9ac\uac70\ubd07\uc5d0\uc11c\ub9cc \ud6c4\uc790\ub97c \ucd94\uac00\ub85c \uc81c\uacf5\ud558\uc600\ub2e4.</p> <p>\uc54c\uace0\ub9ac\uc998 1 - \ud3f4\ub9c1 <pre><code>gameValues \u2190 Array[PlayerObject, PlayerObject, ...]\nuiThread \u2190 Thread(gameValues)             \u25b6 \ubc30\uc5f4 \ucc38\uc870\ub97c UI \uc2a4\ub808\ub4dc\uc5d0 \uc804\ub2ec\nuiThread.start()                          \u25b6 UI \uc2a4\ub808\ub4dc \uc2dc\uc791\n\nwhile gameIsRunning do\n    UpdateGameValues(gameValues)         \u25b6 \uba54\ubaa8\ub9ac \uac12 \uc5c5\ub370\uc774\ud2b8\n    Sleep(TimeInMilliseconds)            \u25b6 \uc77c\uc815 \uc2dc\uac04 \ub300\uae30\nend while\n</code></pre></p> <p>\uc54c\uace0\ub9ac\uc998 2 - \ud398\uc774\uc9c0 \uac00\ub4dc <pre><code>procedure CALLBACKA(newAddressValue)\n    JUMP()\nend procedure\n\nprocedure CALLBACKB(newAddressValue)\n    STARTSHOOTING()\nend procedure\n\nprocedure MAIN\n    addressList \u2190 Array[int, int]\n    registerException(addressList[0], CallbackA)\n    registerException(addressList[1], CallbackB)\n    ListenForExceptionEvents()\nend procedure\n</code></pre></p>"},{"location":"2-cheats/#_12","title":"&gt; \uc6d4\ud575","text":"<p>(1) \uac8c\uc784 \uba54\ubaa8\ub9ac\uc758 \ud2b9\uc815 \uc624\ud504\uc14b\uc744 \uc77d\uc5b4\uc11c \uac8c\uc784 \uc138\uacc4 \ub0b4\uc758 \ud50c\ub808\uc774\uc5b4 3D \uc88c\ud45c\ub97c \uc54c\uc544\ub0b4\uae30. (2) world space\ub85c \uac01 \ud56d\ubaa9\ub4e4\uc744 \ubc30\uce58\ud558\uae30. (3) 4x4 View matrix\ub97c \ud1b5\ud574 view space\ub85c \ubcc0\ud658. (4) Projection matrix\ub97c \ud1b5\ud574 2D \uc2a4\ud06c\ub9b0 \uc88c\ud45c\uacc4\ub85c \ubcc0\ud658\ud558\uae30.</p> <p>\uc774\uac78 World-to-Screen \ubcc0\ud658\uc774\ub77c\uace0 \ubd80\ub978\ub2e4.</p> <p>Or_X \u2212 Axis.x  Or_Y \u2212 Axis.x  Or_Z \u2212 Axis.x  T.x Or_X \u2212 Axis.y  Or_Y \u2212 Axis.y  Or_Z \u2212 Axis.y  T.y Or_X \u2212 Axis.z  Or_Y \u2212 Axis.z  Or_Z \u2212 Axis.z  T.z 0               0                 0           1 \uc0c8\ub85c\uc6b4 \uacf5\uac04\uc5d0\uc11c\uc758 x\ucd95 \ubc29\ud5a5 y\ucd95 \ubc29\ud5a5     z\ucd95 \ubc29\ud5a5   \uac1d\uccb4\uc758 \uc704\uce58</p>"},{"location":"2-cheats/#_13","title":"&gt; \ud2b8\ub9ac\uac70\ubd07","text":"<p>(1) \ub85c\uceec \ud50c\ub808\uc774\uc5b4\uac00 \uc801 \uc544\ubc14\ud0c0\ub97c \uc870\uc900\ud558\uace0 \uc788\ub294\uc9c0 \uc2dd\ubcc4 (2) \uc5b8\uc81c \uc0ac\uaca9\uc744 \uc2dc\uc791\ud558\uac70\ub098 \uba48\ucdb0\uc57c \ud558\ub294\uc9c0\ub97c \ub85c\uceec \ud50c\ub808\uc774\uc5b4\uc5d0\uac8c \uc804\ub2ec</p> <p>\uc2dd\ubcc4\uc740 \ub458 \uc911 \ud558\ub098\uc758 \ubc29\uc2dd\uc744 \uc0ac\uc6a9\ud55c\ub2e4. \uac8c\uc784 \uba54\ubaa8\ub9ac\uc5d0\uc11c \uc870\uc900\uc120\uc758 \uacb0\uacfc\ub97c \uc800\uc7a5\ud558\ub294 \uc8fc\uc18c\ub97c \ucc3e\uc544 \uc77d\uae30, \ub610\ub294 \uc801 \uc544\ubc14\ud0c0\uc758 \uc2a4\ud06c\ub9b0 \uc704\uce58\uc640 \uc870\uc900\uc120\uc758 \uc704\uce58\ub97c \ube44\uad50\ud558\uae30.</p> <p>\uc0ac\uaca9 \uacb0\uc815\uc740 \ub458 \uc911 \ud558\ub098\uc758 \ubc29\uc2dd\uc744 \uc0ac\uc6a9\ud55c\ub2e4. \uac8c\uc784 \ud504\ub85c\uc138\uc2a4\ub97c \uc2a4\uce94\ud558\uc5ec \uc0ac\uaca9 \uc0c1\ud0dc\ub97c \uc81c\uc5b4\ud558\ub294 \uba54\ubaa8\ub9ac \uc8fc\uc18c\ub97c \ucc3e\uc544 \uc6d0\ud560 \ub54c write, \ub610\ub294 QMP \uac19\uc740 \uc6d0\uaca9 \uc778\ud130\ud398\uc774\uc2a4\ub97c \uc0ac\uc6a9\ud574 \uc785\ub825 \uc7a5\uce58\ub97c \uc5d0\ubbac\ub808\uc774\uc158 \uc804\ub2ec.</p>"},{"location":"20-drakvuf-microtrace/","title":"20 drakvuf microtrace","text":""},{"location":"20-drakvuf-microtrace/#drakvuf","title":"drakvuf\ub85c \ub9c8\uc774\ud06c\ub85c\ud2b8\ub808\uc774\uc2a4\ub97c \uc2dc\ub3c4\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-27</p>"},{"location":"20-drakvuf-microtrace/#_1","title":"\ub9cc\ub4e4 \ucf54\ub4dc","text":"<p>CE\ub85c \uac12\uc744 \ubcc0\ud654\uc2dc\ucf1c\uac00\uba70 \ud655\uc2e4\ud55c \uc2dc\ub4dc 10\uac1c \ud655\ubcf4 va\ub97c pfn\uc73c\ub85c \ubc88\uc5ed\ud574\uc11c \uc0ac\uc6a9 \ud574\ub2f9 \ud398\uc774\uc9c0\uc5d0 pfn writewatch\ub97c \uac74 \uc0c1\ud0dc\uc5d0\uc11c \uac12\uc744 \ubcc0\ud654\uc2dc\ucf1c \uc774\ubca4\ud2b8\uac00 \ucc0d\ud788\ub294\uc9c0 \ud655\uc778 store \ubd80\ud130 \ub2e4\uc74c store\uae4c\uc9c0\uc758 \uba85\ub839\uc5b4 \uc815\ubcf4\ub97c \ub2e4 \ub9c8\uc774\ud06c\ub85c \ud2b8\ub808\uc774\uc2a4 \uac8c\uc784 exe\uac00 \uba85\ub839\ub0b4\ub9b0 rip\ub9cc \ud544\ud130\ub9c1 mov [RAX+disp], reg/imm \uc774\uac8c store \uba85\ub839\uc5b4\uc778\ub370 RAX(\ubca0\uc774\uc2a4) \uacc4\uc0b0\ud558\ub294 \ube14\ub85d\uc758 \uc2dc\uc791 \uc8fc\uc18c\uac00 \ubcf5\ud638\ud654 \ub8e8\ud2f4 \ud6c4\ubcf4 .rdata\uc758 16\ubc14\uc774\ud2b8 \uc154\ud50c \ub9c8\uc2a4\ud06c/\uacf1\uc148 \uc0c1\uc218 XREF\ub85c \uad50\ucc28\ud655\uc778, \ucc38\uc870 \ud568\uc218 \ubaa9\ub85d\uc774\ub791 \ub300\uc870\ud574 \ubcf5\ud638\ud654\u2192\uc8fc\uc18c\uacc4\uc0b0\u2192store \ud328\ud134\ucc3e\uae30 \ubcf5\ud638\ud654 \ud568\uc218 \uc9c4\uc785/\ub9ac\ud134\uc744 \uc7a1\ub294 \ucee4\uc2a4\ud140 \ud50c\ub7ec\uadf8\uc778 \ucd94\uac00</p>"},{"location":"20-drakvuf-microtrace/#_2","title":"\ucf54\uc5b4 \uc218\uc815","text":"<p>\uc7ac\ube4c\ub4dc <pre><code>cd ~/drakvuf/src/libdrakvuf\ncode .\nlibdrakvuf.h\uc758 313\ubc88\uc9f8 \uc904(cplusplus \uc548\uc5d0 drakvuf_trap_info \uad6c\uc870\uccb4 \uc815\uc758 \ud6c4)\uc5d0\n// \ud30c\uc77c \uc0c1\ub2e8 \uadfc\ucc98 \uc801\uc808\ud55c \uacf3\uc5d0:\ntypedef event_response_t (*drakvuf_step_observer_t)(drakvuf_t, drakvuf_trap_info_t*);\n// \ub4f1\ub85d/\ud574\uc81c API (\uac04\ub2e8 \ubc84\uc804: \ub4f1\ub85d\ub9cc \uc81c\uacf5\ud574\ub3c4 \ucda9\ubd84)\nvoid drakvuf_register_step_observer(drakvuf_t, drakvuf_step_observer_t cb);\nprivate.h\uc758 258\ubc88\uc9f8 \uc904\uc5d0(struck drakvuf \ub0b4\ubd80)\nGSList* step_observers;  // list of drakvuf_step_observer_t\nvmi.c 143\ubc88\uc9f8 \uc904\uc5d0\n/* === \ucd94\uac00: \uc635\uc800\ubc84 \ube0c\ub85c\ub4dc\uce90\uc2a4\ud2b8 === */\nstatic inline event_response_t notify_step_observers(drakvuf_t d, drakvuf_trap_info_t* info)\n{\n    event_response_t resp = 0;\n    for (GSList* l = d-&gt;step_observers; l; l = l-&gt;next)\n    {\n        drakvuf_step_observer_t cb = (drakvuf_step_observer_t)l-&gt;data;\n        if (cb) resp |= cb(d, info);\n    }\n    return resp;\n}\n\n/* === \ucd94\uac00: \uacf5\uac1c \ub4f1\ub85d API \uad6c\ud604 === */\nvoid drakvuf_register_step_observer(drakvuf_t d, drakvuf_step_observer_t cb)\n{\n    if (!d || !cb) return;\n    d-&gt;step_observers = g_slist_prepend(d-&gt;step_observers, (gpointer)cb);\n}\n\n/* === \ucd94\uac00: \ubc18\ubcf5 \uc2f1\uae00\uc2a4\ud15d\uc6a9 \ucf5c\ubc31 ===\n   _post_mem_cb \uac00 \u201c\uacc4\uc18d \uc2a4\ud15d\u201d\uc774 \ud544\uc694\ud558\ub2e4\uace0 \ud310\ub2e8\ud558\uba74\n   step_event[v]-&gt;callback \uc744 \uc774 \ud568\uc218\ub85c \uc804\ud658\ud55c\ub2e4. */\nstatic event_response_t step_pump_cb(vmi_instance_t vmi, vmi_event_t* event)\n{\n    (void)vmi;\n    drakvuf_t drakvuf = (drakvuf_t)event-&gt;data;\n\n    drakvuf_trap_info_t info = {\n        .trap       = NULL,\n        .trap_pa    = 0,\n        .regs       = event-&gt;x86_regs,\n        .vcpu       = event-&gt;vcpu_id,\n        .timestamp  = g_get_real_time(),\n    };\n\n    /* \uac00\ub2a5\ud558\uba74 \ud604\uc7ac \ud504\ub85c\uc138\uc2a4 \ucee8\ud14d\uc2a4\ud2b8 \ucc44\uc6c0(\ud544\uc694 \uc5c6\uc73c\uba74 \ube48 \uac12\uc774\uc5b4\ub3c4 ok) */\n    memset(&amp;info.proc_data, 0, sizeof(info.proc_data));\n    memset(&amp;info.attached_proc_data, 0, sizeof(info.attached_proc_data));\n\n    event_response_t rsp = notify_step_observers(drakvuf, &amp;info);\n\n    /* altp2m view \ubcf5\uad6c */\n    uint16_t view = drakvuf-&gt;altp2m_idx;\n    if (drakvuf-&gt;enable_cr3_based_interception &amp;&amp; !drakvuf-&gt;vcpu_monitor[event-&gt;vcpu_id])\n        view = drakvuf-&gt;altp2m_idrx;\n    event-&gt;slat_id = view;\n\n    if (rsp &amp; VMI_EVENT_RESPONSE_TOGGLE_SINGLESTEP)\n    {\n        /* \ud55c \uc2a4\ud15d \ub354 \uc9c4\ud589 */\n        drakvuf-&gt;step_event[event-&gt;vcpu_id]-&gt;callback = step_pump_cb;\n        drakvuf-&gt;step_event[event-&gt;vcpu_id]-&gt;data     = drakvuf;\n        return rsp | VMI_EVENT_RESPONSE_SLAT_ID;\n    }\n    else\n    {\n        /* \uc2a4\ud15d \uc885\ub8cc: \ub9ac\uc14b \ucf5c\ubc31\uc73c\ub85c \uc804\ud658 + \uc2f1\uae00\uc2a4\ud15d \ub054 */\n        drakvuf-&gt;step_event[event-&gt;vcpu_id]-&gt;callback = vmi_reset_trap;\n        drakvuf-&gt;step_event[event-&gt;vcpu_id]-&gt;data     = drakvuf;\n        return rsp | VMI_EVENT_RESPONSE_TOGGLE_SINGLESTEP | VMI_EVENT_RESPONSE_SLAT_ID;\n    }\n}\n347\uc904\uc5d0 _post_mem_cb \uac08\uc544\ub07c\uae30\n/* ====== \uae30\uc874 \ucf54\ub4dc ====== */\n/* Here we are in singlestep mode already and this is a singlstep cb */\nstatic event_response_t _post_mem_cb(drakvuf_t drakvuf, vmi_event_t* event)\n{\n    event_response_t rsp = 0;\n    struct memcb_pass* pass = (struct memcb_pass*)event-&gt;data;\n\n    flush_vmi(drakvuf);\n\n    struct wrapper* s = (struct wrapper*)g_hash_table_lookup(drakvuf-&gt;memaccess_lookup_gfn, GSIZE_TO_POINTER(pass-&gt;gfn));\n    if (!s)\n    {\n        PRINT_DEBUG(\"Post mem cb @ 0x%lx has been cleared\\n\", pass-&gt;gfn);\n        goto done;\n    }\n\n    PRINT_DEBUG(\"Post mem cb @ 0x%lx vCPU %u altp2m %u\\n\", pass-&gt;pa, event-&gt;vcpu_id, event-&gt;slat_id);\n\n    vmi_pid_t pid = (drakvuf-&gt;os == VMI_OS_WINDOWS) ? pass-&gt;attached_proc_data.pid : pass-&gt;proc_data.pid;\n    if (!drakvuf_is_ignored_process(drakvuf, pid))\n    {\n        drakvuf-&gt;in_callback = 1;\n        GSList* loop = s-&gt;traps;\n        while (loop)\n        {\n            drakvuf_trap_t* trap = (drakvuf_trap_t*)loop-&gt;data;\n\n            if (trap-&gt;cb &amp;&amp; trap-&gt;memaccess.type == POST &amp;&amp;\n                (trap-&gt;memaccess.access &amp; pass-&gt;access))\n            {\n                drakvuf_trap_info_t trap_info =\n                {\n                    .trap       = trap,\n                    .trap_pa    = pass-&gt;pa,\n                    .regs       = event-&gt;x86_regs,\n                    .vcpu       = event-&gt;vcpu_id,\n                    .timestamp  = g_get_real_time(),\n                };\n                copy_proc_data_from_priv(&amp;trap_info.proc_data,          &amp;pass-&gt;proc_data);\n                copy_proc_data_from_priv(&amp;trap_info.attached_proc_data, &amp;pass-&gt;attached_proc_data);\n\n                rsp |= trap-&gt;cb(drakvuf, &amp;trap_info);\n            }\n\n            loop = loop-&gt;next;\n        }\n        drakvuf-&gt;in_callback = 0;\n    }\n\n    process_free_requests(drakvuf);\n\n    if ( pass-&gt;traps &amp;&amp; !refresh_shadow_copy(drakvuf-&gt;vmi, pass) )\n    {\n        fprintf(stderr, \"Failed to refresh shadow copy\\n\");\n        drakvuf-&gt;interrupted = 1;\n        goto done;\n    }\n\n    /* === \ucd94\uac00: store \uc9c1\ud6c4 \uccab \uc2a4\ud15d\uc5d0\uc11c \uc635\uc800\ubc84\uc5d0\uac8c RIP \uc1a1\uc2e0 === */\n    {\n        drakvuf_trap_info_t info_for_step = {\n            .trap       = NULL,\n            .trap_pa    = pass-&gt;pa,\n            .regs       = event-&gt;x86_regs,\n            .vcpu       = event-&gt;vcpu_id,\n            .timestamp  = g_get_real_time(),\n        };\n        copy_proc_data_from_priv(&amp;info_for_step.proc_data,          &amp;pass-&gt;proc_data);\n        copy_proc_data_from_priv(&amp;info_for_step.attached_proc_data, &amp;pass-&gt;attached_proc_data);\n\n        rsp |= notify_step_observers(drakvuf, &amp;info_for_step);\n    }\n\ndone:\n    free_proc_data_priv_2(&amp;pass-&gt;proc_data, &amp;pass-&gt;attached_proc_data);\n    g_slice_free(struct memcb_pass, pass);\n\n    uint16_t view = drakvuf-&gt;altp2m_idx;\n    if (drakvuf-&gt;enable_cr3_based_interception &amp;&amp; !drakvuf-&gt;vcpu_monitor[event-&gt;vcpu_id])\n        view = drakvuf-&gt;altp2m_idrx;\n    event-&gt;slat_id = view;\n\n    /* === \ubcc0\uacbd: \uc635\uc800\ubc84\uac00 \u201c\uacc4\uc18d \uc2a4\ud15d\u201d\uc744 \uc6d0\ud558\uba74 step_pump_cb\ub85c \uc804\ud658 === */\n    if (rsp &amp; VMI_EVENT_RESPONSE_TOGGLE_SINGLESTEP)\n    {\n        drakvuf-&gt;step_event[event-&gt;vcpu_id]-&gt;callback = step_pump_cb;\n        drakvuf-&gt;step_event[event-&gt;vcpu_id]-&gt;data     = drakvuf;\n        return rsp | VMI_EVENT_RESPONSE_SLAT_ID;\n    }\n    else\n    {\n        drakvuf-&gt;step_event[event-&gt;vcpu_id]-&gt;callback = vmi_reset_trap;\n        drakvuf-&gt;step_event[event-&gt;vcpu_id]-&gt;data     = drakvuf;\n        return rsp | VMI_EVENT_RESPONSE_TOGGLE_SINGLESTEP | VMI_EVENT_RESPONSE_SLAT_ID;\n    }\n}\n\uadf8\ub9ac\uace0 \uc544\ub798\uc5d0 \uc788\ub358 \n/*\n * This function gets called from the singlestep event\n * after an int3 or a read event happens.\n */\nstatic event_response_t vmi_reset_trap(vmi_instance_t vmi, vmi_event_t* event)\n{\n    UNUSED(vmi);\n    drakvuf_t drakvuf = (drakvuf_t)event-&gt;data;\n    uint16_t view = drakvuf-&gt;altp2m_idx;\n\n    if (drakvuf-&gt;enable_cr3_based_interception &amp;&amp; !drakvuf-&gt;vcpu_monitor[event-&gt;vcpu_id])\n        view = drakvuf-&gt;altp2m_idrx;\n\n    PRINT_DEBUG(\"reset trap on vCPU %u, switching altp2m %u-&gt;%u\\n\", event-&gt;vcpu_id, event-&gt;slat_id, view);\n    event-&gt;slat_id = view;\n\n    return VMI_EVENT_RESPONSE_TOGGLE_SINGLESTEP | // Turn off singlestep\n        VMI_EVENT_RESPONSE_SLAT_ID;\n}\n\uc774\uac78 \uc9c0\uae08 \ucd94\uac00\ud55c \uc560\ub4e4 \uc704\ub85c \uc62c\ub824\uc8fc\uae30\n$ cd ~/drakvuf\n$ meson setup build --reconfigure\n$ ninja -C build\n$ sudo ninja -C build install\n$ sudo ldconfig\n</code></pre></p>"},{"location":"20-drakvuf-microtrace/#micro_trace","title":"micro_trace","text":"<p>\ucee4\uc2a4\ud140 \ud50c\ub7ec\uadf8\uc778 \uc81c\uc791 <pre><code>$ cd ~/drakvuf/src/plugins\n$ mkdir micro_trace\n$ nano micro_trace/micro_trace.h\n$ nano micro_trace/micro_trace.cpp\n$ nano meson.build\nplugin_sources = [\n  # (\uae30\uc874\ub4e4)\n  'micro_trace/micro_trace.cpp',\n  'micro_trace/micro_trace.h',\n]\n$ nano plugins.h\n\ud50c\ub7ec\uadf8\uc778 \ub9ac\uc2a4\ud2b8 drakvuf_plugin_t \uc758 \ub9c8\uc9c0\ub9c9 __DRAKVUF_PLUGIN_LIST_MAX \uc55e\uc904\uc5d0\n    PLUGIN_MICRO_TRACE,\n\uc774\ub984 \ub9ac\uc2a4\ud2b8 static const char* drakvuf_plugin_names[] \uc5d0\n    [PLUGIN_MICRO_TRACE] = \"micro_trace\",\nos \uc9c0\uc6d0 \ub9ac\uc2a4\ud2b8 drakvuf_plugin_os_support \uc5d0\n    [PLUGIN_MICRO_TRACE] = { [VMI_OS_WINDOWS] = 1, [VMI_OS_LINUX] = 1 },\n$ nano plugins.cpp\n#include \"micro_trace/micro_trace.h\"\ndrakvuf_plugins::start \uc548\uc758 \ud070 switch\uc5d0 case \ucd94\uac00\ncase PLUGIN_MICRO_TRACE:\n{\n    this-&gt;plugins[plugin_id] = std::make_unique&lt;micro_trace&gt;(this-&gt;drakvuf, this-&gt;output);\n    break;\n}\n</code></pre></p> <p>\uc7ac\ube4c\ub4dc <pre><code>$ cd ~/drakvuf\n$ meson setup build --reconfigure\n$ ninja -C build\n$ sudo ninja -C build install\n$ sudo ldconfig\n</code></pre></p>"},{"location":"20-drakvuf-microtrace/#_3","title":"\uc2e4\ud589","text":"<p><pre><code>$ sudo vmi-process-list win10 | grep -i overwatch\n$ sudo env \\\n  MICROTRACE_PID=0 \\\n  MICROTRACE_VA_RANGES=\"0x2E9FCDCD000-0x2E9FCDCF000\" \\\n  MICROTRACE_STEP_MAX=100000 \\\n  MICROTRACE_MODE=both \\\n  MICROTRACE_DURATION_MS=10000 \\\n  MICROTRACE_PEEK=16 \\\n  MICROTRACE_MAXCHG=8 \\\n  drakvuf -r /root/symbols/ntkrnlmp.json -d 2 -a micro_trace -o json \\\n  | tee /home/kkongnyang2/watch_dump/logs/microtrace_wide.jsonl\n</code></pre> \uacb0\uacfc\uac00 \uacc4\uc18d \uc548\ub098\uc624\uace0 \ucf54\uc5b4 \uc218\uc815\ud558\uae30\uac00 \ub108\ubb34 \ud798\ub4e4\uc5b4\uc11c \ud3ec\uae30</p>"},{"location":"21-libvmi-microtrace/","title":"21 libvmi microtrace","text":""},{"location":"21-libvmi-microtrace/#libvmi","title":"libvmi\ub85c \ub9c8\uc774\ud06c\ub85c\ud2b8\ub808\uc774\uc2a4","text":"<p>Libvmi\uc5d0\uc11c \uac8c\uc2a4\ud2b8 \ud2b9\uc815 \ud504\ub85c\uc138\uc2a4 \ud2b9\uc815 \uc2dc\ub4dc\uc5d0 \uc5b4\ub5bb\uac8c \ub370\uc774\ud130\uac00 \uc801\ud788\ub294\uc9c0 \uc368\uc9c0\uae30\uae4c\uc9c0\uc758 \ud3ec\uc778\ud130 \ubcf5\ud638\ud654\ub97c \ud3ec\ud568\ud55c \uadfc\uc6d0 \uacfc\uc815\uc744 \ucc3e\uc544\ub0bc \uc218 \uc788\ub294 \ubc29\ubc95.</p>"},{"location":"21-libvmi-microtrace/#1","title":"\ub2e8\uacc4 1","text":"<p>write\ud558\uba74 \ub514\ubc84\uae45 \uba54\uc2dc\uc9c0</p> <p>sudo vmi-process-list win10 | grep -i overwatch</p> <p>gcc -O2 -Wall -Wextra -std=gnu11 seed_once_watch.c -o seed_once_watch \\   $(pkg-config --cflags libvmi glib-2.0) \\   $(pkg-config --libs   libvmi glib-2.0) \\   -Wl,--no-as-needed</p> <p>kkongnyang2@acer:~/project4$ sudo ./seed_once_watch win10 10472 0x233B65D8000-0x233B65D8FFF 5000 === seed_once_write_watch (PID-only, page-scoped) === [] domain=win10 pid=10472 range=[0x233b65d8000..0x233b65d8fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x202452000 [] Armed write-watch: pages=1 registered=1 range=[0x00000233b65d8000 .. 0x00000233b65d9000) [] Watch timeout (5005 ms) [] Done. (no write) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch win10 10472 0x233B65D8000-0x233B65D8FFF 5000 === seed_once_write_watch (PID-only, page-scoped) === [] domain=win10 pid=10472 range=[0x233b65d8000..0x233b65d8fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x202452000 [] Armed write-watch: pages=1 registered=1 range=[0x00000233b65d8000 .. 0x00000233b65d9000) [W] WRITE @0x233b65d8a78 vcpu=6 (seed) [] TRACE start (gfn=0x16d4bc view=0) [] Done. (seed write detected)</p>"},{"location":"21-libvmi-microtrace/#2","title":"\ub2e8\uacc4 2","text":"<p>\ud604 \uc0c1\ud0dc \ucea1\uccd0</p> <p>\ubb38\uc81c: \uc2a4\ub0c5\uc0f7\uc744 \ucea1\uccd0\ud558\ub294\ub370 \ud544\uc694\ud55c \uc560\ub4e4\uc774 \ub0b4 \ubc84\uc804\uc5d0\uc120 \ub2e4\ub978 \uacf3\uc5d0 \uc815\uc758\ub418\uc5b4 \uc788\uc74c \ud574\uacb0: #include  // \uc77c\ubd80 \ubc84\uc804\uc5d0\uc11c \ub808\uc9c0\uc2a4\ud130 enum\uc774 \uc5ec\uae30 \uc874\uc7ac // ---- libvmi register enum compatibility shim ---- #ifndef VMI_X86_RIP #define VMI_X86_RIP RIP #define VMI_X86_RSP RSP <p>\ubb38\uc81c: write\uac00 \ud0c0\uc774\ubc0d \uc774\uc288\ub85c \uad8c\ud55c\uc774 \uc7ac\uc870\uc815\ub418\uae30 \uc804\uc5d0 \uc7ac\ud2b8\ub7a9\ub418\uba70 \ub2e4\uc74c write\uac00 VMI_ERROR: Caught a memory event that had no handler registered in LibVMI @ GFN 0x16d4bc (0x16d4bca78), access: 6 \uac00 \ub728\uace0 \uac8c\uc2a4\ud2b8 \uba48\ucda4 \ud574\uacb0: \ucf5c\ubc31 \ubd80\ubd84\uc744 vmi_set_mem_event\ub85c \uad8c\ud55c \uc7ac\uc870\uc815\uc774 \uc544\ub2cc \uc989\uc2dc \ud2b8\ub7a9 \ud480\uc5b4\ubc84\ub9ac\uae30 static event_response_t on_seed_write(vmi_instance_t vmi, vmi_event_t *event){     const addr_t gla = event-&gt;mem_event.gla;     if(!(gla &gt;= G.va_lo &amp;&amp; gla &lt; G.va_hi)) return 0;</p> <pre><code>if(!G.triggered){\n    G.triggered = 1;\n\n    // 1) \uba3c\uc800 \uc774 GFN\uc758 W-\ud2b8\ub7a9\uc744 \uc989\uc2dc \ud574\uc81c (EPT \uad8c\ud55c \ubcf5\uad6c\ub97c \uc989\uc2dc \uc801\uc6a9)\n    vmi_set_mem_event(vmi, event-&gt;mem_event.gfn, VMI_MEMACCESS_N, 0);\n\n    // 2) \ub514\ubc84\uae45 \uba54\uc2dc\uc9c0 &amp; \uc2a4\ub0c5\uc0f7\n    fprintf(stderr,\n        \"[W] WRITE trap @0x%llx (vcpu=%u, gfn=0x%llx)\\n\",\n        (unsigned long long)gla, event-&gt;vcpu_id,\n        (unsigned long long)event-&gt;mem_event.gfn);\n\n    collect_and_print_snapshot(vmi, event);\n\n    // 3) \uc885\ub8cc \uc2e0\ud638 \u2014 \uba54\uc778\ub8e8\ud504\uc5d0\uc11c vmi_clear_event/vmi_destroy\n    g_stop = 1;\n}\nreturn 0; // \ubcc4\ub3c4 SET_ACCESS \ubc18\ud658\uac12 \ud544\uc694 \uc5c6\ub294 \ubc84\uc804\n</code></pre> <p>}</p> <p>kkongnyang2@acer:~/project4$ gcc -O2 -Wall -Wextra -std=gnu11 seed_once_watch_v2.c -o seed_once_watch_v2   $(pkg-config --cflags libvmi glib-2.0)   $(pkg-config --libs   libvmi glib-2.0)   -Wl,--no-as-needed kkongnyang2@acer:~/project4$ sudo vmi-process-list win10 | grep -i overwatch [12904] Overwatch.exe (struct addr:ffffc3030022a300) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v2 win10 12904 0x1A08E5A8000-0x1A08E5A8FFF 5000 === seed_once_watch_v2 === [] domain=win10 pid=12904 range=[0x1a08e5a8000..0x1a08e5a8fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x216a32000 [] Armed W-trap: pages=1 registered=1 range=[0x000001a08e5a8000 .. 0x000001a08e5a9000) [W] WRITE trap @0x1a08e5a8a78 (vcpu=7, gfn=0x162062) {\"evt\":\"seed_write_pre\",\"ts_us\":1760082248056611,\"vcpu\":7,\"pid\":12904,\"gla\":\"0x1a08e5a8a78\",\"gfn\":\"0x162062\",\"dtb\":\"0x216a32000\",\"cr3\":\"0x216a32000\",\"rip\":\"0x7ff7f89cbc1f\",\"rsp\":\"0x79958ff270\",\"rbp\":\"0x79958ff390\",\"rflags\":\"0x10206\",\"gpr\":{\"rax\":\"0x1a0c46c4601\",\"rbx\":\"0x1a08e5a8a78\",\"rcx\":\"0xf7\",\"rdx\":\"0x1a08e5a8a78\",\"rsi\":\"0x1a0c46c46a8\",\"rdi\":\"0x8\",\"r8\":\"0x79958ff310\",\"r9\":\"0x79958ff2d0\",\"r10\":\"0x79958ff2d8\",\"r11\":\"0x79958ff2f8\",\"r12\":\"0x19ed5600dc0\",\"r13\":\"0x19ed5604428\",\"r14\":\"0x19ed5603e20\",\"r15\":\"0x0\"},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e1296a3982060000808a5a8ea0010000\",\"post_len\":16,\"post_bytes\":\"fa00000000000000484e27b99e010000\",\"stack_len\":64,\"stack_bytes\":\"06000000000000001000b7909e010000a0e63ff0a00100001000b7909e0100000400000000000000a4c29cf8f77f000050000000000000007000000000000000\"} [] Done. (seed write trapped)</p>"},{"location":"21-libvmi-microtrace/#3","title":"\ub2e8\uacc4 3","text":"<p>\ubb34\uc5c7\uc774 \uc37c\ub0d0 (\uba85\ub839\uc5b4 \ub514\uc2a4\uc5b4\uc148\ube14)</p> <p>sudo apt-get install -y libcapstone-dev</p> <p>gcc -O2 -Wall -Wextra -std=gnu11 seed_once_watch_v3.c -o seed_once_watch_v3 \\   $(pkg-config --cflags libvmi glib-2.0) \\   $(pkg-config --libs   libvmi glib-2.0) \\   -lcapstone -Wl,--no-as-needed</p> <p>\ubb38\uc81c: \ub0b4 \ucea1\uc2a4\ud1a4 \ubc84\uc804\uc5d0\ub294 seed_once_watch_v3.c:155:62: error: \u2018X86_INS_REP_STOSD\u2019 undeclared (first use in this function); did you mean \u2018X86_INS_STOSD\u2019? 155 | case X86_INS_REP_STOSB: case X86_INS_REP_STOSW: case X86_INS_REP_STOSD: case X86_INS_REP_STOSQ: | ^~~~~~~~~~~~~~~~~ | X86_INS_STOSD \uc0ac\uc6a9\ud558\ub294 \uc6a9\uc5b4\uac00 \ub2e4\ub984. \ud574\uacb0: \uc218\uc815</p> <p>kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3 win10 12904 0x1A08E5A8000-0x1A08E5A8FFF 5000 === seed_once_watch_v3 === [] domain=win10 pid=12904 range=[0x1a08e5a8000..0x1a08e5a8fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x216a32000 [] Armed W-trap: pages=1 registered=1 range=[0x000001a08e5a8000 .. 0x000001a08e5a9000) [W] WRITE trap @0x1a08e5a8a78 (vcpu=1, gfn=0x162062) {\"evt\":\"seed_write_pre\",\"ts_us\":1760085770384536,\"vcpu\":1,\"pid\":12904,\"gla\":\"0x1a08e5a8a78\",\"gfn\":\"0x162062\",\"dtb\":\"0x216a32000\",\"cr3\":\"0x216a32000\",\"rip\":\"0x7ff7f89cbc1f\",\"rsp\":\"0x79959ff490\",\"rbp\":\"0x79959ff5b0\",\"rflags\":\"0x10206\",\"gpr\":{\"rax\":\"0x1a0c46c4601\",\"rbx\":\"0x1a08e5a8a78\",\"rcx\":\"0xf8\",\"rdx\":\"0x1a08e5a8a78\",\"rsi\":\"0x1a0c46c46a8\",\"rdi\":\"0x8\",\"r8\":\"0x79959ff530\",\"r9\":\"0x79959ff4f0\",\"r10\":\"0x79959ff4f8\",\"r11\":\"0x79959ff518\",\"r12\":\"0x19ed5600dc0\",\"r13\":\"0x19ed5604428\",\"r14\":\"0x19ed5603e20\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff7f89cbc1f\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1a08e5a8a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e1296a3982060000808a5a8ea0010000\",\"post_len\":16,\"post_bytes\":\"fa00000000000000484e27b99e010000\",\"stack_len\":64,\"stack_bytes\":\"18f69f9579000000b07d7af8f77f0000d84260d59e01000005cb9ff8f77f0000e84260d59e010000a4c29cf8f77f0000e01860d59e01000042b99ef8f77f0000\"} [] Done. (seed write trapped)</p> <p>\ud604\uc7ac RIP=0x7ff7f89cbc1f\uc758 \uba85\ub839\uc5b4\ub294 mov dword ptr [rdx], ecx. \u2192 \uc989, ECX(32\ube44\ud2b8) \uac12\uc744 [RDX] \uc8fc\uc18c\uc5d0 \uc800\uc7a5\ud558\ub294 \uc9c1\uc811 \uc800\uc7a5(store) \uba85\ub839\uc774\uc57c(\ubcf5\uc0ac/\uc2a4\ud2b8\ub9c1 \uc544\ub2d8).</p> <p>Capstone\uc774 \ud574\uc11d\ud55c EA(\uc720\ud6a8\uc8fc\uc18c) = [RDX], \uc6b0\ub9ac\uac00 \ud2b8\ub7a9\ud55c GLA\uc640 \uc644\uc804\ud788 \uc77c\uce58(ea_match:true). \uc989, RDX\uac00 \uac00\ub9ac\ud0a4\ub294 \uadf8 \uc8fc\uc18c\uac00 \uc774\ubc88 HP \uc2ac\ub86f.</p> <p>\ud53c\uc5f0\uc0b0\uc790 \uac12 \"rcx\":\"0xf8\",  \"rdx\":\"0x1a08e5a8a78\", \"rbx\":\"0x1a08e5a8a78\" (\ub3d9\uc77c \uc8fc\uc18c\ub97c RBX\ub3c4 \uac00\ub9ac\ud0b4) \uc774 \uc21c\uac04 ECX=0xF8 \u2192 \uc800\uc7a5\ub420 32\ube44\ud2b8 \uac12\uc740 0x000000F8 (\ub9ac\ud2c0\uc5d4\ub514\uc548\uc73c\ub85c \uba54\ubaa8\ub9ac\uc5d0 f8 00 00 00). RDX=0x\u2026a78 \u2192 \uc4f0\uae30 \ub300\uc0c1 \uc8fc\uc18c. \ud765\ubbf8\ub86d\uac8c\ub3c4 RBX\ub3c4 \uac19\uc740 \uc8fc\uc18c\ub97c \ub4e4\uace0 \uc788\uc74c(\ucef4\ud30c\uc77c\ub7ec\uac00 \ub450 \ub808\uc9c0\uc2a4\ud130\uc5d0 \uac19\uc740 \ud3ec\uc778\ud130\ub97c \ubcf4\uc874\ud55c \uc0c1\ud669\uc73c\ub85c \ubcf4\uc784). EA\ub294 RDX \uae30\ubc18\uc774\ubbc0\ub85c \uadfc\uc6d0 \ud3ec\uc778\ud130\ub294 RDX\uac00 \ub9de\uace0, RBX\ub294 \ubcf4\uc870/\uce90\uc2dc\uc77c \uac00\ub2a5\uc131.</p> <p>\ub9cc\uc57d RIP \ub514\uc2a4\uc5b4\uc148\ube14\uc774 store\uc774\ub2e4 -&gt; mov [base + indexscale + disp], src EA = base + indexscale + disp \ub97c \uacc4\uc0b0\ud574 GLA\uc640 \uc77c\uce58\ud558\ub294\uc9c0 \ud655\uc778\ud558\uc5ec \uc5b4\ub290 \ub808\uc9c0\uc2a4\ud130\uac00 \ud3ec\uc778\ud130\uc778\uc9c0 \ud655\uc815. src\uac00 \ubb54\uc9c0\ub97c \ubcf4\uace0 \uac12\uc758 \uadfc\uc6d0 \ud6c4\ubcf4 \uc881\ud788\uae30 \ub9cc\uc57d RIP \ub514\uc2a4\uc5b4\uc148\ube14\uc774 memcpy\uc774\ub2e4 -&gt; RSI/RCX/RDI (\uc6d0\ubcf8/\uce74\uc6b4\ud2b8/\ubaa9\uc801\uc9c0). \uc6d0\ubcf8\uc774 \uc5b4\ub514\uc11c \uc654\ub290\ub0d0 \ucc3e\uae30</p>"},{"location":"21-libvmi-microtrace/#3-1","title":"\ub2e8\uacc4 3-1","text":"<p>\ud574\ub2f9 \ubaa8\ub4c8 \ubca0\uc774\uc2a4\uc640 \uc624\ud504\uc14b \ucd94\uac00</p> <p>kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 12904 0x19EAC718000-0x19EAC718FFF 5000 === seed_once_watch_v3 === [] domain=win10 pid=12904 range=[0x19eac718000..0x19eac718fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x216a32000 [] Armed W-trap: pages=1 registered=1 range=[0x0000019eac718000 .. 0x0000019eac719000) [W] WRITE trap @0x19eac718a78 (vcpu=6, gfn=0x3f3592) {\"evt\":\"seed_write_pre\",\"ts_us\":1760099851372240,\"vcpu\":6,\"pid\":12904,\"gla\":\"0x19eac718a78\",\"gfn\":\"0x3f3592\",\"dtb\":\"0x216a32000\",\"cr3\":\"0x216a32000\",\"rip\":\"0x7ff7f89cbc1f\",\"rsp\":\"0x79957ff1f0\",\"rbp\":\"0x79957ff310\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff7f6960000\",\"rip_off\":\"0x206bc1f\"},\"gpr\":{\"rax\":\"0x1a0f6160101\",\"rbx\":\"0x19eac718a78\",\"rcx\":\"0xef\",\"rdx\":\"0x19eac718a78\",\"rsi\":\"0x1a0f61601f8\",\"rdi\":\"0x8\",\"r8\":\"0x79957ff290\",\"r9\":\"0x79957ff250\",\"r10\":\"0x79957ff258\",\"r11\":\"0x79957ff278\",\"r12\":\"0x19ed5600dc0\",\"r13\":\"0x19ed5604428\",\"r14\":\"0x19ed5603e20\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff7f89cbc1f\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x19eac718a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e129c6b17a060000808a71ac9e010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"78f37f9579000000b07d7af8f77f0000d84260d59e01000005cb9ff8f77f0000e84260d59e010000a4c29cf8f77f0000e01860d59e01000042b99ef8f77f0000\"} [] Done. (seed write trapped)</p> <p>\uc774\ub54c \ubaa8\ub4c8 \ubca0\uc774\uc2a4\ub294 overwatch.exe \uc989 0x7FF7F6960000\uc774\uace0 \uc774 \uc548\uc5d0\uc11c\ub3c4 ordinal \uc5ec\ub7ec\uac1c\uc640 NVSDK_NGX_D3D11_AllocateParameters \ub4f1\uc774 \uc788\ub294\ub370 \ud574\ub2f9 rip\uc740 ordinal \ub9c8\uc9c0\ub9c9 \uc988\uc74c\uc5d0 \uc18d\ud574\uc788\ub2e4. \uadf8\ub9ac\uace0 overwatch.exe \ub2e4\uc74c\uc5d0 \ub098\uc624\ub294 \ubaa8\ub4c8\uc740 ntdll.dll \uc989 0x7FF9BBEB0000\uc774\ub2e4.</p>"},{"location":"21-libvmi-microtrace/#4","title":"\ub2e8\uacc4 4","text":"<p>rdx\uc640 ecx\uac00 \uc5b4\ub514\uc11c \ub4f1\uc7a5\ud55c\uc9c0</p> <p>gcc -O2 -Wall -Wextra -std=gnu11 seed_once_watch_v4.c -o seed_once_watch_v4 \\   $(pkg-config --cflags libvmi glib-2.0) \\   $(pkg-config --libs   libvmi glib-2.0) \\   -lcapstone -Wl,--no-as-needed</p> <pre><code>    \uccab\ubc88\uc9f8          \ub450\ubc88\uc9f8              \uc138\ubc88\uc9f8             \ub124\ubc88\uc9f8            \ub2e4\uc12f\ubc88\uc9f8\n</code></pre> <p>rip:    cbc1f          cbc1f              cbc1f            cbc1f start:  cb91f          cb9af              cac1f            cac1f ctx:  cba42-cba71    cba42-cba71        cadab-cae74      cadab-cae74 rcx:    cb927          cba4a              null             null rdx:    cb922          cba2b              null             null \ubcc0\uacbd\uc810               \ub9c8\uc9c0\ub9c9 \uc815\uc758\ub85c \ubc14\uafb8\uae30   \uc708\ub3c4\uc6b0 \ubc94\uc704\ub113\ud788\uae30      rip\uc9c1\uc804\uc744\uc5f4\uc2ec\ud788\uc77d\uae30    \uc5ed\ubc29\ud5a5</p> <p>kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 3520  0x26F19038A78-0x26F19038A79 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=3520 range=[0x26f19038a78..0x26f19038a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x1f5ba8000 [] Armed W-trap: pages=1 registered=1 range=[0x0000026f19038000 .. 0x0000026f19039000) [W] WRITE trap @0x26f19038a78 (vcpu=7, gfn=0x7e29c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760582387458360,\"vcpu\":7,\"pid\":3520,\"gla\":\"0x26f19038a78\",\"gfn\":\"0x7e29c\",\"dtb\":\"0x1f5ba8000\",\"cr3\":\"0x1f5ba8000\",\"rip\":\"0x7ff74c264fef\",\"rsp\":\"0xcd059feeb0\",\"rbp\":\"0xcd059fefd0\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff74a1f0000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x26f388ef701\",\"rbx\":\"0x26f19038a78\",\"rcx\":\"0xe6\",\"rdx\":\"0x26f19038a78\",\"rsi\":\"0x26f388ef7b8\",\"rdi\":\"0x8\",\"r8\":\"0xcd059fef50\",\"r9\":\"0xcd059fef10\",\"r10\":\"0xcd059fef18\",\"r11\":\"0xcd059fef38\",\"r12\":\"0x26d69570dc0\",\"r13\":\"0x26d69574460\",\"r14\":\"0x26d69573e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff74c264fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x26f19038a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e1290e64bc090000808a03196f020000\",\"post_len\":16,\"post_bytes\":\"fa00000000000000b0b5cf4d6d020000\",\"stack_len\":64,\"stack_bytes\":\"0600000000000000100003206d020000b03fa7256f020000100003206d02000004000000000000007456264cf77f000050000000000000007000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff74c264e1a\",\"mn\":\"mov\",\"op\":\"ecx, dword ptr [rbx + 8]\",\"kind\":\"mov\"},\"rdx\":{\"addr\":\"0x7ff74c264dfb\",\"mn\":\"mov\",\"op\":\"edx, 0xc\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff74c264cef\",\"ctx\":[{\"a\":\"0x7ff74c264daa\",\"mn\":\"mov\",\"op\":\"rbx, qword ptr [rax]\"},{\"a\":\"0x7ff74c264dad\",\"mn\":\"call\",\"op\":\"0x7ff74c1efae0\"},{\"a\":\"0x7ff74c264db2\",\"mn\":\"mov\",\"op\":\"qword ptr [rbx], rax\"},{\"a\":\"0x7ff74c264db5\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff74c264db7\",\"mn\":\"mov\",\"op\":\"rbx, qword ptr [rsp + 0x30]\"},{\"a\":\"0x7ff74c264dbc\",\"mn\":\"add\",\"op\":\"rsp, 0x20\"},{\"a\":\"0x7ff74c264dc0\",\"mn\":\"pop\",\"op\":\"rdi\"},{\"a\":\"0x7ff74c264dc1\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff74c264dc2\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rsp + 0x50]\"},{\"a\":\"0x7ff74c264dc7\",\"mn\":\"mov\",\"op\":\"edx, 8\"},{\"a\":\"0x7ff74c264dcc\",\"mn\":\"mov\",\"op\":\"rcx, qword ptr [r10]\"},{\"a\":\"0x7ff74c264dcf\",\"mn\":\"mov\",\"op\":\"rbx, qword ptr [r9]\"},{\"a\":\"0x7ff74c264dd2\",\"mn\":\"mov\",\"op\":\"rdi, qword ptr [rax]\"},{\"a\":\"0x7ff74c264dd5\",\"mn\":\"lea\",\"op\":\"r8d, [rdx - 4]\"},{\"a\":\"0x7ff74c264dd9\",\"mn\":\"call\",\"op\":\"0x7ff74c1efbb0\"},{\"a\":\"0x7ff74c264dde\",\"mn\":\"movsd\",\"op\":\"xmm0, qword ptr [rbx]\"},{\"a\":\"0x7ff74c264de2\",\"mn\":\"movsd\",\"op\":\"qword ptr [rax], xmm0\"},{\"a\":\"0x7ff74c264de6\",\"mn\":\"mov\",\"op\":\"qword ptr [rdi], rax\"},{\"a\":\"0x7ff74c264de9\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff74c264deb\",\"mn\":\"mov\",\"op\":\"rbx, qword ptr [rsp + 0x30]\"},{\"a\":\"0x7ff74c264df0\",\"mn\":\"add\",\"op\":\"rsp, 0x20\"},{\"a\":\"0x7ff74c264df4\",\"mn\":\"pop\",\"op\":\"rdi\"},{\"a\":\"0x7ff74c264df5\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff74c264df6\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rsp + 0x50]\"},{\"a\":\"0x7ff74c264dfb\",\"mn\":\"mov\",\"op\":\"edx, 0xc\"},{\"a\":\"0x7ff74c264e00\",\"mn\":\"mov\",\"op\":\"rcx, qword ptr [r10]\"},{\"a\":\"0x7ff74c264e03\",\"mn\":\"mov\",\"op\":\"rbx, qword ptr [r9]\"},{\"a\":\"0x7ff74c264e06\",\"mn\":\"mov\",\"op\":\"rdi, qword ptr [rax]\"},{\"a\":\"0x7ff74c264e09\",\"mn\":\"lea\",\"op\":\"r8d, [rdx - 8]\"},{\"a\":\"0x7ff74c264e0d\",\"mn\":\"call\",\"op\":\"0x7ff74c1efbb0\"},{\"a\":\"0x7ff74c264e12\",\"mn\":\"movsd\",\"op\":\"xmm0, qword ptr [rbx]\"},{\"a\":\"0x7ff74c264e16\",\"mn\":\"movsd\",\"op\":\"qword ptr [rax], xmm0\"},{\"a\":\"0x7ff74c264e1a\",\"mn\":\"mov\",\"op\":\"ecx, dword ptr [rbx + 8]\"},{\"a\":\"0x7ff74c264e1d\",\"mn\":\"mov\",\"op\":\"dword ptr [rax + 8], ecx\"},{\"a\":\"0x7ff74c264e20\",\"mn\":\"mov\",\"op\":\"qword ptr [rdi], rax\"},{\"a\":\"0x7ff74c264e23\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff74c264e25\",\"mn\":\"mov\",\"op\":\"rbx, qword ptr [rsp + 0x30]\"},{\"a\":\"0x7ff74c264e2a\",\"mn\":\"add\",\"op\":\"rsp, 0x20\"},{\"a\":\"0x7ff74c264e2e\",\"mn\":\"pop\",\"op\":\"rdi\"},{\"a\":\"0x7ff74c264e2f\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff74c264e30\",\"mn\":\"mov\",\"op\":\"rbx, qword ptr [rsp + 0x30]\"},{\"a\":\"0x7ff74c264e35\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff74c264e37\",\"mn\":\"add\",\"op\":\"rsp, 0x20\"},{\"a\":\"0x7ff74c264e3b\",\"mn\":\"pop\",\"op\":\"rdi\"},{\"a\":\"0x7ff74c264e3c\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff74c264e3d\",\"mn\":\"nop\",\"op\":\"dword ptr [rax]\"},{\"a\":\"0x7ff74c264e40\",\"mn\":\"sub\",\"op\":\"byte ptr [rdi + rax + 2], cl\"},{\"a\":\"0x7ff74c264e44\",\"mn\":\"pop\",\"op\":\"rax\"}]},\"\":\"\"} [] Done. (seed write trapped)</p>"},{"location":"21-libvmi-microtrace/#_1","title":"21 libvmi microtrace","text":"<p>~/project-mem$ make clean ~/project-mem$ make ~/project-mem$ sudo ./libvmi_heap_write_tracer win10 3284 0x2355EE65000-0x2355EE65999 5000 20000 3000 trace.jsonl === libvmi_heap_write_tracer (PID-only, page-scoped) === [] domain=win10 pid=3284 range=[0x000002355ee65000 .. 0x000002355ee65999) watch_timeout_ms=5000 max_steps=20000 max_trace_ms=3000 out=trace.jsonl [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x2e6662000 [+] SINGLESTEP handler registered: cb=0x5bd68a48cdb0 [] Armed write-watch: pages=1 registered=1 range=[0x000002355ee65000 .. 0x000002355ee66000) [W] WRITE @0x2355ee65078 vcpu=0 (seed) [] TRACE start t0=1759338247448419 us (vcpu=0, gfn=0x82ed view=0) [] single-step ENABLED on vcpu=0 (mask=0x1) [!] re-arm W trap failed gfn=0x82ed view=0 [] TRACE stop by limit: steps=20000, elapsed_ms=457 [] single-step DISABLED on vcpu=0 VMI_ERROR: process_singlestep error: no singlestep handler is registered in LibVMI [] Done. Output: trace.jsonl \uacb0\uacfc\ub294 \ub2e4\uc74c\uacfc \uac19\uace0, trace.jsonl\ub3c4 \ucca8\ubd80\ud574\uc904\uac8c.</p>"},{"location":"21-libvmi-microtrace/#_2","title":"\uc790\uc8fc \ubc1c\uc0dd\ud558\ub294 \ubb38\uc81c","text":"<p>libvmi\uc5d0  Capstone\uc5d4 X86_REG_RFLAGS\uac00 \uc5c6\uace0 X86_REG_EFLAGS\uac00 \uc788\uc74c</p> <p>status_t vmi_init_complete(     vmi_instance_t *vmi,     const void *domain,     uint64_t init_flags,     vmi_init_data_t *init_data,     vmi_config_t config_mode,     void *config,     vmi_init_error_t *error); kkongnyang2@acer:~/project4$ grep -n \"vmi_read_va(\" /usr/local/include/libvmi/libvmi.h -n9 1407:status_t vmi_read_va( 1408-    vmi_instance_t vmi, 1409-    addr_t vaddr, 1410-    vmi_pid_t pid, 1411-    size_t count, 1412-    void *buf, 1413-    size_t *bytes_read 1414-) NOEXCEPT;</p> <p>kkongnyang2@acer:~/project4$ grep -n \"vmi_read(\"    /usr/local/include/libvmi/libvmi.h -n9 1244:status_t vmi_read( 1245-    vmi_instance_t vmi, 1246-    const access_context_t *ctx, 1247-    size_t count, 1248-    void *buf, 1249-    size_t *bytes_read) NOEXCEPT; status_t vmi_set_mem_event(     vmi_instance_t vmi,     addr_t gfn,     vmi_mem_access_t access,     uint16_t vmm_pagetable_id) NOEXCEPT;</p> <p>\ud504\ub85c\ud30c\uc77c\uc5d0\uc11c PsActiveProcessHead\ub97c offset\uc73c\ub85c \ucc3e\uc73c\ub824\ub2e4 \uc2e4\ud328. PsActiveProcessHead\ub294 \ucee4\ub110 \uc2ec\ubcfc(\uc8fc\uc18c)\uc774\uc9c0 \uad6c\uc870\uccb4 \uc624\ud504\uc14b\uc774 \uc544\ub2c8\uc5b4\uc11c vmi_giet_offset(\"PsActiveProcessHead\")\ub85c\ub294 \ubabb \uac00\uc838\uc624\ub294 \ud504\ub85c\ud30c\uc77c\uc774 \ub9ce\uc74c. vmi_translate_ksym2v(\"PsActiveProcessHead\")\ub85c \uc2ec\ubcfc \uc8fc\uc18c\ub97c \ud574\uc11d\ud574\uc57c \ud568.</p> <p>kkongnyang2@acer:~$ sudo vmi-win-guid name win10 Windows Kernel found @ 0x2c00000     Version: 64-bit Windows 10     PE GUID: 39b665671046000     PDB GUID: f388d1c459c2dc9e81f891d0760a56cd1     Kernel filename: ntkrnlmp.pdb     Multi-processor without PAE     Signature: 17744.     Machine: 34404.     # of sections: 33.     # of symbols: 0.     Timestamp: 968254823.     Characteristics: 34.     Optional header size: 240.     Optional header type: 0x20b     Section 1: .rdata     Section 2: .pdata     Section 3: .idata     Section 4: .edata     Section 5: PROTDATA</p>"},{"location":"22-main/","title":"22 main","text":""},{"location":"22-main/#esp","title":"esp","text":"<p>\ub124\ud2b8\uc6cc\ud06c \ubcf5\uc81c: \uc11c\ubc84\uac00 AOI(\uad00\uc2ec\uc601\uc5ed) \uc548\uc758 \uc5d4\ud2f0\ud2f0 \uc0c1\ud0dc(\uc704\uce58, \uccb4\ub825 \ub4f1)\ub97c \ub0b4\ub824\uc90c \u2192 \ud074\ub77c ECS\uc5d0 \ubc18\uc601.</p> <p>\uac00\uc2dc\uc131 \uc120\ubcc4(\ud074\ub77c): \ubdf0 \ud504\ub7ec\uc2a4\ud140 \uceec\ub9c1: \uce74\uba54\ub77c \uc2dc\uc57c \ubc16\uc774\uba74 \uc81c\uc678 \ud3ec\ud138/PVS/\ub8f8 \uc2dc\uc2a4\ud15c: \uac19\uc740 \uacf5\uac04\ub9cc \ub0a8\uae40(\uc788\ub294 \uac8c\uc784) \uc624\ud074\ub8e8\uc804 \uceec\ub9c1(Hi-Z/\ucffc\ub9ac): \ubcbd \ub4f1\uc73c\ub85c \uac00\ub824\uc9c4 \uac74 \uc81c\uc678 LOD/\uac70\ub9ac/\ud300 \uaddc\uce59\uc73c\ub85c \ucd94\uac00 \uc81c\uc678</p> <p>\ub4dc\ub85c\uc6b0 \ub9ac\uc2a4\ud2b8 \uc0dd\uc131: \uc704 \ud544\ud130\ub97c \ud1b5\uacfc\ud55c \uac83\ub9cc \ub4dc\ub85c\uc6b0\ucf5c \uc0dd\uc131 \u2192 GPU \ub80c\ub354\ub9c1 \u2192 \ubcf4\ud1b5 \uac00\ub824\uc9c4 \uc801\uc740 \u2018\ub17c\ub9ac \ub370\uc774\ud130\ub294 \uc5c5\ub370\uc774\ud2b8\ub418\uc9c0\ub9cc, \uba54\uc778 \ud328\uc2a4\uc5d4 \ub4dc\ub85c\uc6b0\ucf5c \uc790\uccb4\uac00 \uc5c6\uc74c\u2019\uc774 \uc815\uc11d.</p> <p>\ub530\ub77c\uc11c component\uc5d0 \uc788\ub294 \ubaa8\ub4e0 \uc801\uc758 \uc704\uce58 \uc815\ubcf4\ub97c \ubc14\ud0d5\uc73c\ub85c \ub0b4\uac00 \uc9c1\uc811 \ub80c\ub354\ub9c1\uc744 \ud574\uc918\uc57c\ud568.</p>"},{"location":"22-main/#_1","title":"\ud2b8\ub9ac\uac70\ubd07","text":"<p>\uc544\uc774\ub514\uc5b4: \ub85c\uceec \ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uac00\uc9c4 \uc801 \uc88c\ud45c/\ubcf8\uc744 \uc77d\uace0, \ub0b4 \uc2dc\uc57c \ubca1\ud130\u00b7FOV\uc640\uc758 \uac01\ub3c4/\uac70\ub9ac\uac00 \uc784\uacc4\uce58 \uc774\ud558\uba74 \ubc1c\uc0ac.</p>"},{"location":"22-main/#_2","title":"\ub0b4\uac00 \ucc3e\uc544\uc57c \ud560 \uc815\ubcf4","text":"<p>\uc77c\ub2e8 \uc804\uccb4 \ub7f0\ud0c0\uc784 \uba54\ubaa8\ub9ac \uad6c\uc870\ub97c \uc5b4\ub290\uc815\ub3c4 \ud30c\uc545. \ud5e4\ub4dc\uc778\uc9c0, \ubab8\uc0f7\uc778\uc9c0, \ubbf8\uc2a4\uc778\uc9c0\ub97c \ud310\ubcc4\ud558\ub294 \ubcc0\uc218\ub97c \ucc3e\uc544\uc11c \ud654\uba74\uc5d0 perfect/good/miss \ub744\uc5b4\uc8fc\uae30.</p> \ud328\ud134 \uad6c\uc870 \uc608\uc2dc \ud2b9\uc9d5 &amp; \ud78c\ud2b8 \u2460 Boolean \ud50c\ub798\uadf8 <code>c++ uint8_t bCrosshairOnEnemy; // 0/1</code> * \uac00\uc7a5 \ub2e8\uc21c\u00b7\ubcf4\ud3b8* \uac12\uc774 0\u21941\ub9cc \ubcc0\ud558\ubbc0\ub85c CE\uc5d0\uc11c\ub294 1 Byte, Exact value(0/1) \ud544\ud130\uac00 \uc720\ud6a8 \u2461 Enum/Bit-field <code>c++ uint8_t CrosshairState; // 0 none, 1 enemy, 2 ally, 3 object</code> * \ud300\u8b58\u5225\u00b7NPC \uad6c\ubd84\uc774 \ud544\uc694\ud55c \uac8c\uc784* \uc2a4\uce94 \uc2dc 0\u00b71\u00b72\ucc98\ub7fc \uc18c\uc218\uc758 \uc815\uc218\uac00 \ubc18\ubcf5 \u2462 Target \ud3ec\uc778\ud130 + \uac70\ub9ac <code>c++ struct HitInfo { void* pTarget; float fDist; }</code> * TPS/FPS\uc5d0\uc11c \u2018\uc0c1\ub300 \uac1d\uccb4\u2019 \uc815\ubcf4 \uc7ac\uc0ac\uc6a9* <code>pTarget!=NULL</code> \uc5ec\ubd80\ub9cc \ubd10\ub3c4 \uc870\uc900 \uc5ec\ubd80 \ud310\ub2e8 \uac00\ub2a5"},{"location":"22-main/#_3","title":"22 main","text":"<p>\uc560\uc26c 250 \ubc14\uc2a4 350(\uc8fc\ud669) \uce90\uc11c\ub514 275 \uc5d0\ucf54 225(\ud30c\ub791) \ud504\ub808\uc57c 225 \uac90\uc9c0 250 \ud55c\uc870 250</p>"},{"location":"3-display/","title":"3 display","text":""},{"location":"3-display/#_1","title":"\ub514\uc2a4\ud50c\ub808\uc774 \uacf5\ubd80","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-02</p>"},{"location":"3-display/#_2","title":"\uc624\ubc84\uc6cc\uce58 \ub514\uc2a4\ud50c\ub808\uc774 \uc774\ud574","text":"<p>[\ud638\uc2a4\ud2b8 Linux] \u2500\u2500(VFIO/PCIe \ud328\uc2a4\uc2a4\ub8e8)\u2500\u2500\u25ba [\uac8c\uc2a4\ud2b8 Windows]                                                \u2502                                                \u2502  \uacf5\uc2dd NVIDIA \ub4dc\ub77c\uc774\ubc84                                                \u2502  DX11 Feature Level OK                                                \u2502                                 Overwatch 2 \ub7f0\ucc98 + \uc548\ud2f0\uce58\ud2b8</p> <p>\uac00\uc0c1\uba38\uc2e0 \ud658\uacbd\uc774\ub77c\uba74 \uc7a5\uce58\ub97c \uc5d0\ubbac\ub808\uc774\uc158\ud558\uc9c0\ub9cc, \uc624\ubc84\uc6cc\uce58 2\uc5d0\uc11c\ub294 gpu \uc7a5\uce58\uc640 \ub4dc\ub77c\uc774\ubc84\uc758 ID\ub97c \uba85\ud655\ud788 \ud655\uc778\ud558\uba70 directX 11\ub9cc \ubc1b\uc544\ub4e4\uc774\uae30 \ub54c\ubb38\uc5d0 \uac8c\uc2a4\ud2b8\uc5d0 \ud328\uc2a4\uc2a4\ub8e8 \ud574\uc57c\ud55c\ub2e4. \ub9ac\ub205\uc2a4 \ucee4\ub110\uc774 \uc81c\uacf5\ud558\ub294 \ud328\uc2a4\uc2a4\ub8e8\uc6a9 \ud504\ub808\uc784\uc6cc\ud06c\uc778 VFIO-PCI\ub97c \uc774\uc6a9\ud574 PCIe \uc7a5\uce58\ub4e4\uc744 \uc548\uc804\ud558\uac8c \ub118\uae38 \uc218 \uc788\ub2e4.</p> <ul> <li>\ubca4\ub354 ID, DX Feature Level 11_0 \uc774\uc0c1 &amp; \uc11c\uba85\ub41c WDDM 2.x \uc870\uac74\ub3c4 \uac80\uc0ac</li> <li>Hyper-V/VBS OFF \ud574\uc57c\uc9c0 \ubabb\uc54c\uc544\ucc54</li> <li>VFIO-PCI\ub294 \uac19\uc740 IOMMU \uadf8\ub8f9\uc5d0 \ubb36\uc778 \uc7a5\uce58\ub294 \ud1b5\uc9f8\ub85c \ub118\uaca8\uc57c \ud568</li> <li>\ub2e4\ub978 \uac8c\uc784\uc740 \uc5d0\ubbac\ub808\uc774\uc158\uc778 virtio-gpu(VirGL)\ub9cc\uc73c\ub85c \ucda9\ubd84\ud558\uae30\ub3c4 \ud568</li> </ul>"},{"location":"3-display/#gpu","title":"gpu \uc0ac\uc6a9","text":"<p>\uadf8\ub7fc VM\uc740 \uc7a5\uce58\ub97c \uc5bc\ub9c8\ub098 \ub118\uaca8\uc8fc\ub0d0\uc5d0 \ub530\ub77c \ub2e4\ub974\uac8c \uad6c\uc131\ud55c\ub2e4. \uc5d0\ubbac\ub808\uc774\uc158(\uc9c4\uc9dc \ud558\ub4dc\uc6e8\uc5b4\uc778\ucc99 \ud749\ub0b4), \ud30c\ub77c\ubc84\ucd94\uc5bc(\uac00\uc9dc \uc7a5\uce58 \uc778\ud130\ud398\uc774\uc2a4 virtio \uc81c\uacf5), \ud328\uc2a4\uc2a4\ub8e8(\ud558\ub4dc\uc6e8\uc5b4 \uac74\ub0b4\uc8fc\uae30) \uc138\uac00\uc9c0 \ubc29\uc2dd\uc774 \uc788\ub2e4</p> <p>\uc804\uccb4 \ud328\uc2a4\uc2a4\ub8e8 \ubc29\uc2dd\uc774\uba74 (VFIO-PCI) CPU\ub3c4 \uadf8\ub300\ub85c \uc0ac\uc6a9(\uc77c\ubd80 trap\ub9cc \ub530\ub85c \ucc98\ub9ac), RAM\ub3c4 \ud560\ub2f9\ub41c \uc601\uc5ed\ub9cc\ud07c \uadf8\ub300\ub85c \uc0ac\uc6a9, GPU\ub3c4 \ub4dc\ub77c\uc774\ubc84\uae4c\uc9c0 \uc124\uce58\ud574\uc11c \uc9c1\uc811 \uc0ac\uc6a9. IOMMU \ucf1c\uace0 hostdev \ucd94\uac00 + VFIO \ubc14\uc778\ub529\uc744 \ud574\uc57c \uc2e4\uc81c GPU\uac00 \ub118\uc5b4\uac04\ub2e4</p> <p>\ubd84\ud560 \ud328\uc2a4\uc2a4\ub8e8 \ubc29\uc2dd\uc774\uba74 (GVT-g) GPU\ub97c \uc77c\ubd80 \ub118\uaca8\uc918\uc11c \uc5f0\uc0b0\uc740 \ud558\ub418 \ucd5c\uc885 \ud504\ub808\uc784\ubc84\ud37c\ub294 \ud638\uc2a4\ud2b8\uac00 \ud569\uc131.</p> <p>\ubc18\uac00\uc0c1\ud654 \ud30c\ub77c\ubc84\ucd94\uc5bc \ubc29\uc2dd\uc774\uba74 (Virtio-gpu) \uac00\uc9dc GPU\ub97c \ub9cc\ub4e4\uc5b4 \ud638\uc2a4\ud2b8\uac00 \uc218\uc2e0\ud574\uc640 \ub80c\ub354\ub9c1 \uc5f0\uc0b0\uacfc \ucd9c\ub825\uc744 \ub2f4\ub2f9</p> <p>VGA \uc5d0\ubbac\ub808\uc774\uc158 \ubc29\uc2dd\uc774\uba74 GPU \uc0ac\uc6a9 \uc5c6\uc774 \uc624\uc9c1 \uadf8 \uc704\uc5d0\uc11c \uc7a5\uce58\ub97c \uad6c\ud604\ud574\uc11c \uc9c4\uc9dc \uac00\uc0c1\uc73c\ub85c \uc5f0\uc0b0 \ucc98\ub9ac</p> <p>ramfb(RAM Framebuffer)\ub294 \uac8c\uc2a4\ud2b8 os\uac00 \uba54\ubaa8\ub9ac\uc5d0 \ud53d\uc140 \ub370\uc774\ud130\ub97c \uc4f0\uba74 \ud638\uc2a4\ud2b8\uac00 \uadf8 \uba54\ubaa8\ub9ac\ub97c \uc77d\uc5b4\uc640 \ud654\uba74\uc5d0 \uadf8\ub300\ub85c \ud45c\uc2dc\ud558\ub294 \ub9e4\ucee4\ub2c8\uc998(\ub80c\ub354\ub9c1x). UEFI(OVMF) \ubd80\ud305 \uc911\uc5d0 \uc0ac\uc6a9.</p>"},{"location":"3-display/#_3","title":"\uae30\ubcf8 \uadf8\ub798\ud53d \ucc98\ub9ac \ud750\ub984","text":"<p>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502                      \uc560\ud50c\ub9ac\ucf00\uc774\uc158\ub4e4                     \u2502 \u2502  App A  App B  App C ...                                \u2502 \u2502   \u2502      \u2502      \u2502                                       \u2502 \u2502   \u2502\ub80c\ub354\ub9c1 API \uc0ac\uc6a9 (OpenGL, Vulkan, Direct3D, Skia \ub4f1) \u2502 \u2502   \u25bc      \u25bc      \u25bc                                       \u2502 \u2502 [\uc708\ub3c4\uc6b0 \ubc84\ud37c A] [\uc708\ub3c4\uc6b0 \ubc84\ud37c B] [\uc708\ub3c4\uc6b0 \ubc84\ud37c C]         \u2502 \u2514\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502            \u2502            \u2502      \u25bc            \u25bc            \u25bc     \ubc84\ud37c \ud578\ub4e4 \uc804\ub2ec: X11 Pixmap, Wayland wl_buffer, Windows DWM Surface             \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510             \u2502      \ucef4\ud3ec\uc9c0\ud130(\ud569\uc131\uae30)        \u2502             \u2502  - \uc708\ub3c4\uc6b0 \uc2a4\ud0dd/\uc88c\ud45c           \u2502             \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                       \u25bc                   [GPU \uc5f0\uc0b0]                       \u2502                       \u25bc                    [\ubc31 \ubc84\ud37c]                       \u2502                       \u25bc                  \ub514\uc2a4\ud50c\ub808\uc774 \ucee8\ud2b8\ub864\ub7ec \u2192 \ubaa8\ub2c8\ud130</p> <p>\ub80c\ub354\ub9c1? \uc704\uce58 \ub370\uc774\ud130\ub97c transform\uacfc projection\ud558\uc5ec \ud654\uba74\uc5d0 \uadf8\ub798\ud53d\uc744 \uadf8\ub9bc \uba85\ub839 \uc0dd\uc131: \uc751\uc6a9 \ud504\ub85c\uadf8\ub7a8 \uba85\ub839 \ud574\uc11d: \ub80c\ub354\ub9c1 API + GPU \ub4dc\ub77c\uc774\ubc84 \uc2e4\uc81c \uc5f0\uc0b0: \ud558\ub4dc\uc6e8\uc5b4 GPU</p> <p>\ub80c\ub354\ub9c1 API? \ud654\uba74\uc5d0 3D/2D \uadf8\ub798\ud53d\uc744 \uadf8\ub9ac\ub294 \uc77c\uc744 \ub3c4\uc640\uc8fc\ub294 \uc57d\uc18d\ub41c \ud568\uc218 \uc9d1\ud569 \ub3c4\uad6c. drawTriagnles()\uac19\uc740 \uba85\ub839\uc73c\ub85c \uc2e4\uc81c\ub85c \uc0bc\uac01\ud615\uc744 \uadf8\ub9bc. \uc815\uc810 \ub370\uc774\ud130\ub97c GPU\ub85c \uc804\uc1a1, \uc870\uba85 \uacc4\uc0b0, \ud53d\uc140\uc5d0 \uc0c9\uc0c1 \uacb0\uc815, GPU\uc5d0 \ud544\uc694\ud55c \uba54\ubaa8\ub9ac \ud560\ub2f9, \ud504\ub808\uc784\ubc84\ud37c \uad00\ub9ac.</p> <p>GPU \ub4dc\ub77c\uc774\ubc84? \ub80c\ub354\ub9c1 API \uba85\ub839\uc744 GPU \ud558\ub4dc\uc6e8\uc5b4 \uba85\ub839\uc73c\ub85c \ubc88\uc5ed</p> <p>\ud569\uc131? \uc5ec\ub7ec \uc708\ub3c4\uc6b0 \ubc84\ud37c(\ubc30\uacbd, \ucc3d, \ud328\ub110 \ub4f1)\ub97c \ud558\ub098\uc758 \ucd5c\uc885 \ud654\uba74 \uc774\ubbf8\uc9c0\ub85c \uc870\ub9bd\ud558\uc5ec \ud654\uba74\uc5d0 \uc2e4\uc81c\ub85c \ubb50\uac00 \ubcf4\uc77c\uc9c0 \uacb0\uc815</p> <p>\ud504\ub808\uc784\ubc84\ud37c? \ub514\uc2a4\ud50c\ub808\uc774\ub85c \ubcf4\ub0bc \ucd5c\uc885 \ud569\uc131 \ud53d\uc140 \uba54\ubaa8\ub9ac. \ub514\uc2a4\ud50c\ub808\uc774 \ucee8\ud2b8\ub864\ub7ec\uac00 \uc77d\uc5b4\uac04\ub2e4. gpu \uc804\uc6a9 VRAM(video random access memory)\uc5d0 \uc788\uae30\ub3c4 \ud558\uace0, DRAM\uc758 \uc77c\ubd80\ub97c \ud504\ub808\uc784\ubc84\ud37c \uc6a9\ub3c4\ub85c \uc0ac\uc6a9\ud558\uae30\ub3c4 \ud55c\ub2e4. \uc5b4\uca0c\uac70\ub098 cpu\uac00 \uadf8 \ud53d\uc140\uc744 \ubcf5\uc0ac\ud558\ub824\ud558\uc9c0 \uc54a\uace0 \uc8fc\uc18c\ub098 \ub808\uc9c0\uc2a4\ud130\ub9cc \uc5c5\ub370\uc774\ud2b8\ud558\uba70 \ucc98\ub9ac\ud55c\ub2e4.</p> <p>\ubc31 \ubc84\ud37c/\ud504\ub7f0\ud2b8 \ubc84\ud37c? \uadf8\ub9b4 \ub54c \uc4f0\ub294 \uc784\uc2dc \ubc84\ud37c vs \ud604\uc7ac \ud654\uba74 \ud45c\uc2dc \uc911\uc778 \ubc84\ud37c\ub85c \uae5c\ube61\uc784\uc744 \ubc29\uc9c0</p> <p>\ud55c\uc904 \uc694\uc57d\ud558\uba74 \ub80c\ub354\ub9c1\uc744 \uc704\ud574 \uc751\uc6a9 \ud504\ub85c\uadf8\ub7a8\uc774 \ub9cc\ub4e0 \uba85\ub839\uc744 cpu\uac00 \uc900\ube44\ud558\uace0, GPU\uac00 \ub300\ub7c9 \ud53d\uc140 \uc5f0\uc0b0\uc744 \uc218\ud589\ud55c \ub4a4 \uacb0\uacfc\ub97c \uba54\ubaa8\ub9ac \uc0c1\uc758 \ud504\ub808\uc784\ubc84\ud37c\uc5d0 \uc4f4\ub2e4. \ub514\uc2a4\ud50c\ub808\uc774 \ud558\ub4dc\uc6e8\uc5b4\uac00 \uadf8 \ud504\ub808\uc784\ubc84\ud37c\ub97c \uc9c1\uc811 \uc77d\uc5b4 \ubaa8\ub2c8\ud130\uc5d0 \ub744\uc6b4\ub2e4.</p> <p>\uc624\ubc84\ub808\uc774(Overlay Plane)? \ud569\uc131 \uc5c6\uc774 \ud2b9\uc815 \ubc84\ud37c\ub97c \uc9c1\uc811 \ud654\uba74 \ud2b9\uc815 \uc601\uc5ed\uc5d0 \ud558\ub4dc\uc6e8\uc5b4\uc801\uc73c\ub85c \uc5b9\ub294 \uae30\ub2a5. \ube44\ub514\uc624 \uac19\uc740 \ud504\ub85c\uadf8\ub7a8\uc740 \ub108\ubb34 \uc790\uc8fc \ubc14\ub00c\uc5b4 \ud569\uc131\uc774 \ud798\ub4dc\ub2c8 \uc9c1\uc811 \ub514\uc2a4\ud50c\ub808\uc774 \ucee8\ud2b8\ub864\ub7ec\uc758 \uc624\ubc84\ub808\uc774 \ud50c\ub808\uc778\uc5d0 \ub9d0\uc744 \uac70\ub294 \uac83\uc774\ub2e4.</p> <pre><code>           \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n           \u2502 Display Controller    \u2502  \u2190 \ub514\uc2a4\ud50c\ub808\uc774 \ud558\ub4dc\uc6e8\uc5b4\n           \u2502 (scanout engine)      \u2502\n           \u2502                       \u2502\n           \u2502   Primary  Plane  \u2500\u2500\u2500\u2500\u2500\u2500\u2510  \ub370\uc2a4\ud06c\ud1b1 \ud569\uc131\ub41c \uc804\uccb4\ud654\uba74(RGB)\n           \u2502   Overlay  Plane  \u2500\u2500\u2510   \u2502  \ube44\ub514\uc624 YUV \ubc84\ud37c (HW \ubcc0\ud658)\n           \u2502   Cursor   Plane \u2500\u2510 \u2502   \u2502  \ud558\ub4dc\uc6e8\uc5b4 \ucee4\uc11c\n           \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2534\u2500\u2534\u2500\u2500\u2500\u2518\n                            \u2502\n                          HDMI/eDP/DP \u2192 \ubaa8\ub2c8\ud130\n</code></pre>"},{"location":"3-display/#dma","title":"DMA \uc7a5\uce58 \uc774\ud574","text":"<p>DMA? Direct Memory Access CPU\ub97c \uac70\uce58\uc9c0 \uc54a\uace0 \ub514\ubc14\uc774\uc2a4(SSD, GPU, NIC)\uac00 \uc8fc\uccb4\uac00 \ub418\uc5b4 \uc8fc \uba54\ubaa8\ub9ac\ub85c \uc9c1\uc811 \uc77d\uace0 \uc4f0\uae30. cpu\uac00 \uc544\ub2cc gpu\ub85c \uadf8\ub798\ud53d\uc744 \ucc98\ub9ac\ud558\ub294 \uac78 \uac00\uc18d\uc774\ub77c\uace0 \ubd80\ub978\ub2e4. \ub610\ud55c cpu\uc640\uc758 \uc804\uc6a9 \uace0\uc18d \ubc84\uc2a4\ub97c PCIe\ub77c\uace0 \ubd80\ub974\ub294\ub370, \uc774\ub97c \uac00\uc9c0\ub294 \uc7a5\uce58\ub294 gpu, \uc0ac\uc6b4\ub4dc\uce74\ub4dc \ub4f1\uc774 \uc788\ub2e4.</p> <p>IOMMU? I/O MMU \ub514\ubc14\uc774\uc2a4 \uc804\uc6a9 MMU.</p> <p>VT-d? Intel Virtualization Technology for Directed I/O intel CPU \uce69\uc14b\uc5d0 \ub0b4\uc7a5\ub41c IOMMU \uad6c\ud604 \ube0c\ub79c\ub4dc\uba85. AMD\ub294 AMD-VI\ub77c \ud45c\uae30. ACPI DMAR \ud14c\uc774\ube14\uc5d0 DRHD(\ud558\ub4dc\uc6e8\uc5b4 \uc720\ub2db)\u00b7RMRR(\uc608\uc57d \uba54\ubaa8\ub9ac)\u00b7ATSR \ub4f1\uc744 \uae30\ub85d. \ub9ac\ub205\uc2a4 intel_iommu (\uc635\uc158 intel_iommu=on), Windows vtd.sys\uc73c\ub85c \uc791\ub3d9.</p> <p>ACPI? Advanced configuration &amp; Power Interface UEFI-&gt;OS\ub85c \uac74\ub124\uc8fc\ub294 \ud558\ub4dc\uc6e8\uc5b4, IRQ, \uc804\uc6d0 \uad00\ub9ac \uc124\uba85\uc11c. \ud14c\uc774\ube14 \ud615\uc2dd\uc73c\ub85c \ub418\uc5b4 \uc788\ub2e4. RSDP(\ub8e8\ud2b8) \u2192 XSDT/RSDT\uac00 \uc5ec\ub7ec \ud558\uc704 \ud14c\uc774\ube14 \uc8fc\uc18c\ub97c \ub098\uc5f4. \u2022 \ub300\ud45c \ud14c\uc774\ube14: FADT(\uc804\uc6d0), MADT(APIC\u00b7CPU), DSDT(AML \ucf54\ub4dc), DMAR(IOMMU) \ub4f1</p> <p>DMAR? Direct Memory Access Remapping ACPI \uc18d Intel VT-d(IOMMU)\ub97c \ucd08\uae30\ud654\ud558\uae30 \uc704\ud55c \uc804\uc6a9 \ud14c\uc774\ube14 \uc774\ub984. DMAR \uc5d4\uc9c4\uc774 \uc5b4\ub514\uc5d0 \uba87 \uac1c\uac00 \ub2ec\ub824 \uc788\uc73c\uba70 \uc5b4\ub5a4 PCI \uc7a5\uce58\ub97c \ub9e1\ub294\uac00. \u2022 DRHD(DMA Remapping Hardware Unit)\uc740 IOMMU \ub808\uc9c0\uc2a4\ud130 \ubca0\uc774\uc2a4, \uad00\ub9ac \ubc84\uc2a4. \u2022 RMRR(Resserved Memory Region Reporting)\uc740 BIOS, iGPU, USB \ub808\uac70\uc2dc \ub4f1 \ud2b9\uc815 \uc7a5\uce58 \ubd80\ud305 \uc911 DMA \ud574\uc57c \ud558\ub294 \uc608\uc57d \uba54\ubaa8\ub9ac. \u2022 ATSR(Address-Translation Service Remap)</p>"},{"location":"4-igpu/","title":"4 igpu","text":""},{"location":"4-igpu/#igpu-vm","title":"igpu \ubd84\ud560 \ud328\uc2a4\uc2a4\ub8e8 vm\uc744 \ub9cc\ub4e4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-01</p>"},{"location":"4-igpu/#_1","title":"\uac00\uc0c1\ud654 \uc9c0\uc6d0 \ud655\uc778","text":"<p><pre><code># gpu \ud655\uc778\n~$ lspci | grep -i vga\n00:02.0 VGA compatible controller: Intel Corporation CometLake-U GT2 [UHD Graphics] (rev 02)\n# IOMMU \ud65c\uc131 \uc5ec\ubd80\n~$ sudo dmesg | grep -e IOMMU -e DMAR\n# DMAR \ud14c\uc774\ube14\uc740 intel \ud38c\uc6e8\uc5b4\uac00 \uc81c\uacf5\ud588\ub2e4\n[    0.023609] ACPI: DMAR 0x0000000084136000 0000A8 (v01 INTEL  EDK2     00000002      01000013)\n# DMAR \ud14c\uc774\ube14 \uc704\uce58\n[    0.023660] ACPI: Reserving DMAR table memory at [mem 0x84136000-0x841360a7]\n# IOMMU\uac00 39\ube44\ud2b8 \ubb3c\ub9ac \uc8fc\uc18c(512GB)\uae4c\uc9c0 \ubc88\uc5ed \uac00\ub2a5\n[    0.116940] DMAR: Host address width 39\n# DRHD(DMA-Remapping Hardware Unit) \ub450\uac1c\uac00 \uc874\uc7ac\n# flags 0x0 = \ubaa8\ub4e0 \ubc84\uc2a4 \ud3ec\ud568, flags 0x1 = \uc2a4\ucf54\ud504 \uc548 PCI \ub514\ubc14\uc774\uc2a4\ub9cc\n[    0.116942] DMAR: DRHD base: 0x000000fed90000 flags: 0x0\n[    0.116957] DMAR: dmar0: reg_base_addr fed90000 ver 1:0 cap 1c0000c40660462 ecap 19e2ff0505e\n[    0.116962] DMAR: DRHD base: 0x000000fed91000 flags: 0x1\n[    0.116968] DMAR: dmar1: reg_base_addr fed91000 ver 1:0 cap d2008c40660462 ecap f050da\n# RMRR(Reserved Memory Region Reporting)\ub85c \ud56d\uc0c1 \uc5f4\uc5b4\ub450\ub294 \uc601\uc5ed\n[    0.116971] DMAR: RMRR base: 0x00000084cb2000 end: 0x00000084efbfff\n[    0.116976] DMAR: RMRR base: 0x00000087000000 end: 0x000000897fffff\n# IRQ remapping \uae30\ub2a5 \ucf1c\uc9d0. Queued invlidation(TLB flush)\uae4c\uc9c0 \ud65c\uc131\n[    0.116979] DMAR-IR: IOAPIC id 2 under DRHD base  0xfed91000 IOMMU 1\n[    0.116982] DMAR-IR: HPET id 0 under DRHD base 0xfed91000\n[    0.116984] DMAR-IR: Queued invalidation will be enabled to support x2apic and Intr-remapping.\n[    0.119247] DMAR-IR: Enabled IRQ remapping in x2apic mode\n# \ucee4\ub110 \ud000\ud06c\uac00 iGPU(00:02.0)\uc744 IOMMU\uc5d0\uc11c \uac15\uc81c \uc81c\uc678. \ub530\ub77c\uc11c \uc774 IGD\ub97c VFIO-PCI\ub85c \ud1b5\uc9f8\ub85c \ud328\uc2a4\uc2a4\ub8e8 \ud558\ub294 \uacbd\ub85c\ub294 \ub9c9\ud798\n[    0.389107] pci 0000:00:02.0: DMAR: Disabling IOMMU for graphics on this chipset\n# ATSR(Address-Translation Service Remap)\uc640 SATC(System Agent Translation Cache) \uc5c6\uc74c. \uc0c1\uad00\uc5c6\uc74c\n[    0.513959] DMAR: No ATSR found\n[    0.513962] DMAR: No SATC found\n# \ub450 \ubc88\uc9f8 DRHD\ub3c4 queued invalidation \uc0ac\uc6a9\n[    0.513965] DMAR: dmar1: Using Queued invalidation\n# \ucd5c\uc885\uc801\uc73c\ub85c intel_iommu \ubaa8\ub4c8\uc774 \uc62c\ub77c\uac00\uba74\uc11c VT-d \ud65c\uc131 \uc644\ub8cc.\n[    0.516031] DMAR: Intel(R) Virtualization Technology for Directed I/O\n# GPU\uac00 vfio-pci\uc5d0 \ubb36\uc600\ub294\uc9c0\n~$ lspci -nnk | grep -A3 VGA\n# iGPU \ubca4\ub354, \ub514\ubc14\uc774\uc2a4 ID: 8086:9b41, \ub4dc\ub77c\uc774\ubc84: i915\n00:02.0 VGA compatible controller [0300]: Intel Corporation CometLake-U GT2 [UHD Graphics] [8086:9b41] (rev 02)\n    DeviceName: Onboard - Video\n    Subsystem: Samsung Electronics Co Ltd CometLake-U GT2 [UHD Graphics] [144d:c18a]\n    Kernel driver in use: i915\n</code></pre> \uc989, IOMMU(VT-d) \uc790\uccb4\ub294 \ud65c\uc131. irq remap, qi \uc9c0\uc6d0\uae4c\uc9c0 \uac16\ucdb0\uc838 \uc788\uc5b4 USB,NVMe \uce74\ub4dc \ub4f1\uc740 \ubc14\ub85c VFIO \ud328\uc2a4\uc2a4\ub8e8 \uac00\ub2a5. \ud558\uc9c0\ub9cc IGD(\ub0b4\uc7a5 GPU)\ub294 IOMMU\uc5d0\uc11c \uc81c\uc678. \ub530\ub77c\uc11c \ub0b4\uc7a5\uadf8\ub798\ud53d \uc7a5\uce58\ub97c \ucabc\uac1c\uc11c \uc4f0\ub294 GVT-g(vGPU) \ubc16\uc5d0 \ubd88\uac00\ub2a5. \ud480 VFIO \ud328\uc2a4\uc2a4\ub8e8(GVT-d)\ub97c \uc2dc\ub3c4\ud55c\ub2e4\uba74 \ub9c9\ud798.</p> <p>NVMe? SSD \uc804\uc6a9 \uace0\uc18d \ud1b5\uc2e0 \uaddc\uaca9 \ud504\ub85c\ud1a0\ucf5c. PCIe \uace0\uc18d\ubc84\uc2a4\uc640 \ud568\uaed8 SSD\ub97c \ubcf4\uc870.</p>"},{"location":"4-igpu/#_2","title":"\ucee4\ub110 \uc124\uc815","text":"<p>\uc804\uc81c \ud655\uc778 <pre><code>$ grep GVT /boot/config-$(uname -r)     # \ucee4\ub110\uc5d0 i915 GVT \ucf54\ub4dc \uc874\uc7ac \ud655\uc778\nCONFIG_DRM_I915_GVT_KVMGT=m\nCONFIG_DRM_I915_GVT=y\n</code></pre></p> <p>\ucee4\ub110 \uc124\uc815 <pre><code>$ sudo nano /etc/default/grub\n\uc6d0\ubcf8\nGRUB_DEFAULT=0\nGRUB_TIMEOUT_STYLE=hidden\nGRUB_TIMEOUT=10\nGRUB_DISTRIBUTOR=`lsb_release -i -s 2&gt; /dev/null || echo Debian`\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash\"\nGRUB_CMDLINE_LINUX=\"\"\n\n\uc218\uc815 \ud6c4\nGRUB_DEFAULT=0\nGRUB_TIMEOUT_STYLE=hidden\nGRUB_TIMEOUT=10\nGRUB_DISTRIBUTOR=`lsb_release -i -s 2&gt; /dev/null || echo Debian`\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash intel_iommu=on i915.enable_gvt=1 kvm.ignore_msrs=1 iommu=pt\"\nGRUB_CMDLINE_LINUX=\"\"\n\n$ sudo update-grub &amp;&amp; sudo reboot\n</code></pre></p>"},{"location":"4-igpu/#vgpu","title":"\ubaa8\ub4c8 \ubc0f vGPU \uc900\ube44","text":"<p>\ubaa8\ub4c8 \ud0a4\uae30 <pre><code>$ sudo modprobe kvmgt mdev vfio-iommu-type1 vfio-pci\n$ sudo dmesg | grep -i gvt              # \ub85c\uadf8 \ud655\uc778\n[    0.000000] Command line: BOOT_IMAGE=/boot/vmlinuz-6.8.0-60-generic root=UUID=f20a3184-37e9-471b-93ed-2832064a0619 ro quiet splash intel_iommu=on i915.enable_gvt=1 kvm.ignore_msrs=1 iommu=pt vt.handoff=7\n[    0.045888] Kernel command line: BOOT_IMAGE=/boot/vmlinuz-6.8.0-60-generic root=UUID=f20a3184-37e9-471b-93ed-2832064a0619 ro quiet splash intel_iommu=on i915.enable_gvt=1 kvm.ignore_msrs=1 iommu=pt vt.handoff=7\n[  462.136478] i915 0000:00:02.0: Direct firmware load for i915/gvt/vid_0x8086_did_0x9b41_rid_0x02.golden_hw_state failed with error -2\n$ ls /sys/bus/pci/devices/0000:00:02.0/mdev_supported_types     # \uc9c0\uc6d0 \ud0c0\uc785 \ud655\uc778\ni915-GVTg_V5_4  i915-GVTg_V5_8\n$ lsmod | grep kvmgt                    # \ubaa8\ub4c8 \ud655\uc778\nkvmgt                 421888  0\nmdev                   24576  1 kvmgt\nvfio                   69632  2 kvmgt,vfio_iommu_type1\nkvm                  1413120  2 kvmgt,kvm_intel\ni915                 4300800  24 kvmgt\n</code></pre></p> <p>vGPU \uc0dd\uc131</p> <p>/sys/bus/pci/devices/0000:00:02.0/ \u2514\u2500 mdev_supported_types/    \u2514\u2500 i915-GVTg_V5_4/       \u251c\u2500 create      \u2190  UUID \uc4f0\uba74 \u279c \uc0c8 \ub514\ubc14\uc774\uc2a4 \uc0dd\uc131       \u251c\u2500 remove      \u2190  UUID \uc4f0\uba74 \u279c \ud574\ub2f9 \ub514\ubc14\uc774\uc2a4 \uc0ad\uc81c       \u2514\u2500 instances   \u2190  \uc774\ubbf8 \uc874\uc7ac\ud558\ub294 UUID \ubaa9\ub85d (\uc77d\uae30 \uc804\uc6a9)</p> <p><pre><code>$ UUID=$(uuidgen)           # UUID \uc0dd\uc131\n$ echo $UUID | sudo tee \\\n /sys/bus/pci/devices/0000:00:02.0/mdev_supported_types/i915-GVTg_V5_4/create\n</code></pre> * \ucc38\uace0\ub85c \ucef4\ud4e8\ud130 \ub044\uba74 UUID \ub0a0\ub77c\uac00\ub2c8 \ub9e4\ubc88 \uc0c8\ub85c \ub9cc\ub4e4\uc5b4\uc918\uc57c \ud568.</p>"},{"location":"4-igpu/#qemu-kvm","title":"qemu-kvm \uc635\uc158\uc758 \uc774\ud574","text":"<p>\ub9cc\uc57d git\uc73c\ub85c qemu \uc124\uce58\ud558\uace0 \uc2f6\uc73c\uba74 <pre><code>git clone https://gitlab.com/qemu-project/qemu.git\ncd qemu\nmkdir build\ncd build\n../configure --target-list=x86_64-softmmu --enable-kvm --disable-werror\nninja -j$(nproc)\nninja install\n</code></pre></p> <p>\ube4c\ub4dc \ub54c\ub294 \uc5b4\ub5a4 \ud0c0\uae43 \uc544\ud0a4\ud14d\ucc98\ub97c \ub9cc\ub4e4\uc9c0, \uc5b4\ub5a4 GUI/\ub514\uc2a4\ud50c\ub808\uc774 \ubc31\uc5d4\ub4dc/\uac00\uc18d \ub77c\uc774\ube0c\ub7ec\ub9ac\ub97c \ud3ec\ud568\ud560\uc9c0 \uacb0\uc815</p> <p>\ub7f0\ud0c0\uc784 \ub54c\ub294 VM \ud558\ub4dc\uc6e8\uc5b4 \ud1a0\ud3f4\ub85c\uc9c0, \uac00\uc18d(KVM), CPU \ud328\uc2a4\uc2a4\ub8e8, \uba54\ubaa8\ub9ac, \ud38c\uc6e8\uc5b4(OVMF), \ub514\uc2a4\ud06c/\ub124\ud2b8\uc6cc\ud06c/USB/\uadf8\ub798\ud53d \uc7a5\uce58, VFIO \ud328\uc2a4\uc2a4\ub8e8(vGPU \ud3ec\ud568), \ub514\ubc84\uae45/\uad00\ub9ac(QMP,monitor) \ub4f1\uc744 \uc124\uc815.</p> <p>../configure \uc635\uc158</p> \uce74\ud14c\uace0\ub9ac \ub300\ud45c \uc635\uc158 \uc124\uba85 \ud0c0\uae43 \uc544\ud0a4\ud14d\ucc98 --target-list=x86_64-softmmu \ud544\uc694\ud55c \uc5d0\ubbac\ub808\uc774\uc158 \ub300\uc0c1\ub9cc \ube4c\ub4dc \uc124\uce58 \uacbd\ub85c --prefix=/usr/local \uc2dc\uc2a4\ud15c \uae30\ubcf8 \ud328\ud0a4\uc9c0\uc640 \ucda9\ub3cc \ud53c\ud558\ub824\uba74 \ubcc4\ub3c4 prefix \ub514\ubc84\uadf8 --enable-debug \ubb38\uc81c \ucd94\uc801 \uc720\uc6a9 KVM \uc9c0\uc6d0 --enable-kvm \ubcf4\ud1b5 \uc790\ub3d9 \uac10\uc9c0\ub418\ub098 \ud558\ub294\uac8c \uc88b\uc74c \uadf8\ub798\ud53d \ubc31\uc5d4\ub4dc --enable-gtk,--enable-sdl,--enable-opengl GUI\ucc3d(gtk),\ub808\uac70\uc2dc/\ub300\uc548(sdl),GL\ub80c\ub354\ub9c1(virgl \ub4f1\uacfc \uc5ee\uc784) \uc624\ub514\uc624 --audio-drv-list=pa \uc624\ub514\uc624 \ubc31\uc5d4\ub4dc \uc120\ud0dd(\ud544\uc694 \uc5c6\uc73c\uba74 \uc81c\uac70) SPICE/remote --enable-spice,--enable-usb-redir \uc6d0\uaca9 \uadf8\ub798\ud53d \ubc0f USB \ub9ac\ub2e4\uc774\ub809\uc158 VFIO \uad00\ub828 \uac70\uc758 \uc5c6\uc74c \uc2dc\uc2a4\ud15c \ub77c\uc774\ube0c\ub7ec\ub9ac\uc5d0 \uc758\uc874. \ucee4\ub110\ucabd VFIO \ubaa8\ub4c8\uc774 \ub354 \uc911\uc694 \uc2a4\ud1a0\ub9ac\uc9c0 --enable-libiscsi \ub124\ud2b8\uc6cc\ud06c \uc2a4\ud1a0\ub9ac\uc9c0 \ud504\ub85c\ud1a0\ucf5c \ud544\uc694 \uc2dc LTO/\ucd5c\uc801\ud654 --enable-lto \ucd5c\uc801\ud654 \uad00\ub828 <p>gtk? \uac00\uc7a5 \uc77c\ubc18\uc801\uc778 \uc120\ud0dd. \ucc3d \ud06c\uae30 \uc870\uc808, \uba54\ub274 \uc81c\uc5b4, \ub9c8\uc6b0\uc2a4 \ud3ec\uc778\ud130 \ud1b5\ud569 \ub4f1\ub4f1. sdl? \uacbd\ub7c9 \uc635\uc158. \ucc3d \ud06c\uae30 \uace0\uc815, \uba54\ub274 \uc5c6\uc74c, \ub9c8\uc6b0\uc2a4 \ud3ec\uc778\ud130 \uc911\ucca9 \ubd88\uac00. \ud0a4\uc624\uc2a4\ud06c \uac19\uc740 \uace0\uc815 \ubbf8\ub2c8\uba40 \ud658\uacbd</p> <p>gl=on(opengl)? virtio-gpu\ub97c \uc0ac\uc6a9\ud560\ub54c \ud638\uc2a4\ud2b8\ub85c \uc804\ub2ec\ubc1b\uc740 \uac8c\uc2a4\ud2b8 \ub80c\ub354\ub9c1\uc744 \ucc98\ub9ac\ud558\uae30 \uc704\ud55c api.</p>"},{"location":"4-igpu/#qemu","title":"qemu \ubd80\ud305","text":"<p>qemu \ube4c\ub4dc <pre><code>$ cd qemu &amp;&amp; git checkout v8.2.0    # 8.2.0 \ubc84\uc804 \uc77d\uae30 \ubaa8\ub4dc\ub85c \uc804\ud658\ud55c\uac83. \ub2e4\uc2dc \uc2e4\uc2dc\uac04 \ubc84\uc804\uc73c\ub85c \ubc14\uafb8\uace0 \uc2f6\ub2e4\uba74 git switch - \n$ rm -rf build                # \ud588\ub358 \ube4c\ub4dc \ub514\ub809\ud1a0\ub9ac \uc0ad\uc81c\n$ mkdir build &amp;&amp; cd build\n$ ../configure --target-list=x86_64-softmmu \\\n            --enable-kvm --enable-debug \\\n            --enable-opengl --enable-gtk \\\n            --disable-werror\n$ ninja -j$(nproc)\n$ ninja install\n</code></pre></p> <p>seaBIOS \ubd80\ud305 <pre><code>$ sudo qemu-system-x86_64 \\\n  -machine q35,accel=kvm -cpu host,kvm=on -smp 4 -m 4G \\\n  -vga none \\\n  -device vfio-pci,sysfsdev=/sys/bus/mdev/devices/$UUID,display=on,x-igd-opregion=on \\\n  -drive file=~/win10_120g.qcow2,if=virtio,format=qcow2,cache=none \\\n  -monitor stdio \\\n  -qmp unix:/tmp/win10-qmp.sock,server,nowait \\\n  -display gtk,gl=on\n</code></pre></p> <p>\u26a0\ufe0f \uc131\uacf5. \uadf8\ub807\uc9c0\ub9cc igpu\ub85c \uac8c\uc784\uc774 \uc6d0\ud65c\ud558\uac8c \uc791\ub3d9\ub418\uc9c0 \uc54a\uc544 \ub178\ud2b8\ubd81 \uad50\uccb4</p>"},{"location":"5-dgpu/","title":"5 dgpu","text":""},{"location":"5-dgpu/#igpu-dgpu-vm","title":"IGPU \uc5c6\uc744\ub54c DGPU \ud480 \ud328\uc2a4\uc2a4\ub8e8 vm\uc744 \ub9cc\ub4e4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-02</p> <p>igpu \uc5c6\uc774 dgpu \ud558\ub098\uc5ec\ub3c4, \ud638\uc2a4\ud2b8\uc5d0\uc11c \ub5bc\uace0 \uac8c\uc2a4\ud2b8\ub85c \ub118\uae30\ub294 \ubc95</p>"},{"location":"5-dgpu/#_1","title":"\ud480 \ud328\uc2a4\uc2a4\ub8e8 \uac1c\uc694","text":"<p>IOMMU \ucf1c\uace0 hostdev \ucd94\uac00 + VFIO \ubc14\uc778\ub529\uc744 \ud574\uc57c \uc2e4\uc81c GPU\uac00 \ub118\uc5b4\uac04\ub2e4 \ucc38\uace0\ub85c \uc7a5\uce58\ub294 \uc5d0\ubbac\ub808\uc774\uc158(\uc9c4\uc9dc \ud558\ub4dc\uc6e8\uc5b4\uc778\ucc99 \ud749\ub0b4), \ud30c\ub77c\ubc84\ucd94\uc5bc(\uac00\uc9dc \uc7a5\uce58 \uc778\ud130\ud398\uc774\uc2a4 virtio \uc81c\uacf5), \ud328\uc2a4\uc2a4\ub8e8(\ud558\ub4dc\uc6e8\uc5b4 \uac74\ub0b4\uc8fc\uae30) \uc138\uac00\uc9c0 \ubc29\uc2dd\uc774 \uc788\ub2e4</p>"},{"location":"5-dgpu/#_2","title":"\ucee4\ub110 \uc124\uc815","text":"<p>grub\uc5d0\uc11c IOMMU \uc804\uccb4 \ucf1c\uae30 <pre><code>$ sudo nano /etc/default/grub\n\uc6d0\ubcf8\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash\"\n\uc218\uc815\n# iommu=pt \ud328\uc2a4\uc2a4\ub8e8 \uc7a5\uce58\ub9cc \ud1b5\uacfc video=efifb:off \ud638\uc2a4\ud2b8\uac00 gpu \uae30\ubcf8 \ud504\ub808\uc784\ubc84\ud37c \uc7a1\ub294 \uac83 \ubc29\uc9c0\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash amd_iommu=on iommu=pt video-efifb:off\"\n$ sudo update-grub\n$ reboot\n</code></pre></p>"},{"location":"5-dgpu/#_3","title":"\uc8fc\uc18c \ubc0f \uadf8\ub8f9 \uc815\ubcf4 \ud655\uc778","text":"<p>PCI \uc8fc\uc18c\uc640 ID \ud655\uc778 <pre><code>$ lspci -nn | grep -i -e vga -e audio   # gpu\uc5d0 audio \uc7a5\uce58\uac00 \ub538\ub824 \uc788\ub294 \uacbd\uc6b0\uac00 \ub9ce\uae30 \ub54c\ubb38\uc5d0 \uac19\uc774 ID \uac19\uc774 \ucc3e\uc74c\n01:00.0 VGA compatible controller [0300]: NVIDIA Corporation AD107M [GeForce RTX 4060 Max-Q / Mobile] [10de:28e0] (rev a1)\n01:00.1 Audio device [0403]: NVIDIA Corporation Device [10de:22be] (rev a1)\n05:00.5 Multimedia controller [0480]: Advanced Micro Devices, Inc. [AMD] ACP/ACP3X/ACP6x Audio Coprocessor [1022:15e2] (rev 60)\n05:00.6 Audio device [0403]: Advanced Micro Devices, Inc. [AMD] Family 17h/19h HD Audio Controller [1022:15e3]\n</code></pre> * PCI \uc8fc\uc18c? \ubc84\uc2a4 \uc2ac\ub86f \uc5b4\ub514\uc5d0 \uaf42\ud600 \uc788\ub098 * \ubca4\ub354:\ub514\ubc14\uc774\uc2a4 ID? \uc81c\uc870\uc0ac+\ubaa8\ub378 \ucf54\ub4dc\ub85c \ubb34\uc2a8 \uc7a5\uce58\uc778\uac00 VGA : PCI \uc8fc\uc18c 01:00.0\uc5d0 ID 10de:28e0 Audio : PCI \uc8fc\uc18c 01:00.1\uc5d0 ID 10de:22be \uc774\uac8c \uadf8\ub8f9\uc774 \ub9de\ub294\uc9c0 iommu_groups\uc744 \ud655\uc778\ud574\ubcf4\uc790</p> <p>Iommu_groups \ud655\uc778 <pre><code>$ for g in /sys/kernel/iommu_groups/*; do\n  echo \"Group $(basename $g):\"; ls -l $g/devices; echo; done\nGroup 14:\n\ud569\uacc4 0\nlrwxrwxrwx 1 root root 0  7\uc6d4 26 10:11 0000:01:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:01:00.0\nlrwxrwxrwx 1 root root 0  7\uc6d4 26 10:11 0000:01:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:01:00.1\n</code></pre> \ub530\ub77c\uc11c \ub458\uc740 14\ubc88 \uadf8\ub8f9\uc774 \ub9de\uace0 \uc774\uac70 \ub450\uac1c\ub9cc \ub118\uae30\uba74 \ub428</p>"},{"location":"5-dgpu/#gpu","title":"gpu \uc7a5\uce58 \uc81c\uc5b4","text":"<p>hostdev \uc7a5\uce58 \ucd94\uac00 <pre><code>$ virt-manager\n\ud558\ub4dc\uc6e8\uc5b4 \ucd94\uac00 - PCI \ud638\uc2a4\ud2b8 \uc7a5\uce58 - 0000:01:00.0\uacfc 0000:01:00.1 \ucd94\uac00\n</code></pre> * \uc7a5\uce58 \ub5bc\uae30/\ubd99\uc774\uae30\uc758 \uad00\ub9ac\ub97c managed=yes\ub85c libvirt\uc5d0\uac8c \ub9e1\uae30\ub294 \uac83</p> <p>hook \uc2a4\ud06c\ub9bd\ud2b8 \uc791\uc131 <pre><code>$ sudo mkdir -p /etc/libvirt/hooks    # \ub514\ub809\ud1a0\ub9ac \ud655\uc778\n$ sudo nano /etc/libvirt/hooks/qemu   # qemu \ud30c\uc77c \uc0dd\uc131\n#!/usr/bin/env bash\n# /etc/libvirt/hooks/qemu\nset -euo pipefail\n\nVM=\"$1\"\nHOOK=\"$2\"\nPHASE=\"$3\"\n\nGPU=\"0000:01:00.0\"\nAUD=\"0000:01:00.1\"\nHOSTDRV=\"nvidia\"\n\nDM_LIST=(\"gdm3\" \"gdm\" \"sddm\" \"lightdm\")\nDM_STATE_FILE=\"/run/libvirt-active-dm\"\n\nlog(){ echo \"[$(date +'%F %T')] $*\" &gt;&gt; /var/log/libvirt/qemu-hook.log; }\n\nstop_dm() {\n  for dm in \"${DM_LIST[@]}\"; do\n    if systemctl is-active --quiet \"$dm\"; then\n      systemctl stop \"$dm\"\n      echo \"$dm\" &gt; \"$DM_STATE_FILE\"\n      break\n    fi\n  done\n}\n\nstart_dm() {\n  if [[ -f \"$DM_STATE_FILE\" ]]; then\n    dm=\"$(cat \"$DM_STATE_FILE\")\"\n    systemctl start \"$dm\" || true\n    rm -f \"$DM_STATE_FILE\"\n  fi\n}\n\nunbind_vtconsoles() {\n  for c in /sys/class/vtconsole/*; do\n    [[ -e \"$c/bind\" ]] &amp;&amp; echo 0 &gt; \"$c/bind\" || true\n  done\n  echo efi-framebuffer.0        &gt; /sys/bus/platform/drivers/efi-framebuffer/unbind        2&gt;/dev/null || true\n  echo simple-framebuffer.0    &gt; /sys/bus/platform/drivers/simple-framebuffer/unbind     2&gt;/dev/null || true\n  echo simpledrm.0             &gt; /sys/bus/platform/drivers/simpledrm/unbind              2&gt;/dev/null || true\n}\n\nunload_host_driver() {\n  case \"$HOSTDRV\" in\n    nvidia)\n      modprobe -r nvidia_drm nvidia_modeset nvidia_uvm nvidia 2&gt;/dev/null || true\n      ;;\n    amdgpu)\n      modprobe -r amdgpu 2&gt;/dev/null || true\n      ;;\n  esac\n}\n\nreload_host_driver() {\n  case \"$HOSTDRV\" in\n    nvidia)\n      modprobe nvidia 2&gt;/dev/null || true\n      modprobe nvidia_uvm 2&gt;/dev/null || true\n      modprobe nvidia_modeset 2&gt;/dev/null || true\n      modprobe nvidia_drm 2&gt;/dev/null || true\n      ;;\n    amdgpu)\n      modprobe amdgpu 2&gt;/dev/null || true\n      ;;\n  esac\n}\n\nload_vfio() {\n  for m in vfio vfio-pci vfio_iommu_type1; do\n    modprobe -n \"$m\" &amp;&gt;/dev/null &amp;&amp; modprobe \"$m\" || true\n  done\n}\n\ncase \"${HOOK}/${PHASE}\" in\n  prepare/begin)\n    log \"[$VM] prepare/begin: stop DM, unbind fb, unload $HOSTDRV, load vfio\"\n    stop_dm\n    unbind_vtconsoles\n    unload_host_driver\n    load_vfio\n    ;;\n\n  release/end|stopped/end)\n    log \"[$VM] release/stopped: reload $HOSTDRV, start DM\"\n    reload_host_driver\n    start_dm\n    ;;\n\n  *)\n    log \"[$VM] other phase: $HOOK / $PHASE $4\"\n    ;;\nesac\n\nexit 0\n\n$ sudo chmod +x /etc/libvirt/hooks/qemu     # \uc800\uc7a5 \ud6c4 \uc2e4\ud589\uad8c\ud55c\n$ sudo mv /etc/libvirt/hooks/qemu ~/dd      # \uc7a0\uae50 \ubb34\ud6a8\ud654\ud560\ub54c\n$ sudo mv ~/dd /etc/libvirt/hooks/qemu      # \ub2e4\uc2dc \ud65c\uc131\ud654\n</code></pre> * hook \uc2a4\ud06c\ub9bd\ud2b8\ub780 vm\uc774 \uc2dc\uc791/\uc885\ub8cc\ub418\uae30 \uc9c1\uc804 \uc9c1\ud6c4\uc5d0 libvirt\uac00 \uc790\ub3d9\uc73c\ub85c \uc2e4\ud589\ud574\uc8fc\ub294 \uc2a4\ud06c\ub9bd\ud2b8 * \uc774 \uc548\uc5d0\uc11c vfio \ubaa8\ub4c8\ub85c \uc7a5\uce58 \uac74\ub124\uc8fc\uae30/\uc5b8\ubc14\uc778\ub529/\ubc14\uc778\ub529 \ucf54\ub4dc\ub97c \uc9dc\uc8fc\uace0 \ud638\uc2a4\ud2b8\uc758 gui/dm \ub3c4 \ub0b4\ub824\uc900\ub2e4 * #!\ub294 \uc774 \ud30c\uc77c\uc744 \uc5b4\ub5a4 \uc778\ud130\ud504\ub9ac\ud130\ub85c \uc2e4\ud589\ud560\uc9c0\uc784</p>"},{"location":"5-dgpu/#vm","title":"vm\uc5d0 \uc815\ubcf4 \uc804\ub2ec","text":"<p>rom \ud30c\uc77c \ucd94\uac00 <pre><code>$ sudo mkdir -p /usr/share/vgabios      # \ub514\ub809\ud1a0\ub9ac \uc0dd\uc131\n$ echo 1 | sudo tee /sys/bus/pci/devices/0000:01:00.0/rom     # rom \uc77d\uae30 \ud5c8\uc6a9\n$ sudo dd if=/sys/bus/pci/devices/0000:01:00.0/rom of=/usr/share/vgabios/rtx4060.rom bs=1K\n$ sudo chown root:root /usr/share/vgabios/rtx4060.rom\n$ sudo chmod 644 /usr/share/vgabios/rtx4060.rom\n$ echo 0 | sudo tee /sys/bus/pci/devices/0000:01:00.0/rom   # rom \uc7a0\uae08\n$ virsh edit win10\ngpu hostdev \uc548\uc5d0 source \ube14\ub85d \ub2e4\uc74c\uc5d0 \ub450\ub294 \uac83\uc774 \uad00\ub840\n&lt;rom file='/usr/share/vgabios/rtx4060.rom'/&gt;\n</code></pre></p>"},{"location":"5-dgpu/#_4","title":"&gt; \uc6d0\uaca9","text":"<p>\uc774\ub807\uac8c \ud328\uc2a4\uc2a4\ub8e8\ub97c \uc2dc\ud0a4\uba74 \ud638\uc2a4\ud2b8 \ud654\uba74\uc774 \uc5c6\uc73c\ubbc0\ub85c ssh \uc6d0\uaca9\ucef4\uc73c\ub85c vm\uc744 \ud0a4\uace0 \ub044\uc790</p> <p>ssh \uc2e4\ud589 <pre><code># \ub0b4\ucef4\uc5d0\uc11c\n$ sudo apt install openssh-server\n$ sudo systemctl start ssh\n$ sudo ufw allow 22\n</code></pre></p> <p>ssh \uc6d0\uaca9 <pre><code># \uc6d0\uaca9\ucef4\uc5d0\uc11c\n$ ssh kkongnyang2@172.30.1.69\n\ube44\ubc00\ubc88\ud638 4108 \uc785\ub825\n$ virsh list --all        # vm \ub9ac\uc2a4\ud2b8\ubcf4\uae30\n$ virsh start win10       # vm \ud0a4\uae30\n$ virsh shutdown win10    # vm \ub044\uae30\n$ virsh destroy win10     # \uac15\uc81c \ud30c\uc6cc\ub0b4\ub9ac\uae30\n$ exit                    # ssh \uc5f0\uacb0 \uc885\ub8cc\n</code></pre></p>"},{"location":"5-dgpu/#_5","title":"\ud574\uacb0","text":"<p>\ud638\uc2a4\ud2b8 \ud654\uba74\uc740 \uc798 \uaebc\uc9c0\uc9c0\ub9cc \uac8c\uc2a4\ud2b8 \ud654\uba74\uc774 \ucf1c\uc9c0\uc9c8 \uc54a\uc74c. \ub85c\uadf8\ub97c \uc0b4\ud3b4\ubcf4\uc790</p> <p>hook \uc2a4\ud06c\ub9bd\ud2b8 \ub85c\uadf8: /var/log/libvirt/qemu-hook.log VM\ubcc4 QEMU \ub85c\uadf8: /var/log/libvirt/qemu/win10.log libvirt \ub370\ubaac \ub85c\uadf8: journalctl -u virtqemud -u libvirtd -f \ucee4\ub110/VFIO \uba54\uc2dc\uc9c0: dmesg | grep -i vfio <pre><code>vfio-pci ... resetting \u2026 reset done\nNVRM: GPU 0000:01:00.0 is already bound to vfio-pci.\n</code></pre> \uc815\uc0c1 \uc791\ub3d9.</p> <p>\ud734\ub300\ud3f0 \ud50c\ub798\uc2dc\ub85c \ube44\ucdb0\ubcf4\ub2c8 \ud654\uba74\uc774 \ubcf4\uc784. \ud328\ub110 \ubc31\ub77c\uc774\ud2b8 \ubb38\uc81c\uc784\uc744 \uc54c \uc218 \uc788\uc74c. \uc65c \ud328\ub110 \ubc31\ub77c\uc774\ud2b8\uac00 \uc548\ucf1c\uc9c0\ub0d0? igpu\uac00 \uc5c6\uace0 dgpu\ub9cc \uc788\ub294 \ubaa8\ub378\uc740 \ud504\ub808\uc784\ubc84\ud37c\uac00 dpgu \uc804\uc6a9 vram\uc5d0\ub9cc \uc788\uac8c \ub418\uace0 \ud328\ub110 eDP \uc2e0\ud638\uc120 \ub610\ud55c dpgu display port \uc5d4\uc9c4\uc5d0\ub9cc \ubb3c\ub824 \uc788\ub2e4. \ub610\ud55c \ub178\ud2b8\ubd81\uc5d0\uc11c\ub294 \uc8fc\ub85c EC(Embedded Controller)\uac00 \ubc1d\uae30\ub97c \uc870\uc808\ud558\ub294 \ucee8\ud2b8\ub864\ub7ec\uc778\ub370, ROM\uc5d0 EC \ud38c\uc6e8\uc5b4\uac00 \ud0d1\uc7ac\ub418\uc5b4 \uc788\uc73c\uba70 ACPI\ub77c\ub294 \ud14c\uc774\ube14\uc744 \ud1b5\ud574 \uc774\uac78 os\ub85c \ub118\uaca8\uc8fc\uac8c \ub41c\ub2e4. \ud558\uc9c0\ub9cc qemu \ubd80\ud305\uc5d0\uc11c\ub294 EC \uad00\ub828 ACPI\ub97c \uc0dd\uc131\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \ubc31\ub77c\uc774\ud2b8\ub97c \ud0ac \uc218 \uc5c6\ub294 \uac83\uc774\ub2e4. \uadf8\ub7ec\ub098 \uc694\uc998 \ud328\ub110\uc5d0\ub294 DPCD \uc8fc\uc18c\ub85c AUX \ucc44\ub110(DisplayPort \ubc30\uc120\uc5d0 \ud3ec\ud568\ub41c \ub9c1\ud06c \uc81c\uc5b4 \ubc0f \ubc31\ub77c\uc774\ud2b8 \uc870\uc815 \ucc44\ub110)\uc744 \uc870\uc808\ud560 \uc218 \uc788\uac8c \ud574\ub1a8\uae30\uc5d0 EC \uc5c6\uc774\ub3c4 \uc870\uc808\uc774 \uac00\ub2a5\ud558\ub2e4. geforce rtx 4060 game ready \ub4dc\ub77c\uc774\ubc84 552.12 WHQL \uacc4\uc5f4\ubd80\ud130 NVAPI\ub97c \ud1b5\ud574 eDP AUX \uacbd\ub85c(DPCD \ub808\uc9c0\uc2a4\ud130 0x720/0x722/0x723)\ub85c \ubc1d\uae30 \uac12\uc744 \uc4f0\ub294 \uac8c \uac00\ub2a5\ud558\ub2e4 \uc801\ud600 \uc788\uc73c\ubbc0\ub85c \uc774\uac78 \uc774\uc6a9\ud558\uc790. \ud639\uc740 ovmf\ub85c \ubd80\ud305\ud574\ub3c4 \ubc31\ub77c\uc774\ud2b8 \ubb38\uc81c\uac00 \ud574\uacb0\ub41c\ub2e4</p> <p>\uac8c\uc2a4\ud2b8 spice \uc6d0\uaca9\ud654\uba74 \uc811\uc18d <pre><code># \uc6d0\uaca9\ucef4\uc5d0\uc11c\nvirt-manager.org/download \ub4e4\uc5b4\uac00\uc11c virt-viewer \uce74\ud14c\uace0\ub9ac\uc5d0\uc11c win x64 msi \ub2e4\uc6b4\ubc1b\uae30\n$ virsh start win10\n$ virsh domdisplay win10\nspice://127.0.0.1:5900\n\ub2e4\ub978 cmd $ ssh -N -L 5900:127.0.0.1:5900 kkongnyang2@172.30.1.69   # \ub0b4\ubd80 \uc11c\ube44\uc2a4 \uc811\uc18d \uac00\ub2a5\ud55c \uba85\ub839\uc5b4\nC:\\Program Files\\VirtViewer v12\\bin \ub4e4\uc5b4\uac00\uc11c remote-viewer.exe \ud074\ub9ad\nspice://127.0.0.1:5900 \uc5f0\uacb0\n</code></pre> * spice? \uac00\uc0c1 \uba38\uc2e0 \uc6d0\uaca9 \uc811\uc18d \ud504\ub85c\ud1a0\ucf5c</p> <p>\uac8c\uc2a4\ud2b8\uc5d0\uc11c nvidia \ub4dc\ub77c\uc774\ubc84 \uc124\uce58 <pre><code>geforce - geforce RTX 40 series (notebooks) - geforce RTX 4060 laptop GPU - window 10 64-bit - English(US) - geforce game ready driver\n</code></pre></p> <p>\u26a0\ufe0f \uc2e4\ud328. \ud638\uc2a4\ud2b8\ub97c \ubabb\ubd04 + \ubc31\ub77c\uc774\ud2b8 \ubb38\uc81c\ub85c \uac8c\uc2a4\ud2b8 \ud654\uba74\ub3c4 \uc548\ubcf4\uc784. \ub178\ud2b8\ubd81 \uad50\uccb4</p>"},{"location":"6-two-gpu/","title":"6 two gpu","text":""},{"location":"6-two-gpu/#dgpu-vm","title":"DGPU \ud480 \ud328\uc2a4\uc2a4\ub8e8 vm\uc744 \ub9cc\ub4e4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-08</p>"},{"location":"6-two-gpu/#_1","title":"&gt; \uac00\uc0c1\ud654 \uc9c0\uc6d0 \ud655\uc778","text":"<p>cpu \uac00\uc0c1\ud654 \uc9c0\uc6d0 \uc5ec\ubd80 <pre><code>$ egrep -c '(vmx|svm)' /proc/cpuinfo    # 0\uc774 \uc544\ub2c8\uc5b4\uc57c \ud568. UEFI\uc5d0\uc11c Intel VT-x/AMD-V \ud65c\uc131\ud654 \ud544\uc694\n40            # \ub17c\ub9ac cpu 40\uac1c \ubaa8\ub450\uac00 Intel VT-x \ud50c\ub798\uadf8\ub97c \uac16\uace0 \uc788\ub2e4\ub294 \ub73b\n</code></pre></p> <p>\uc7a5\uce58 IOMMU \uc874\uc7ac \uc5ec\ubd80 <pre><code>$ sudo dmesg | grep -i -e iommu -e dmar\n[    0.005034] ACPI: DMAR 0x000000005BA13000 000088 (v01 ACRSYS ACRPRDCT 00000002 1025 00040000)\n[    0.005073] ACPI: Reserving DMAR table memory at [mem 0x5ba13000-0x5ba13087]\n[    0.103447] DMAR: Host address width 39\n[    0.103448] DMAR: DRHD base: 0x000000fed90000 flags: 0x0\n[    0.103453] DMAR: dmar0: reg_base_addr fed90000 ver 4:0 cap 1c0000c40660462 ecap 29a00f0505e\n[    0.103455] DMAR: DRHD base: 0x000000fed91000 flags: 0x1\n[    0.103458] DMAR: dmar1: reg_base_addr fed91000 ver 5:0 cap d2008c40660462 ecap f050da\n[    0.103459] DMAR: RMRR base: 0x00000064000000 end: 0x000000687fffff\n[    0.103461] DMAR-IR: IOAPIC id 2 under DRHD base  0xfed91000 IOMMU 1\n[    0.103461] DMAR-IR: HPET id 0 under DRHD base 0xfed91000\n[    0.103462] DMAR-IR: Queued invalidation will be enabled to support x2apic and Intr-remapping.\n[    0.105022] DMAR-IR: Enabled IRQ remapping in x2apic mode\n[    0.642545] pci 0000:00:02.0: DMAR: Skip IOMMU disabling for graphics\n[    1.096406] iommu: Default domain type: Translated\n[    1.096406] iommu: DMA domain TLB invalidation policy: lazy mode\n[    1.141664] DMAR: No ATSR found\n[    1.141665] DMAR: No SATC found\n[    1.141666] DMAR: IOMMU feature fl1gp_support inconsistent\n[    1.141666] DMAR: IOMMU feature pgsel_inv inconsistent\n[    1.141667] DMAR: IOMMU feature nwfs inconsistent\n[    1.141668] DMAR: IOMMU feature dit inconsistent\n[    1.141669] DMAR: IOMMU feature sc_support inconsistent\n[    1.141669] DMAR: IOMMU feature dev_iotlb_support inconsistent\n[    1.141670] DMAR: dmar0: Using Queued invalidation\n[    1.141673] DMAR: dmar1: Using Queued invalidation\n[    1.141843] pci 0000:00:02.0: Adding to iommu group 0\n[    1.142381] pci 0000:00:00.0: Adding to iommu group 1\n[    1.142394] pci 0000:00:01.0: Adding to iommu group 2\n[    1.142401] pci 0000:00:04.0: Adding to iommu group 3\n[    1.142409] pci 0000:00:08.0: Adding to iommu group 4\n[    1.142416] pci 0000:00:0a.0: Adding to iommu group 5\n[    1.142424] pci 0000:00:0e.0: Adding to iommu group 6\n[    1.142438] pci 0000:00:14.0: Adding to iommu group 7\n[    1.142445] pci 0000:00:14.2: Adding to iommu group 7\n[    1.142452] pci 0000:00:14.3: Adding to iommu group 8\n[    1.142464] pci 0000:00:15.0: Adding to iommu group 9\n[    1.142471] pci 0000:00:15.1: Adding to iommu group 9\n[    1.142483] pci 0000:00:16.0: Adding to iommu group 10\n[    1.142497] pci 0000:00:1b.0: Adding to iommu group 11\n[    1.142506] pci 0000:00:1c.0: Adding to iommu group 12\n[    1.142520] pci 0000:00:1e.0: Adding to iommu group 13\n[    1.142527] pci 0000:00:1e.1: Adding to iommu group 13\n[    1.142546] pci 0000:00:1f.0: Adding to iommu group 14\n[    1.142553] pci 0000:00:1f.3: Adding to iommu group 14\n[    1.142561] pci 0000:00:1f.4: Adding to iommu group 14\n[    1.142569] pci 0000:00:1f.5: Adding to iommu group 14\n[    1.142583] pci 0000:01:00.0: Adding to iommu group 15\n[    1.142592] pci 0000:01:00.1: Adding to iommu group 15\n[    1.142608] pci 0000:02:00.0: Adding to iommu group 16\n[    1.142617] pci 0000:03:00.0: Adding to iommu group 17\n[    1.142627] pci 0000:03:01.0: Adding to iommu group 18\n[    1.142636] pci 0000:03:02.0: Adding to iommu group 19\n[    1.142649] pci 0000:03:03.0: Adding to iommu group 20\n[    1.142661] pci 0000:04:00.0: Adding to iommu group 21\n[    1.142673] pci 0000:23:00.0: Adding to iommu group 22\n[    1.142681] pci 0000:43:00.0: Adding to iommu group 23\n[    1.145510] DMAR: Intel(R) Virtualization Technology for Directed I/O\n[    1.564068] pci 10000:e0:01.0: Adding to iommu group 6\n[    1.564492] pci 10000:e0:01.1: Adding to iommu group 6\n[    1.564860] pci 10000:e1:00.0: Adding to iommu group 6\n</code></pre></p> <p>qemu \uc9c0\uc6d0 \uac00\ub2a5 \uc5ec\ubd80 <pre><code>$ virt-host-validate\n  QEMU: Checking for hardware virtualization                                 : PASS\n  QEMU: Checking if device /dev/kvm exists                                   : PASS\n  QEMU: Checking if device /dev/kvm is accessible                            : PASS\n  QEMU: Checking if device /dev/vhost-net exists                             : PASS\n  QEMU: Checking if device /dev/net/tun exists                               : PASS\n  QEMU: Checking for cgroup 'cpu' controller support                         : PASS\n  QEMU: Checking for cgroup 'cpuacct' controller support                     : PASS\n  QEMU: Checking for cgroup 'cpuset' controller support                      : PASS\n  QEMU: Checking for cgroup 'memory' controller support                      : PASS\n  QEMU: Checking for cgroup 'devices' controller support                     : WARN (Enable 'devices' in kernel Kconfig file or mount/enable cgroup controller in your system)\n  QEMU: Checking for cgroup 'blkio' controller support                       : PASS\n  QEMU: Checking for device assignment IOMMU support                         : PASS\n  QEMU: Checking if IOMMU is enabled by kernel                               : PASS\n  QEMU: Checking for secure guest support                                    : WARN (Unknown if this platform has Secure Guest support)\n   LXC: Checking for Linux &gt;= 2.6.26                                         : PASS\n   LXC: Checking for namespace ipc                                           : PASS\n   LXC: Checking for namespace mnt                                           : PASS\n   LXC: Checking for namespace pid                                           : PASS\n   LXC: Checking for namespace uts                                           : PASS\n   LXC: Checking for namespace net                                           : PASS\n   LXC: Checking for namespace user                                          : PASS\n   LXC: Checking for cgroup 'cpu' controller support                         : PASS\n   LXC: Checking for cgroup 'cpuacct' controller support                     : PASS\n   LXC: Checking for cgroup 'cpuset' controller support                      : PASS\n   LXC: Checking for cgroup 'memory' controller support                      : PASS\n   LXC: Checking for cgroup 'devices' controller support                     : FAIL (Enable 'devices' in kernel Kconfig file or mount/enable cgroup controller in your system)\n   LXC: Checking for cgroup 'freezer' controller support                     : FAIL (Enable 'freezer' in kernel Kconfig file or mount/enable cgroup controller in your system)\n   LXC: Checking for cgroup 'blkio' controller support                       : PASS\n   LXC: Checking if device /sys/fs/fuse/connections exists                   : PASS\n</code></pre></p>"},{"location":"6-two-gpu/#_2","title":"&gt; \ud328\ud0a4\uc9c0 \uc124\uce58 \ubc0f \ubaa8\ub4c8 \ud655\uc778","text":"<p>\ud544\uc218 \ud328\ud0a4\uc9c0 \uc124\uce58 <pre><code>$ sudo apt update\n$ sudo apt install -y qemu-kvm \\\n                    libvirt-daemon-system libvirt-clients virt-manager \\  # vm \uad00\ub9ac \ub9e4\ub2c8\uc800\n                    bridge-utils build-essential pkg-config git ovmf \\\n                    autoconf automake libtool flex bison check \\    # \ube4c\ub4dc \ud234\n                    libglib2.0-dev libvirt-dev libjson-c-dev \\      # libvmi \ube4c\ub4dc\uc5d0 \ud544\uc694\ud55c dev\n                    python3 python3-pip python3-dev\n</code></pre></p> <p>kvm \ubaa8\ub4c8 \uc0ac\uc6a9\uc790 \ucd94\uac00 <pre><code>$ lsmod | grep kvm        # KVM \ubaa8\ub4c8 \ud655\uc778\nkvm_intel             487424  0\nkvm                  1413120  1 kvm_intel\nirqbypass              12288  1 kvm\n$ sudo usermod -aG libvirt,kvm $USER    # \ud604\uc7ac \uc0ac\uc6a9\uc790\ub97c libvirt, kvm \uadf8\ub8f9\uc5d0 \ucd94\uac00\ud574 root \uc5c6\uc774 \uc811\uadfc\n                                        # \ub098\uc911\uc5d0 \ud574\uc81c\ud558\ub824\uba74 sudo gpasswd -d &lt;USER&gt; &lt;GROUP&gt;\n</code></pre></p> <p>vfio \ubaa8\ub4c8 \ucf1c\ubcf4\uae30(\uc874\uc7ac \ud655\uc778) <pre><code>$ sudo modprobe vfio_pci      # \ud0a4\uae30\n$ lsmod | grep vfio\nvfio_pci               16384  0\nvfio_pci_core          90112  1 vfio_pci\nvfio_iommu_type1       49152  0\nvfio                   69632  3 vfio_pci_core,vfio_iommu_type1,vfio_pci\niommufd                98304  1 vfio\nirqbypass              12288  2 vfio_pci_core,kvm\n</code></pre></p>"},{"location":"6-two-gpu/#dpgu","title":"dpgu \uc8fc\uc18c \ubc0f \uadf8\ub8f9 \uc815\ubcf4","text":"<p>PCI \uc8fc\uc18c\uc640 ID \ud655\uc778 <pre><code>$ lspci -nn | grep -i -e vga -e audio   # gpu\uc5d0 audio \uc7a5\uce58\uac00 \ub538\ub824 \uc788\ub294 \uacbd\uc6b0\uac00 \ub9ce\uae30 \ub54c\ubb38\uc5d0 \uac19\uc774 ID \uac19\uc774 \ucc3e\uc74c\n0000:00:02.0 VGA compatible controller [0300]: Intel Corporation Device [8086:a788] (rev 04)\n0000:00:1f.3 Multimedia audio controller [0401]: Intel Corporation Device [8086:7a50] (rev 11)\n0000:01:00.0 VGA compatible controller [0300]: NVIDIA Corporation Device [10de:28e0] (rev a1)\n0000:01:00.1 Audio device [0403]: NVIDIA Corporation Device [10de:22be] (rev a1)\n</code></pre> * PCI \uc8fc\uc18c? \ubc84\uc2a4 \uc2ac\ub86f \uc5b4\ub514\uc5d0 \uaf42\ud600 \uc788\ub098 * \ubca4\ub354:\ub514\ubc14\uc774\uc2a4 ID? \uc81c\uc870\uc0ac+\ubaa8\ub378 \ucf54\ub4dc\ub85c \ubb34\uc2a8 \uc7a5\uce58\uc778\uac00 VGA : PCI \uc8fc\uc18c 01:00.0\uc5d0 ID 10de:28e0 Audio : PCI \uc8fc\uc18c 01:00.1\uc5d0 ID 10de:22be \uc774\uac8c \uadf8\ub8f9\uc774 \ub9de\ub294\uc9c0 iommu_groups\uc744 \ud655\uc778\ud574\ubcf4\uc790</p> <p>Iommu_groups \ud655\uc778 <pre><code>$ for g in /sys/kernel/iommu_groups/*; do\n  echo \"Group $(basename $g):\"; ls -l $g/devices; echo; done\nGroup 15:\ntotal 0\nlrwxrwxrwx 1 root root 0  8\uc6d4  8 16:22 0000:01:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.0\nlrwxrwxrwx 1 root root 0  8\uc6d4  8 16:22 0000:01:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.0/0000:01:00.1\n</code></pre> \ub530\ub77c\uc11c \ub458\uc740 15\ubc88 \uadf8\ub8f9\uc774 \ub9de\uace0 \uc774\uac70 \ub450\uac1c\ub9cc \ub118\uae30\uba74 \ub428</p>"},{"location":"6-two-gpu/#dgpu","title":"dgpu \ubd84\ub9ac","text":"<p>\ucee4\ub110 \ud30c\ub77c\ubbf8\ud130\ub85c vfio\uac00 dpgu \uc120\uc810 <pre><code>$ sudo nano /etc/default/grub\n\uc6d0\ubcf8\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash\"\n\uc218\uc815\n# iommu=pt \ud328\uc2a4\uc2a4\ub8e8 \uc7a5\uce58\ub9cc \ud1b5\uacfc vfio-pci.ids \uc120\uc810\ud560 PCI ID \uc9c0\uc815 \nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet splash intel_iommu=on iommu=pt kvm.ignore__msrs=1 vfio-pci.ids=10de:28e0,10de:22be\"\n$ sudo update-grub\n</code></pre></p> <p>\ubd80\ud305\uc2dc vfio \ubaa8\ub4c8 \uc790\ub3d9 \ub85c\ub4dc <pre><code>$ sudo nano /etc/modules\nvfio\nvfio_pci\nvfio_iommu_type1\n</code></pre></p> <p>VGA BAR \ucc28\ub2e8 \ubc0f \ud574\ub2f9 \ub4dc\ub77c\uc774\ubc84 \ube14\ub799\ub9ac\uc2a4\ud2b8 <pre><code>$ sudo nano /etc/modprobe.d/vfio.conf\noptions vfio-pci ids=10de:28e0,10de:22be disable_vga=1\nblacklist nvidia nvidia_drm nouveau\n$ sudo update-initramfs -u\n</code></pre></p> <p>\uc7ac\ubd80\ud305 \ud6c4 \ud655\uc778 <pre><code>$ sudo reboot\n$ lspci -nnk -d 10de:28e0\n0000:01:00.0 VGA compatible controller [0300]: NVIDIA Corporation Device [10de:28e0] (rev a1)\n    Subsystem: Acer Incorporated [ALI] Device [1025:1731]\n    Kernel driver in use: vfio-pci\n    Kernel modules: nvidiafb, nouveau\n</code></pre></p>"},{"location":"6-two-gpu/#vm","title":"vm \uc0dd\uc131","text":"<p>iso \ub2e4\uc6b4\ub85c\ub4dc <pre><code>https://www.microsoft.com/software-download/windows10 \ub4e4\uc5b4\uac00 \uc601\uc5b4(\ubbf8\uad6d) 64\ube44\ud2b8 \ub2e4\uc6b4\ub85c\ub4dc. Win10_22H2_English_x64v1.iso. \uc708\ub3c4\uc6b0 \uc124\uce58\ub97c \uc704\ud55c DVD \uc5ed\ud560.\n$ sudo mv ~/Downloads/Win10_22H2_English_x64v1.iso /var/lib/libvirt/images/\n\uad8c\ud55c libvirt-qemu:kkongnyang2\n</code></pre></p> <p>vm \uc0dd\uc131 <pre><code>$ virt-manager\n\uc0c8 vm \ub9cc\ub4e4\uae30\nlocal install media - browse - images\uc5d0 \uc788\ub294 Win10_22H2_English_x64v1.iso \uc120\ud0dd. \uc708\ub3c4\uc6b0 10.\n\uba54\ubaa8\ub9ac 16000MB, cpu 10\uac1c\n\uc800\uc7a5\uc18c \ud65c\uc131\ud654. \ub514\uc2a4\ud06c \uc774\ubbf8\uc9c0 160.0GB. \uc774\ub984 win10 (\uc704\uce58 /var/lib/libvirt/images/win10.qcow2)     # win10.qcow2 : \ube48 \ud558\ub4dc\ub514\uc2a4\ud06c.\ncustom \uc120\ud0dd\nOverview\uc5d0\uc11c Q35, UEFI x86_64 : OVMF_CODE_4M.fd \uc120\ud0dd\nCPUs\uc5d0\uc11c host-passthruogh \uccb4\ud06c \ud655\uc778\nAdd hardware - PCI Host Device - 0000:01:00:0\uacfc 0000:01:00:1 \uc120\ud0dd\nDisplay Spice - Spice server, none(\ub0b4 \ucef4\ud4e8\ud130 \uc548\uc5d0\uc11c\ub9cc \uc6d0\uaca9 \uc811\uc18d)\n\uc644\ub8cc \ud6c4 \uc124\uce58\n</code></pre></p> <p>\ud639\uc2dc virtio \ub4dc\ub77c\uc774\ubc84 \ud544\uc694\ud558\uba74 <pre><code>https://fedorapeople.org/groups/virt/virtio-win/direct-downloads \ub4e4\uc5b4\uac00 stable - virtio-win-0.1.271.iso \ub2e4\uc6b4\ub85c\ub4dc. virtio \ub4dc\ub77c\uc774\ubc84\ub4e4 \ubaa8\uc74c.\n$ sudo mv ~/Downloads/virtio-win-0.1.271.iso /var/lib/libvirt/images/\n\uad8c\ud55c libvirt-qemu:kkongnyang2\n$ virt-manager\nadd hardware - storage - images\uc5d0 \uc788\ub294 virtio-win.iso, cdrom, sata\n</code></pre></p> <p>hostdev\ub97c \ud574\uc8fc\uae34 \ud588\uc9c0\ub9cc \uc544\uc9c1 \ud574\ub2f9 nvidia \ub4dc\ub77c\uc774\ubc84\uc640 looking glass \uc5d4\uc9c4\uc774 \uac8c\uc2a4\ud2b8\uc5d0 \uc5c6\uc5b4\uc11c \uac00\uc0c1 vga \uc5d0\ubbac\ub808\uc774\uc158 = qxl \ube44\ub514\uc624(\uac00\uc0c1 gpu) + spice \uc6d0\uaca9 + virt-viewer\ub85c \ucc3d \ucd9c\ub825 \uad6c\uc870\uc784.</p> <p>\uc708\ub3c4\uc6b0 \ubc0f \ub4dc\ub77c\uc774\ubc84 \uc124\uce58 <pre><code>\uacc4\uc815 \uc785\ub825 \ub098\uc624\uba74 shift+f10 \ub204\ub974\uace0 start ms-cxh:localonly. kkongnyang2\uc5d0 \uc554\ud638 4108\n\uc708\ub3c4\uc6b0 \uc5c5\ub370\uc774\ud2b8\ub85c \ub4dc\ub77c\uc774\ubc84 \uc54c\uc544\uc11c \uc124\uce58\ndevice manager \ub4e4\uc5b4\uac00 \ub290\ub08c\ud45c \uc5c6\ub294\uc9c0 \ud655\uc778\n</code></pre></p> <p>\u26a0\ufe0f \uc131\uacf5. \uadfc\ub370 \ubd88\uc548\uc815\ud574\uc11c \ucc28\ub2e8 \uba85\ub839\uc5b4\ub97c \ub2e4\uc2dc \ud655\uc778\ud574\ubd10\uc57c \ud560\ub4ef.</p>"},{"location":"7-vmi/","title":"7 vmi","text":""},{"location":"7-vmi/#vmi","title":"VMI\uc758 \uad6c\uc870\ub97c \uc774\ud574\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-02</p>"},{"location":"7-vmi/#_1","title":"&gt; \ud558\uc774\ud37c\ubc14\uc774\uc800 \uc120\ud0dd","text":"\ud558\uc774\ud37c\ubc14\uc774\uc800 VMI \uce5c\ud654\ub3c4 \uc7a5\uc810 \ub2e8\uc810 \ub300\ud45c \ud234/\ud504\ub85c\uc81d\ud2b8 Xen \u2605\u2605\u2605\u2605\u2605 LibVMI \uc6d0\uc870\uae09, altp2m \uae30\ubc18 \uba54\ubaa8\ub9ac \uc774\ubca4\ud2b8, DRAKVUF \ub4f1 \ud48d\ubd80 \uc124\uc815/\uc6b4\uc601 \ubcf5\uc7a1, \ucd5c\uc2e0 HW \uc9c0\uc6d0/\ud638\ud658\uc131 \uc774\uc288 DRAKVUF, LibVMI KVM/QEMU \u2605\u2605\u2605\u2605\u2606 \ub9ac\ub205\uc2a4 \uae30\ubcf8, libvirt \uc5f0\ub3d9 \uc27d\uace0 \ub110\ub9ac \uc0ac\uc6a9 \uc774\ubca4\ud2b8 \ud2b8\ub7a9 \uad6c\ud604 \uc2dc Xen\ubcf4\ub2e4 \uc190\uc774 \ub354 \uac10 LibVMI, PyVMI VMware ESXi \u2605\u2605\u2605\u2605\u2606 \uacf5\uc2dd introspection API, \uc548\uc815\uc801 \uc0c1\uc6a9/\ud3d0\uc1c4\uc801, \ube44\uc6a9, \uc790\uc720\ub3c4 \uc81c\ud55c VMware VMI SDK (Thin agent) Hyper-V \u2605\u2605\u2606\u2606\u2606 Windows \uce5c\ud654, \ucee4\ub110 \ub808\ubca8 \uc811\uadfc \uac00\ub2a5 \uacf5\uac1c \ub3c4\uad6c \uc801\uc74c, \uad6c\ud604 \ub09c\uc774\ub3c4 \uc790\uccb4 \uac1c\ubc1c \ud544\uc694 VirtualBox \u2605\u2606\u2606\u2606\u2606 \uc14b\uc5c5 \uc26c\uc6c0 VMI\uc6a9 API \uc0ac\uc2e4\uc0c1 \uc5c6\uc74c, hacky \uc791\uc5c5 \ud544\uc694 \uc9c1\uc811 /proc/\u2026/mem \uc811\uadfc \ub4f1 \u201c\uaf3c\uc218\u201d Bareflank/ACRN \u2605\u2605\u2606\u2606\u2606 \uacbd\ub7c9/\uc624\ud508\uc18c\uc2a4, \uc5f0\uad6c \ubaa9\uc801 \uc88b\uc74c \ubb38\uc11c/\ucee4\ubba4\ub2c8\ud2f0 \uc791\uc74c, \ubaa8\ub4e0 \uae30\ub2a5 \uc9c1\uc811 \uad6c\ud604 \ucee4\uc2a4\ud140 \ud558\uc774\ud37c\ubc14\uc774\uc800 \uac1c\ubc1c <p>\uba54\ubaa8\ub9ac \uc774\ubca4\ud2b8 \ud2b8\ub7a9\uc774\uba74 Xen + LibVMI (DRAKVUF \uad6c\uc870 \ucc38\uace0) libvirt \uc5c6\uc774 Xen \uc790\uccb4 \ud234(xl) \uc0ac\uc6a9. altp2m\ub85c \ud398\uc774\uc9c0 \uad8c\ud55c \ubc14\uafd4 \ud2b8\ub7a9 \uc7a1\uae30 \uc218\uc6d4.</p> <p>\uc774\ubbf8 \uc6b0\ubd84\ud22c\uc5d0 kvm \ud658\uacbd\uc774\ub77c\uba74 KVM/QEMU + LibVMI libvirt\ub85c \ud3b8\ud558\uac8c \uad00\ub9ac \ud558\uace0, \ubb38\uc11c \ub9ce\uc740 libvmi/pyvmi\ub85c.</p> <ul> <li>kvm(kernel based virtual machine) \ub9ac\ub205\uc2a4 \ucee4\ub110 \ubaa8\ub4c8. VT-x\ub97c \uc0ac\uc6a9\ud574\uc11c \uac8c\uc2a4\ud2b8 cpu \uc2e4\ud589\uc744 \ucee4\ub110 \ub808\ubca8\uc5d0\uc11c \uac00\uc18d\ud574\uc90c. qemu\ub294 \uac00\uc0c1\uba38\uc2e0 \ud558\uc774\ud37c\ubc14\uc774\uc800.</li> </ul> <p>\uc708\ub3c4\uc6b0 \ud658\uacbd\uc5d0\uc11c hyper-v\ub85c \uc791\uc5c5\ud558\uba74 \ubc14\ub85c \uc624\ubc84\uc6cc\uce582 \uc548\ud2f0\uce58\ud2b8\uc5d0 \ud0d0\uc0c9</p>"},{"location":"7-vmi/#vmi_1","title":"vmi \ud234","text":"<p>VMI\ub780? \uc774\ubbf8 \uc2e4\ud589 \uc911\uc778 VM \ub0b4\ubd80 \uc0c1\ud0dc(\uba54\ubaa8\ub9ac, \ub808\uc9c0\uc2a4\ud130, \ud30c\uc77c\uc2dc\uc2a4\ud15c \ub4f1)\ub97c \ubc14\uae65(\ud558\uc774\ud37c\ubc14\uc774\uc800)\uc5d0\uc11c \ub4e4\uc5ec\ub2e4\ubcf4\uac70\ub098 \uc870\uc791\ud558\ub294 \uae30\uc220. \uac8c\uc2a4\ud2b8 \ubc16\uc5d0\uc11c \uc774\ub904\uc9c0\ubbc0\ub85c \uc548\ud2f0\uce58\ud2b8 \uc785\uc7a5\uc5d0\uc11c\ub294 \uc544\ubb34\uac83\ub3c4 \uc54c \uc218 \uc5c6\ub2e4.</p> <p>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502  \ud638\uc2a4\ud2b8 OS / \ud558\uc774\ud37c\ubc14\uc774\uc800\u2502  \u2190 LibVMI\u00b7DRAKVUF \uac19\uc740 VMI \ub77c\uc774\ube0c\ub7ec\ub9ac \u2502  (VMI \ub300\uc0c1 \uba54\ubaa8\ub9ac \ub9f5)   \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bd\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502      \uac8c\uc2a4\ud2b8 VM          \u2502  \u2190 Windows 10 + \uac8c\uc784 + \uc548\ud2f0\uce58\ud2b8 \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502 \u2502  \u2502  \uac8c\uc784 \ud504\ub85c\uc138\uc2a4 \u2502      \u2502 \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518</p> <p>VMI \ud504\ub85c\uadf8\ub7a8 \uad6c\uc131</p> <p>\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502         Python \ub808\ubca8           \u2502 \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502 \u2502  \u2502 PyVMI  \u2502   \u2502  r2vmi   \u2502    \u2502 \u2502  \u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518    \u2502 \u2502     \u2502               \u2502         \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502          C \ub77c\uc774\ube0c\ub7ec\ub9ac         \u2502 \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502 \u2502  \u2502 libvmi \u2502   \u2502 libkvmi  \u2502    \u2502 \u2502  \u2514\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2518   \u2514\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2518    \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502        \ud558\uc774\ud37c\ubc14\uc774\uc800 \uce35        \u2502 \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  (\uc635\uc158)       \u2502 \u2502  \u2502 QEMU(KVM)  \u2502\u2500\u2500\u2500KVMI \ud328\uce58   \u2502 \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518               \u2502 \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524 \u2502         Linux \ucee4\ub110(KVM)       \u2502 \u2502      (\uc635\uc158: kvmi-intro patch) \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518</p>"},{"location":"7-vmi/#_2","title":"\ud544\uc694\ud55c \uac8c\uc2a4\ud2b8 \uc815\ubcf4","text":"<p>[\ud544\uc694\uc815\ubcf4]   \u251c\u2500 \uc2dd\ubcc4: (domain name | domid | qemu pid)   \u251c\u2500 \uc8fc\uc18c\ubcc0\ud658: DTB (CR3)   \u251c\u2500 \ud574\uc11d: \ud504\ub85c\ud30c\uc77c(json) - \uc2ec\ubcfc \uc8fc\uc18c\uc640 \uad6c\uc870\uccb4 \ud544\ub4dc \uc624\ud504\uc14b   \u2514\u2500 ostype, KASLR \uc5ec\ubd80, \uad8c\ud55c</p> <p>domid, \uba54\ubaa8\ub9ac \ub9f5, DTB\ub97c libvirt API\ub85c \uc790\ub3d9\uc73c\ub85c \uac00\uc838\uc62c \uc218 \uc788\uc74c. \uc9c1\uc811 qemu\ub85c \uc2e4\ud589\ud55c vm\ub294 /proc//mem \ub4f1\uc744 \uc9c1\uc811 \ub9e4\ud551\ud574\uc57c \ud568 <p>(1) VM \uc2dd\ubcc4\uc744 \uc704\ud55c domain name</p> <p>domain name : libvirt\uc5d0\uc11c vm\uc744 \uad6c\ubd84\ud558\ub294 \ubb38\uc790\uc5f4 \uc774\ub984. \uc0ac\uc6a9\uc790\uac00 \uc9c1\uc811 \uc815\ud568 domain ID : libvirt\uac00 \uc2e4\ud589 \uc911\uc778 vm\uc5d0 \ubd80\uc5ec\ud558\ub294 \uc77c\uc2dc\uc801 \ub7f0\ud0c0\uc784 ID. virsh domid  \ub85c \ud655\uc778. qemu PID : qemu \ud504\ub85c\uc138\uc2a4\uc758 pid. ps aux | grep qemu-system-x86_64 \uac19\uc740 \uac78\ub85c \ud655\uc778 <p>(2) \uc8fc\uc18c \ubcc0\ud658\uc744 \uc704\ud55c DTB (Directory Table Base)</p> <p>\uac8c\uc2a4\ud2b8 \uac00\uc0c1 \uc8fc\uc18c(VA)\ub97c \ubb3c\ub9ac \uc8fc\uc18c(PA)\ub85c \ubc14\uafc0 \ub54c \ud544\uc694\ud55c \ud398\uc774\uc9c0 \ud14c\uc774\ube14 \ub8e8\ud2b8 \ubb3c\ub9ac \uc8fc\uc18c. x86-64\uc5d0\uc11c CR3 \ub808\uc9c0\uc2a4\ud130\uac00 \uac00\ub9ac\ud0a8\ub2e4. libvmi\uac00 \uc790\ub3d9\uc73c\ub85c \ucc3e\uc544\uc8fc\uae30\ub3c4 \ud558\uc9c0\ub9cc, \uc2e4\ud328\ud558\uba74 \uc9c1\uc811 \uc9c0\uc815 \ub9ac\ub205\uc2a4\ub294 task_struct-&gt;mm-&gt;pgd\uc5d0\uc11c \ubf51\uace0, \uc708\ub3c4\uc6b0\uba74 EPROCESS.DirectoryTableBase\uc5d0\uc11c \ubf51\ub294\ub2e4.</p> <p>(3) \uc758\ubbf8 \uc788\ub294 \ud574\uc11d\uc744 \uc704\ud55c \ud504\ub85c\ud30c\uc77c(json \ud615\uc2dd)</p> <p>\uc2ec\ubcfc \uc8fc\uc18c\uc640 \ucee4\ub110 \uad6c\uc870\uccb4 \ud544\ub4dc \uc624\ud504\uc14b \uc815\ubcf4. \ub9ac\ub205\uc2a4\uba74 System.map(\uacf5\uac1c \uc2ec\ubcfc \uc8fc\uc18c) + vmlinux\ub97c \ubc14\ud0d5\uc73c\ub85c dwarf2json(vilatility) \ud234\uc744 \uc774\uc6a9\ud574 \ub9cc\ub4e0\ub2e4. \uc708\ub3c4\uc6b0\uba74 PDB(program database)\ub97c \ubc14\ud0d5\uc73c\ub85c volatility/rekall/drakpdb \ud234\uc744 \uc774\uc6a9\ud574 \ub9cc\ub4e0\ub2e4.</p> <p>(4) \uadf8\ubc16\uc5d0\ub3c4 KASLR(\ucee4\ub110 \uc8fc\uc18c \ub79c\ub364\ud654. libvmi\uac00 DTB\ub97c \ucc3e\uae30 \uc5b4\ub835\uac8c \ud568) \uc0ac\uc6a9 \uc5ec\ubd80(linux_kaslr=true), \uad8c\ud55c(root), /etc/libvmi.conf \uc811\uadfc\uc131 \ub4e4\uc774 \ud544\uc694\ud558\ub2e4.</p>"},{"location":"7-vmi/#vmi_2","title":"vmi \uc2dc\ub098\ub9ac\uc624","text":"<p>(1) KVM(\ub9ac\ub205\uc2a4)\uc5d0\uc11c Legacy \ubc29\uc2dd (LibVMI + QEMU GDB/\ud328\uce58)</p> <p>\ud750\ub984/\uad6c\uc870</p> <p>\ud638\uc2a4\ud2b8\uc758 LibVMI\uac00 QEMU\uc758 \uc61b \uba54\ubaa8\ub9ac \uc811\uadfc \uacbd\ub85c(GDB stub \ub610\ub294 QEMU fast-memaccess \ud328\uce58)\ub85c \uac8c\uc2a4\ud2b8 RAM\uc744 \uc77d\uace0 \uc500. \ud558\uc774\ud37c\ubc14\uc774\uc800 \ub808\ubca8 \uc774\ubca4\ud2b8(\uc2e4\ud589/\uc4f0\uae30 \ud2b8\ub7a9)\ub294 \uc0ac\uc2e4\uc0c1 \uc5c6\uc74c. LibVMI\ub97c \ube4c\ub4dc\ud560 \ub54c -DENABLE_KVM_LEGACY \uc635\uc158\uc73c\ub85c \ucf2c. </p> <p>\uac00\ub2a5\ud55c \uae30\ub2a5</p> <p>\ubb3c\ub9ac/\uac00\uc0c1 \uba54\ubaa8\ub9ac \uc77d\uae30\u00b7\uc4f0\uae30, \ub808\uc9c0\uc2a4\ud130 \uc811\uadfc, \uc77c\uc2dc\uc815\uc9c0/\uc7ac\uac1c \ub4f1 \uae30\ubcf8 VMI. \ud558\uc9c0\ub9cc \uba54\ubaa8\ub9ac \uc774\ubca4\ud2b8(\uc2e4\ud589/\uc77d\uae30/\uc4f0\uae30 \ud6c5) \ub294 \ubbf8\uc9c0\uc6d0(\ub610\ub294 \ub9e4\uc6b0 \uc81c\ud55c\uc801) \u2192 \uc2e4\uc2dc\uac04 \ud6c5 \uae30\ubc18 \ubd84\uc11d/\ubc29\uc5b4\uc5d4 \ubd80\uc801\ud569. </p> <p>\ud638\ud658/\ud604\uc2e4\uc131(2025)</p> <p>KVM\uc774 \ub3cc\uc544\uac00\uae30\ub9cc \ud558\uba74(\ub300\ubd80\ubd84\uc758 \ucd5c\uc2e0 Intel/AMD) \uc791\ub3d9 \uac00\ub2a5. \ub2e4\ub9cc GDB stub/\ud328\uce58 \uacbd\ub85c\ub294 \ub290\ub9ac\uace0 \ucde8\uc57d\ud558\uba70, \ucd5c\uc2e0 QEMU/\ucee4\ub110\uacfc\uc758 \uad81\ud569 \uc774\uc288\uac00 \uc7a6\uc74c(\ud504\ub85c\uc81d\ud2b8\uc5d0\uc11c\ub3c4 \u201c\uacfc\uac70 \ubc29\uc2dd\u201d\uc73c\ub85c \ubd84\ub958). \ucd08\ubcf4\uc790 \uad8c\uc7a5 X. </p> <p>(2) KVMI \ucee4\ub110 \uacbd\ub85c (KVM-VMI: \ucee4\ub110\u00b7QEMU \ud328\uce58 + libkvmi)</p> <p>\ud750\ub984/\uad6c\uc870</p> <p>KVM\uc5d0 KVMi(=KVMI) \uc11c\ube0c\uc2dc\uc2a4\ud15c\uc744 \ucd94\uac00\ud55c \ucee4\ub110(CONFIG_KVM_INTROSPECTION, kvmi-v7 \ub4f1) + KVMI \ub300\uc751 QEMU\ub85c \uac8c\uc2a4\ud2b8\ub97c \uc62c\ub9bc \u2192 \ud638\uc2a4\ud2b8\uc758 libkvmi/LibVMI\uac00 \uacf5\uc2dd\uc801\uc778 VMI API(chardev)\ub97c \ud1b5\ud574 \ud398\uc774\uc9c0 \uc811\uadfc \uc81c\uc5b4, \uc774\ubca4\ud2b8 \ud1b5\uc9c0, vCPU \uc0c1\ud0dc \uc870\ud68c \ub4f1\uc744 \uc218\ud589. </p> <p>\uac00\ub2a5\ud55c \uae30\ub2a5</p> <p>VM \uc77c\uc2dc\uc815\uc9c0\u00b7\uc7ac\uac1c, vCPU GPR/MSR \uc870\ud68c, EPT(\uac19\uc740 HW \ubc31\ud0b9) \uae30\ubc18 \ud398\uc774\uc9c0 \uc811\uadfc\ube44\ud2b8 \uc870\uc791, \uc811\uadfc/\uc2e4\ud589 fault \uc774\ubca4\ud2b8 \uc218\uc2e0, \ud558\uc774\ud37c\ucf5c/MSR \ubcc0\uacbd \uac10\uc2dc \ub4f1 \ub2a5\ub3d9 VMI. </p> <p>\ud638\ud658/\ud604\uc2e4\uc131(2025)</p> <p>\uba54\uc778\ub77c\uc778\uc774 \uc544\ub2c8\ub77c \ubcc4\ub3c4 \ube0c\ub79c\uce58(\ucee4\ub110/ QEMU) \ub97c \ube4c\ub4dc\ud574\uc57c \ud574\uc11c \uc720\uc9c0\ubcf4\uc218 \ubd80\ub2f4 \ud07c. \uc608\uc81c\u00b7\ub9b4\ub9ac\uc2a4\ub294 \uc874\uc7ac\ud558\uc9c0\ub9cc(\ucd5c\uc2e0 \ub9b4\ub9ac\uc2a4 2023) \ucd5c\uc2e0 \ubc30\ud3ec\ud310 \ucee4\ub110\uacfc\uc758 \ubc84\uc804 \ud540ning\uc774 \ud544\uc218. EPT \uc804\uc81c\ub97c \uba85\uc2dc(\ubb38\uc11c\uac00 \u201c\uc608: Intel\uc758 EPT\u201d\ub77c \uc11c\uc220)\ud558\ubbc0\ub85c AMD NPT\ub294 \uc9c0\uc6d0/\uae30\ub2a5 \uc81c\uc57d\uc744 \ud655\uc778 \ud544\uc694. \ucd08\ubcf4\uc790 \ub09c\uc774\ub3c4 \ub192\uc74c. </p> <p>(3) Xen + LibVMI (\uac00\uc7a5 \ud45c\uc900\uc801\uc778 VMI \uacbd\ub85c)</p> <p>\ud750\ub984/\uad6c\uc870</p> <p>Xen \ud558\uc774\ud37c\ubc14\uc774\uc800 \uc704\uc5d0 Windows/Linux \uac8c\uc2a4\ud2b8 \uc2e4\ud589 \u2192 Dom0(\ub610\ub294 \ubcc4\ub3c4 \ub3c4\uba54\uc778)\uc758 LibVMI\uac00 Xen\uc758 VMI/\uba54\ubaa8\ub9ac \uc774\ubca4\ud2b8(vm_event, mem_access, altp2m) \ub97c \uc774\uc6a9\ud574 \uac8c\uc2a4\ud2b8 \uba54\ubaa8\ub9ac/\ub808\uc9c0\uc2a4\ud130 \uc811\uadfc + \ud558\ub4dc\uc6e8\uc5b4 \uc218\uc900 \ud2b8\ub7a9\uc744 \uc218\ud589. </p> <p>\uac00\ub2a5\ud55c \uae30\ub2a5</p> <p>\uba54\ubaa8\ub9ac \uc77d\uae30\u00b7\uc4f0\uae30, vCPU \ub808\uc9c0\uc2a4\ud130 \uc811\uadfc + \uc2e4\ud589/\uc77d\uae30/\uc4f0\uae30 \uc774\ubca4\ud2b8 \ud6c5, \uc2f1\uae00\uc2a4\ud15d, altp2m(\ub300\uccb4 EPT) \uc2a4\uc651 \ub4f1 \ud48d\ubd80\ud55c \uc774\ubca4\ud2b8 \uae30\ubc18 VMI. LibVMI \uce21 \ubb38\uc11c\ub3c4 \uba54\ubaa8\ub9ac \uc774\ubca4\ud2b8\ub294 \ud604\uc7ac Xen\uc5d0\uc11c\ub9cc \uc9c0\uc6d0\uc774\ub77c \uba85\uc2dc. </p> <p>\ud638\ud658/\ud604\uc2e4\uc131(2025)</p> <p>\ucd5c\uc2e0 Intel VT-x/EPT \ud658\uacbd\uc5d0\uc11c \ub9e4\uc6b0 \uc131\uc219. Xen\uc740 ARM 2-stage paging\ub3c4 \uc9c0\uc6d0(\uae30\ub2a5 \ucc28\uc774 \uc874\uc7ac), \uc77c\ubc18\uc801\uc73c\ub860 Intel/EPT\uc5d0\uc11c \uac00\uc7a5 \uc548\uc815\uc801. AMD NPT\uc5d0\uc11c\ub3c4 \uae30\ubcf8 \uba54\ubaa8\ub9ac \uc811\uadfc\uc740 \uac00\ub2a5\ud558\ub098, \uace0\uae09 \uc774\ubca4\ud2b8/altp2m \uae30\ubc18 \uae30\ub2a5\uc740 Intel EPT \uc911\uc2ec \uc0dd\ud0dc\uacc4. \uc2e4\ubb34/\uc5f0\uad6c \ucee4\ubba4\ub2c8\ud2f0\uc640 \uc790\ub8cc\uac00 \uac00\uc7a5 \ud48d\ubd80. </p> <p>(4) Xen + DRAKVUF \uc5d4\uc9c4 + DRAKVUF Sandbox</p> <p>\ud750\ub984/\uad6c\uc870</p> <p>\u2462\uc758 Xen/VMI \uae30\ubc18 \uc704\uc5d0 DRAKVUF \uc5d4\uc9c4\uc744 \uc62c\ub824 \uc5d0\uc774\uc804\ud2b8 \uc5c6\ub294 \ud2b8\ub808\uc774\uc2f1(syscall, \ud30c\uc77c/\ub808\uc9c0\uc2a4\ud2b8\ub9ac, \ud504\ub85c\uc138\uc2a4, \uba54\ubaa8\ub9ac \ub364\ud504 \ub4f1)\uc744 \uc218\ud589.</p> <p>DRAKVUF Sandbox(drakkvuf-sandbox) \ub294 \uadf8 \uc5d4\uc9c4\uc744 \uc790\ub3d9\ud654/\uc6f9UI/\ud050/\uc2a4\ub0c5\uc0f7 \ud15c\ud50c\ub9bf\ub85c \uac10\uc2fc \uc790\ub3d9 \ubd84\uc11d \ud30c\uc774\ud504\ub77c\uc778. \uc124\uce58\ub3c4 \u201cXen\uacfc DRAKVUF \uc5d4\uc9c4\uc744 \uba3c\uc800 \uc900\ube44\u201d\uac00 1\ub2e8\uacc4. </p> <p>\uac00\ub2a5\ud55c \uae30\ub2a5</p> <p>\ub300\ub7c9 \uc790\ub3d9 \uc0cc\ub4dc\ubc15\uc2f1(\uc2dc\ub8cc \uc5c5\ub85c\ub4dc\u2192\uc2e4\ud589\u2192\ud589\uc704 \uc218\uc9d1\u2192\ub9ac\ud3ec\ud2b8), \ud504\ub85c\uc138\uc2a4/\uc2dc\uc2a4\ud15c\ucf5c/\ud30c\uc77c\u00b7\ub124\ud2b8\uc6cc\ud06c\u00b7\uc2a4\ub0c5\uc0f7/\uc2a4\ud06c\ub9b0\uc0f7 \uc218\uc9d1 \ub4f1. \ubc18\uba74, \uc784\uc758 \uc8fc\uc18c \uc989\uc2dc \ud328\uce58 \uac19\uc740 \ubbf8\uc138 \uc870\uc791\uc740 \uae30\ubcf8 \uc6cc\ud06c\ud50c\ub85c\uac00 \uc544\ub2d8(\uc5d4\uc9c4/LibVMI API\ub85c \uad6c\ud604\uc740 \uac00\ub2a5). </p> <p>\ud638\ud658/\ud604\uc2e4\uc131(2025)</p> <p>\ud558\ub4dc\uc6e8\uc5b4 \uc694\uad6c: Intel VT-x + EPT \ud544\uc218(AMD \ubbf8\uc9c0\uc6d0) \ub97c \uba85\uc2dc. \ucd5c\uc2e0 Intel CPU\ub77c\uba74 \ub300\uccb4\ub85c OK. \uc0cc\ub4dc\ubc15\uc2a4 \ubb38\uc11c\ub3c4 CPU \ud655\uc778 \ubc29\ubc95(vmxept \ud50c\ub798\uadf8)\uacfc \uc18c\uc2a4 \ube4c\ub4dc \uad8c\uc7a5\uc744 \uc548\ub0b4. \uad6c\ucd95 \ub09c\uc774\ub3c4\ub294 \u2462\ubcf4\ub2e4 \ud55c \ub2e8\uacc4 \ub192\uc74c(\uc5d4\uc9c4+\uc6f9 \uc2a4\ud0dd+\uc2a4\ub0c5\uc0f7 \ud15c\ud50c\ub9bf).</p>"},{"location":"8-kvm-legacy/","title":"8 kvm legacy","text":""},{"location":"8-kvm-legacy/#kvm-vmi","title":"kvm \ub808\uac70\uc2dc \ubc29\uc2dd\uc73c\ub85c vmi\ub97c \uad6c\ud604\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-02</p>"},{"location":"8-kvm-legacy/#libvmi","title":"libvmi \ub77c\uc774\ube0c\ub7ec\ub9ac \uc124\uce58","text":"<p>libvmi = vmi\ub97c \uc704\ud55c c \ub77c\uc774\ube0c\ub7ec\ub9ac</p> <p>libvmi \uc124\uce58 <pre><code>git clone https://github.com/libvmi/libvmi.git\ncd libvmi\nmkdir build\ncd build\ncmake .. -DENABLE_KVM=ON -DENABLE_KVM_LEGACY=ON -DENABLE_XEN=OFF -DCMAKE_BUILD_TYPE=Release\nmake -j$(nproc)\nsudo make install &amp;&amp; sudo ldconfig    # \uc124\uce58\uc640 \ub77c\uc774\ube0c\ub7ec\ub9ac \uac31\uc2e0\n</code></pre></p> <p>conf \ud30c\uc77c \uc0dd\uc131 <pre><code>sudo nano /etc/libvmi.conf\nwin10 {\n    driver = \"kvm\";\n    ostype = \"Windows\";\n}\n</code></pre></p>"},{"location":"8-kvm-legacy/#volatility3","title":"volatility3 \ud234 \uc124\uce58","text":"<p>volatility3 = \ud504\ub85c\ud30c\uc77c \ub9cc\ub4e4\uae30 \uc804\uc6a9 \ud234</p> <p>\uc804\uc6a9 \uac00\uc0c1\ud658\uacbd \ub9cc\ub4e4\uae30 <pre><code>sudo apt install -y python3-venv\npython3 -m venv ~/vol3env       # \uac00\uc0c1\ud658\uacbd \uc0dd\uc131\nsource ~/vol3env/bin/activate   # \ud604\uc7ac \uc258\uc758 path\uac00 vol3env \uc544\ub798\ub97c \ubc14\ub77c\ubcf4\ub3c4\ub85d \ud558\uc5ec \uac00\uc0c1\ud658\uacbd \uc9c4\uc785(\ud65c\uc131\ud654) \ud130\ubbf8\ub110\ub9c8\ub2e4\ndeactivate                      # \uac00\uc0c1\ud658\uacbd \uc885\ub8cc\npython3 -m venv --clear ~/vol3env   # vol3env \uc804\uccb4\ub97c \uc9c0\uc6c0\n</code></pre> * \uc2dc\uc2a4\ud15c \ud30c\uc774\uc36c(/usr/lib/python)\uacfc \uc11e\uc5ec \ubc84\uc804, \uc758\uc874\uc131\uc774 \ucda9\ub3cc\ud560\uae4c\ubd10</p> <p>volatility3 \uc124\uce58 <pre><code>pip install --upgrade pip        # apt\ub294 \uc6b0\ubd84\ud22c \ud328\ud0a4\uc9c0, pip\uc740 \ud30c\uc774\uc36c \ud328\ud0a4\uc9c0\npip install volatility3          # \ucd5c\uc2e0 \uc548\uc815\ud310 2.26.0\uc774 \uc124\uce58\ub428\nvol -h            # \ub3c4\uc6c0\ub9d0\uc774 \ub728\uba74 \uc815\uc0c1\n</code></pre></p>"},{"location":"8-kvm-legacy/#guid","title":"GUID \uc54c\uc544\uc624\uae30","text":"<p>GUID = \ucee4\ub110 \ubc14\uc774\ub108\ub9ac \uc9c0\ubb38</p> <p>vmi-win-guid <pre><code>$ echo 0 | sudo tee /proc/sys/kernel/yama/ptrace_scope        # \uad8c\ud55c \uc5f4\uc5b4\ub450\uae30\n$ sudo vmi-win-guid name win10\nWindows Kernel found @ 0x3800000\n    Version: 64-bit Windows 10\n    PE GUID: 7feeb8781046000\n    PDB GUID: 495e39042a6983378cbd822feb4e91ed1\n    Kernel filename: ntkrnlmp.pdb\n    Multi-processor without PAE\n    Signature: 17744.\n    Machine: 34404.\n    # of sections: 33.\n    # of symbols: 0.\n    Timestamp: 2146351224.\n    Characteristics: 34.\n    Optional header size: 240.\n    Optional header type: 0x20b\n    Section 1: .rdata\n    Section 2: .pdata\n    Section 3: .idata\n    Section 4: .edata\n    Section 5: PROTDATA\n    Section 6: GFIDS\n    Section 7: Pad1\n    Section 8: .text\n    Section 9: PAGE\n    Section 10: PAGELK\n    Section 11: POOLCODE\n    Section 12: PAGEKD\n    Section 13: PAGEVRFY\n    Section 14: PAGEHDLS\n    Section 15: PAGEBGFX\n    Section 16: INITKDBG\n    Section 17: TRACESUP\n    Section 18: KVASCODE\n    Section 19: RETPOL\n    Section 20: MINIEX\n    Section 21: INIT\n    Section 22: Pad2\n    Section 23: .data\n    Section 24: ALMOSTRO\n    Section 25: CACHEALI\n    Section 26: PAGEDATA\n    Section 27: PAGEVRFD\n    Section 28: INITDATA\n    Section 29: Pad3\n    Section 30: CFGRO\n    Section 31: Pad4\n    Section 32: .rsrc\n    Section 33: .reloc\n</code></pre> * sudo vmi-win-guid name win10 \ub294 \uba54\ubaa8\ub9ac\uc5d0 \uc801\uc7ac\ub41c ntoskrnl.exe \uc758 PE \ud5e4\ub354\ub97c \uc2a4\uce94\ud574\uc11c \u201cPDB GUID + Age\u201d \uac12\uc744 \ucd9c\ub825\ub9cc \ud574 \uc8fc\ub294 \ub3c4\uad6c</p>"},{"location":"8-kvm-legacy/#json","title":"JSON \ud504\ub85c\ud30c\uc77c \ub9cc\ub4e4\uae30","text":"<p>\uc55e\uc5d0\uc11c \ucc3e\uc740 PDB GUID \uac12\ub9cc \ub123\uc5b4\uc8fc\uba74 \ub41c\ub2e4.</p> <p>PDB \ubc1b\uace0 JSON \ubcc0\ud658 <pre><code>$ python3 -m volatility3.framework.symbols.windows.pdbconv \\\n  -p ntkrnlmp.pdb \\                                 # \ud30c\uc77c \uc774\ub984\n  -g 495e39042a6983378cbd822feb4e91ed1 \\            # GUID+AGE \uac12\n  -o ntkrnlmp-19045.json                            # \uacb0\uacfc\ubb3c\n</code></pre> * \uc778\ud130\ub137\uc774 \uc5f0\uacb0\ub3fc \uc788\uc73c\uba74 pdbconv\uac00 MS \uc11c\ubc84\uc5d0\uc11c PDB\ub97c \ub0b4\ub824\ubc1b\uc544 \ubc14\ub85c JSON\uc73c\ub85c \ubcc0\ud658\ud574 \uc900\ub2e4. * DRAKVUF sandbox\ub77c\ub294 \uc804\uccb4 \uc790\ub3d9\ud654 \ud234\uc774 \uc788\uc74c. \uadfc\ub370 intel cpu + \uc6b0\ubd84\ud22c 22.04 + xen \uc804\uc6a9\uc784.</p> <p>conf \ud30c\uc77c\uc5d0 \ucd94\uac00 <pre><code>$ sudo nano /etc/libvmi.conf\nwin10 {\n    driver = \"kvm\";\n    ostype = \"Windows\";\n    json = \"/home/kkongnyang2/ntkrnlmp-19045.json\"\n}\n</code></pre></p> <p>\ucc38\uace0\ub85c JSON\uc740 \u201cEPROCESS -&gt; DirectoryTableBase \uc624\ud504\uc14b = 0x28C\u201d \uac19\uc740 \uad6c\uc870\uccb4\u00b7\uc2ec\ubcfc \uc0c1\ub300 \uc624\ud504\uc14b\ub9cc \ub2f4\uace0, \uc808\ub300 \uc8fc\uc18c\ub294 \ub7f0\ud0c0\uc784 \uacc4\uc0b0\uc5d0 \ub9e1\uae34\ub2e4. Base Address, CR3/DTB \uac12, \ubb3c\ub9ac \uc8fc\uc18c \ub9e4\ud551 \uc804\ubd80 \ub7f0\ud0c0\uc784\uc5d0 \uacb0\uc815\ub418\uae30 \ub54c\ubb38\uc774\ub2e4.</p>"},{"location":"8-kvm-legacy/#pyvmi","title":"pyvmi \ubc14\uc778\ub529","text":"<p>pyvmi = vmi\ub97c \uc704\ud55c python \ud655\uc7a5 \ubaa8\ub4c8</p> <p>pyvmi \uc124\uce58 <pre><code># \ube4c\ub4dc \ub3c4\uad6c\uc640 \uc758\uc874\uc131 \uc124\uce58\n$ sudo apt install build-essential python3-dev libffi-dev \\\n                 libglib2.0-dev libjson-c-dev pkg-config git\n$ python -m pip install --upgrade pip setuptools wheel pycparser cffi\n# \uc18c\uc2a4\ud310 \uc124\uce58(pip\uc73c\ub85c \ub9cc\ub4e4\uc5b4\uc9c0\ub294 \uaca9\ub9ac\ub97c \ub9c9\uc544 vol3env\uc5d0 \uc124\uce58\ub41c \ud328\ud0a4\uc9c0 \ucc38\uc870 \uac00\ub2a5)\n$ python -m pip install --no-build-isolation \"git+https://github.com/libvmi/python.git#egg=libvmi\"\n</code></pre></p> <p>python \ucf54\ub4dc <pre><code>$ mkdir -p ~/scripts\n$ nano ~/scripts/vm_readmem.py\n#!/usr/bin/env python3\nfrom libvmi import Libvmi\nimport sys, struct\n\nVM_NAME   = \"win10\"          # libvirt \uc774\ub984\nPROC_NAME = \"notepad.exe\"    # \ucc3e\uc744 \ud504\ub85c\uc138\uc2a4\nTARGET_VA = 0x7ffe0000       # \uc608: SharedUserData\n\nvmi = Libvmi(VM_NAME)        # utils \uc5c6\uc774\ub3c4 attach OK\n\n# ---- JSON\uc5d0\uc11c \ud544\ub4dc offset \uac00\uc838\uc624\uae30 ----\noff_eproc_links = vmi.get_offset(\"WinEPROCESS\", \"ActiveProcessLinks\")\noff_eproc_name  = vmi.get_offset(\"WinEPROCESS\", \"ImageFileName\")\noff_eproc_pid   = vmi.get_offset(\"WinEPROCESS\", \"UniqueProcessId\")\noff_eproc_dtb   = vmi.get_offset(\"WinEPROCESS\", \"DirectoryTableBase\")\n\n# ---- PsActiveProcessHead \u2192 EPROCESS \ub9ac\uc2a4\ud2b8 \uc21c\ud68c ----\nhead = vmi.translate_ksym2v(\"PsActiveProcessHead\")\ncur  = vmi.read_addr_va(head, 0, 0)         # LIST_ENTRY-&gt;Flink\n\nfound = False\nwhile True:\n    eproc = cur - off_eproc_links           # LIST_ENTRY \uc5d0\uc11c \uad6c\uc870\uccb4 \uae30\uc900 \uc8fc\uc18c \uacc4\uc0b0\n    name  = vmi.read_str_va(eproc + off_eproc_name, 15, 0).decode(errors=\"ignore\")\n    if name.lower() == PROC_NAME:\n        pid = vmi.read_32_va(eproc + off_eproc_pid, 0)\n        dtb = vmi.read_64_va(eproc + off_eproc_dtb, 0)\n        found = True\n        break\n    cur = vmi.read_addr_va(cur, 0, 0)       # \ub2e4\uc74c \ub178\ub4dc\n    if cur == head:\n        break                               # \ub9ac\uc2a4\ud2b8 \ud55c \ubc14\ud034\n\nif not found:\n    vmi.destroy()\n    sys.exit(f\"{PROC_NAME} not found\")\n\n# ---- \uc6d0\ud558\ub294 \uac00\uc0c1 \uc8fc\uc18c \uc77d\uae30 ----\nphys = vmi.virtual_to_physical(TARGET_VA, dtb)\ndata = vmi.read(phys, 32)\n\nprint(f\"[+] {PROC_NAME} PID={pid}  DTB={hex(dtb)}\")\nprint(f\"[+] {hex(TARGET_VA)} -&gt; {data.hex()}\")\nvmi.destroy()\n$ chmod +x ~/scripts/vm_readmem.py\n$ sudo ~/scripts/vm_readmem.py\n</code></pre></p> <p>\u26a0\ufe0f \uc2e4\ud328. conf\ub97c \ubabb\uc77d\ub294 \uc774\uc288. conf \ud615\uc2dd \uc54c\uc544\ub0c8\uc73c\ub2c8 \ud574\uacb0 \ub420\ub4ef?</p>"},{"location":"9-kvmi-v12/","title":"9 kvmi v12","text":""},{"location":"9-kvmi-v12/#kvmi-vmi","title":"KVMI \ubc29\uc2dd\uc73c\ub85c vmi\ub97c \uad6c\ud604\ud574\ubcf4\uc790","text":"<p>\uc791\uc131\uc790: kkongnyang2 \uc791\uc131\uc77c: 2025-08-10</p>"},{"location":"9-kvmi-v12/#kvmi","title":"KVMI \uc18c\uc2a4","text":"<pre><code>git clone https://github.com/KVM-VMI/kvm-vmi.git --recursive\ncd kvm-vmi\ngit submodule update --init\n\n# \uac01 \uc11c\ube0c\ubaa8\ub4c8\uc744 v12 \ube0c\ub79c\uce58\ub85c\ncd kvm     &amp;&amp; git checkout kvmi-v12 &amp;&amp; cd ..\ncd qemu    &amp;&amp; git checkout kvmi-v12 &amp;&amp; cd ..\n</code></pre>"},{"location":"9-kvmi-v12/#_1","title":"\ucee4\ub110","text":"<p>\uae30\ubcf8 6.14.0-27-generic \ucee4\ub110 (\ucee4\ub110\uc774\ubbf8\uc9c0+\ud30c\uc77c\uc2dc\uc2a4\ud15c)\uc774 \uc544\ub2cc kvmi\uac00 \ud328\uce58\ub41c \ucee4\ub110\uc744 \ub9cc\ub4e4\uc5b4\uc918\uc57c \ud55c\ub2e4. 5.15.0-rc2-kvmi+ \ub97c \ub9cc\ub4e4\uc5b4\uc8fc\uc790.</p> <p>kvmi \ucee4\ub110 \uc774\ubbf8\uc9c0 \ub9cc\ub4e4\uae30 <pre><code>$ sudo apt-get install -y bc fakeroot flex bison libelf-dev libssl-dev dwarves\n\n$ cd kvm-vmi/kvm\n$ cp /boot/config-$(uname -r) .config\n\n# \uc11c\uba85\ud0a4/\ub9ac\ubcf5\ud0a4 \uc81c\uac70, KVM+KVMI \ucf1c\uae30, \ud22c\uba85 Hugepage \ub044\uae30, \uc6b0\ubd84\ud22c \ud638\ud658\n$ ./scripts/config --disable SYSTEM_TRUSTED_KEYS\n$ ./scripts/config --disable SYSTEM_REVOCATION_KEYS\n$ ./scripts/config --module KVM\n$ ./scripts/config --module KVM_INTEL\n$ ./scripts/config --module KVM_AMD\n$ ./scripts/config --enable KVM_INTROSPECTION\n$ ./scripts/config --disable TRANSPARENT_HUGEPAGE\n$ ./scripts/config --set-str CONFIG_LOCALVERSION -kvmi\n$ ./scripts/config --enable PREEMPT\n\n# \uc800\uc7a5\uc7a5\uce58/USB \ucee8\ud2b8\ub864\ub7ec(\ub8e8\ud2b8 \ub514\uc2a4\ud06c \uc778\uc2dd\uc6a9) \ud655\uc2e4\ud788 \ucf1c\ub450\uae30\n$ ./scripts/config --module VMD\n$ ./scripts/config --module BLK_DEV_NVME\n$ ./scripts/config --module SATA_AHCI\n$ ./scripts/config --module USB_XHCI_HCD\n\n# \uc11c\uba85 \ubb38\uc81c \ud574\uacb0\n$ ./scripts/config --disable NET_VENDOR_NETRONOME    # \uc6b0\ubd84\ud22c 22.04\uc6a9 \uba54\ubaa8, 24.04\ub3c4 \uc720\uc0ac\n$ ./scripts/config --disable MODULE_SIG\n$ ./scripts/config --disable MODULE_SIG_ALL\n$ ./scripts/config --undefine MODULE_SIG_KEY\n\n# BTF/\ubaa8\ub4c8 BTF/\ubd84\ud560 BTF \ub044\uae30, DWARF5\ub3c4 \uc548\uc804\ud558\uac8c \ub054 \u2192 DWARF4\ub85c\n$ ./scripts/config --disable DEBUG_INFO_BTF\n$ ./scripts/config --disable DEBUG_INFO_BTF_MODULES\n$ ./scripts/config --disable PAHOLE_HAS_SPLIT_BTF || true\n$ ./scripts/config --disable DEBUG_INFO_DWARF5 || true\n$ ./scripts/config --enable  DEBUG_INFO_DWARF4\n\n$ make olddefconfig\n\n$ make -j\"$(nproc)\" bindeb-pkg WERROR=0 \\\n  KCFLAGS=\"-Wno-error=use-after-free\" \\\n  HOSTCFLAGS=\"-Wno-error=use-after-free\"\n\n$ ls -1 ../linux-image-*.deb ../linux-headers-*.deb\n../linux-headers-5.15.0-rc2-kvmi+_5.15.0-rc2-kvmi+-3_amd64.deb\n../linux-headers-5.4.24-kvmi+_5.4.24-kvmi+-1_amd64.deb\n../linux-image-5.15.0-rc2-kvmi+_5.15.0-rc2-kvmi+-3_amd64.deb\n../linux-image-5.15.0-rc2-kvmi+-dbg_5.15.0-rc2-kvmi+-3_amd64.deb\n../linux-image-5.4.24-kvmi+_5.4.24-kvmi+-1_amd64.deb\n../linux-image-5.4.24-kvmi+-dbg_5.4.24-kvmi+-1_amd64.deb\n\n$ sudo dpkg -i ../linux-image-*-kvmi+_*.deb\n\n$ sudo update-grub\n</code></pre></p> <p>busybox \uc258\uae4c\uc9c0\ub9cc \ub4e4\uc5b4\uac00\uc9d0. \ubb50\uac00 \ubb38\uc81c\ub0d0? Intel VMD(=RST) \uc544\ub798\uc5d0 NVMe\uac00 \ub9e4\ub2ec\ub9b0 \uad6c\uc131\uc774\ub77c\uc11c, \ucee4\ub110\uc774 \uadf8 VMD\uc5d0 \ubd99\uc9c0 \ubabb\ud574 \ub8e8\ud2b8 \ub514\uc2a4\ud06c\ub97c \ubabb \ubcf4\ub294 \uc0c1\ud669.</p> <p>\ube4c\ud2b8\uc778\uc73c\ub85c \uad6c\uc131 <pre><code>cd ~/kvm-vmi/kvm\n\n# \uae30\ubcf8 \uc7a5\uce58 \ud2b8\ub9ac/\ub178\ub4dc\n./scripts/config --enable PCI\n./scripts/config --enable PCIEPORTBUS\n./scripts/config --enable PCI_MSI\n./scripts/config --enable DEVTMPFS\n./scripts/config --enable DEVTMPFS_MOUNT\n./scripts/config --enable BLK_DEV_INITRD\n\n# \uc800\uc7a5\uc7a5\uce58(\ub124 \ub178\ud2b8\ubd81\uc5d0\uc11c NVMe + AHCI + VMD \uac00\ub2a5\uc131 \ubaa8\ub450 \ucee4\ubc84)\n./scripts/config --enable VMD\n./scripts/config --enable NVME_CORE\n./scripts/config --enable BLK_DEV_NVME\n./scripts/config --enable SATA_AHCI\n./scripts/config --enable AHCI_PLATFORM\n\n# \ub8e8\ud2b8 \ud30c\uc77c\uc2dc\uc2a4\ud15c\uc5d0 \ub9de\ucdb0 \ud558\ub098\ub9cc \ube4c\ud2b8\uc778 (\ubcf4\ud1b5 ext4)\n./scripts/config --enable EXT4_FS\n# \ub9cc\uc57d \ub8e8\ud2b8\uac00 btrfs\ub77c\uba74 \uc704 \ub300\uc2e0\n# ./scripts/config --enable BTRFS_FS\n\n# LUKS/LVM\uc774\uba74 \uc774\uac83\ub3c4 \ube4c\ud2b8\uc778\n./scripts/config --enable DM_MOD\n./scripts/config --enable DM_CRYPT\n\n# (\uc120\ud0dd) \ubaa8\ub4c8 \uc555\ucd95 \uc774\uc288 \ud53c\ud558\ub824\uba74 \uc544\uc608 \ubaa8\ub4c8 \uc555\ucd95 \ub044\uae30\n./scripts/config --disable MODULE_COMPRESS\n\n$ grep -E 'CONFIG_(VMD|NVME_CORE|BLK_DEV_NVME|DEVTMPFS|DEVTMPFS_MOUNT|EXT4_FS|BTRFS_FS)=' .config\nCONFIG_VMD=y\nCONFIG_DEVTMPFS=y\nCONFIG_DEVTMPFS_MOUNT=y\nCONFIG_NVME_CORE=y\nCONFIG_BLK_DEV_NVME=y\nCONFIG_EXT4_FS=y\nCONFIG_BTRFS_FS=m\n\nmake olddefconfig\n\nmake -j\"$(nproc)\" bindeb-pkg WERROR=0 \\\n  KCFLAGS=\"-Wno-error=use-after-free\" HOSTCFLAGS=\"-Wno-error=use-after-free\"\n\nsudo dpkg -i ../linux-image-*-kvmi+_*.deb\nsudo update-grub\nsudo reboot\n</code></pre> * \uc774\uac74 \ud574\uacb0\ubc29\ubc95\uc744 \ucc3e\uae30 \uc704\ud574 \ud574\ubd24\ub358 \ubc29\ubc95\uc774\uace0 \ubcc4 \uc758\ubbf8 \uc5c6\uc744 \uac83 \uac19\ub2e4.</p> <p>VMD controller \ub044\uae30 <pre><code>\ubd80\ud305 \uc911 F2\ub85c \ubc14\uc774\uc624\uc2a4 \ub4e4\uc5b4\uac00\uc11c advanced\uc5d0\uc11c main\uc5d0\uc11c ctrl+s \ub204\ub974\uba74 \ud788\ub4e0\uba54\ub274 \ub098\uc634.\n\uac70\uae30\uc11c VMD controller\ub97c \ub044\uba74 NVMe\uac00 \uc9c1\uc811 \ub178\ucd9c\ub418\uace0, \ucee4\ub110\ub3c4 NVMe\ub97c \ubc14\ub85c \ubcf4\uace0 \ubd80\ud305\ub41c\ub2e4.\n</code></pre></p>"},{"location":"9-kvmi-v12/#qemu","title":"qemu \uc124\uce58","text":"<pre><code>sudo apt-get install -y libpixman-1-dev pkg-config zlib1g-dev \\\n  libglib2.0-dev dh-autoreconf libspice-server-dev\n\ncd ~/kvm-vmi/qemu\ngit checkout kvmi-v12\n./configure --target-list=x86_64-softmmu --enable-spice --prefix=/usr/local\nmake -j\"$(nproc)\"\nsudo make install    # /usr/local/bin/qemu-system-x86_64\n</code></pre>"},{"location":"9-kvmi-v12/#libkvmi","title":"libkvmi \uc124\uce58","text":"<pre><code>cd ~/kvm-vmi/libkvmi\n./bootstrap &amp;&amp; ./configure\nmake -j\"$(nproc)\"\nsudo make install\nsudo ldconfig\n</code></pre>"},{"location":"9-kvmi-v12/#vm","title":"vm \uc0dd\uc131","text":"<p>iso \ub2e4\uc6b4\ub85c\ub4dc <pre><code>https://www.microsoft.com/software-download/windows11 \ub4e4\uc5b4\uac00 \uc601\uc5b4(\ubbf8\uad6d) 64\ube44\ud2b8 \ub2e4\uc6b4\ub85c\ub4dc. Win11_24H2_English_x64.iso. \uc708\ub3c4\uc6b0 \uc124\uce58\ub97c \uc704\ud55c DVD \uc5ed\ud560.\n</code></pre></p> <p>vm \uc0dd\uc131 <pre><code>$ virt-manager\n\uc0c8 vm \ub9cc\ub4e4\uae30\nlocal install media - browse - downloads\uc5d0 \uc788\ub294 Win11_24H2_English_x64.iso \uc120\ud0dd. \uc708\ub3c4\uc6b0 11.\n\uba54\ubaa8\ub9ac 16000MB, cpu 10\uac1c\n\uc800\uc7a5\uc18c \ud65c\uc131\ud654. \ub514\uc2a4\ud06c \uc774\ubbf8\uc9c0 160.0GB. \uc774\ub984 win11-2 (\uc704\uce58 /var/lib/libvirt/images/win11-2.qcow2)     # win11-2.qcow2 : \ube48 \ud558\ub4dc\ub514\uc2a4\ud06c.\ncustom \uc120\ud0dd\nOverview\uc5d0\uc11c Q35, UEFI x86_64 : OVMF_CODE_4M.ms.fd \uc120\ud0dd\nCPUs\uc5d0\uc11c host-passthruogh \uccb4\ud06c \ud655\uc778\nAdd hardware - PCI Host Device - 0000:01:00:0\uacfc 0000:01:00:1 \uc120\ud0dd\n\uc644\ub8cc \ud6c4 hdmi \uaf42\uc544\ub193\uace0 \uc124\uce58\n\uacc4\uc815 \uc785\ub825 \ub098\uc624\uba74 shift+f10 \ub204\ub974\uace0 start ms-cxh:localonly. kkongnyang2\uc5d0 \uc554\ud638 4108\n\uc778\ud130\ub137\uc774 \uc5f0\uacb0\ub418\uc5b4 \uc788\uc73c\uba74 \uc708\ub3c4\uc6b0 \ub4dc\ub77c\uc774\ubc84 \uc5c5\ub370\uc774\ud2b8\uae4c\uc9c0 \uc124\uce58 \uacfc\uc815 \uc911\uc5d0 \ud574\uc90c\ndevice manager \ub4e4\uc5b4\uac00 \ub290\ub08c\ud45c \uc5c6\ub294\uc9c0 \ud655\uc778(nvidia\uac00 code43 \uc548\ub728\ub294\uc9c0)\n</code></pre></p>"},{"location":"9-kvmi-v12/#_2","title":"\uc2e4\ud589","text":"<pre><code>./hookguest-libkvmi /tmp/introspector\n\ub2e4\ub978 \uc258\uc5d0\uc11c virsh start win11-2\n</code></pre> <p>\u26a0\ufe0f \uc2e4\ud328. v12\ub294 \uc544\uc9c1 \uc2e4\ud5d8 \ub2e8\uacc4\ub77c\uace0 \ud568. hookguest\uac00 qemu/kvm\uc758 kvmi abi\uc640 \uc11c\ub85c \ub2e4\ub978 \ubc84\uc804\uc774\ub77c api \ud638\ucd9c\uc5d0\uc11c \ubed7\uac8c \ub428.</p>"},{"location":"log/","title":"Log","text":"<p>kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 6256 0x2492C808000-0x2492C808FFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=6256 range=[0x2492c808000..0x2492c808fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x341a78000 [] Armed W-trap: pages=1 registered=1 range=[0x000002492c808000 .. 0x000002492c809000) [W] WRITE trap @0x2492c808bc8 (vcpu=4, gfn=0x12f433) {\"evt\":\"seed_write_pre\",\"ts_us\":1760211868474564,\"vcpu\":4,\"pid\":6256,\"gla\":\"0x2492c808bc8\",\"gfn\":\"0x12f433\",\"dtb\":\"0x341a78000\",\"cr3\":\"0x341a78000\",\"rip\":\"0x7ff755b007ff\",\"rsp\":\"0x783d94e590\",\"rbp\":\"0x783d94e600\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff753ab0000\",\"rip_off\":\"0x20507ff\"},\"gpr\":{\"rax\":\"0xe4\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x2494266a8b8\",\"rdx\":\"0x0\",\"rsi\":\"0x2492c808b30\",\"rdi\":\"0x2471ff20dc8\",\"r8\":\"0x98\",\"r9\":\"0x783d94e680\",\"r10\":\"0x7ff755b007d6\",\"r11\":\"0x783d94e668\",\"r12\":\"0x0\",\"r13\":\"0x247ea51ab40\",\"r14\":\"0x0\",\"r15\":\"0x247f82310a8\"},\"disasm\":{\"rip\":\"0x7ff755b007ff\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x2492c808bc8\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"000000000000000000c722f847020000\",\"post_len\":16,\"post_bytes\":\"fa0000000c000000801d552e49020000\",\"stack_len\":64,\"stack_bytes\":\"066c000007003000000000000000000041db8c052009000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff755b00508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff755b00513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff755b004ff\",\"ctx\":[{\"a\":\"0x7ff755b004ff\",\"mn\":\"add\",\"op\":\"esp, 0x30\"},{\"a\":\"0x7ff755b00502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff755b00503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff755b00504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff755b00508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff755b0050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff755b00510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff755b00513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff755b00516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff755b0051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff755b0051e\",\"mn\":\"call\",\"op\":\"0x7ff755b01780\"},{\"a\":\"0x7ff755b00523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff755b00525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff755b00529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff755b0052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff755b0052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff755b0052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff755b00531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff755b00532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff755b00533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff755b00534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff755b00536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff755b0053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff755b0053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff755b00543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff755b00545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff755b0054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff755b0054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff755b0054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff755b00552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff755b00557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff755b0055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff755b0055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff755b00561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff755b00563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff755b0056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff755b0056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff755b00576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff755b0057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff755b0057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped)</p> <p>\ubca1\ud130 16\ubc14\uc774\ud2b8\ub97c rax+rsi\uc5d0 \uc800\uc7a5.</p> <p>\"0x7ff7da8307ff\"</p> <p>7ff7da9307a1 7ff7da9307ca call 7ff7da82e810</p> <p>7ff7da82e810 7ff7da82e8ef call 7ff7d9f82c60</p> <p>call 7ff7d9f82c60</p> <p>call 7ff7da15ee30</p> <p>call 7ff7d8f38c70</p> <p>jmp 7ff7da82dcd0</p> <p>kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad010 (vcpu=6, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354247171106,\"vcpu\":6,\"pid\":7476,\"gla\":\"0x1ee373ad010\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da830797\",\"rsp\":\"0xcc3237ee30\",\"rbp\":\"0xcc3237eea0\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x2050797\"},\"gpr\":{\"rax\":\"0x30\",\"rbx\":\"0x30000300000006\",\"rcx\":\"0x1ee43d08e98\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0xcc3237ef18\",\"r9\":\"0xcc3237ef20\",\"r10\":\"0x7ff7da83076e\",\"r11\":\"0xcc3237ef08\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da830797\",\"mn\":\"movss\",\"op\":\"dword ptr [rax + rsi], xmm0\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad010\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"f30f110430e99b010000488b45504d8b\",\"pre_len\":16,\"pre_bytes\":\"15000000160000000000000000000000\",\"post_len\":16,\"post_bytes\":\"000000002c36653ac055cf72ec010000\",\"stack_len\":64,\"stack_bytes\":\"024a000014007800000000000000000091b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da830497\",\"ctx\":[{\"a\":\"0x7ff7da8304e1\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da8304e5\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da8304e9\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da8304ec\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da8304ef\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da8304f4\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da8304f7\",\"mn\":\"call\",\"op\":\"0x7ff7da8314a0\"},{\"a\":\"0x7ff7da8304fc\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da8304fe\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad010 (vcpu=5, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354263644886,\"vcpu\":5,\"pid\":7476,\"gla\":\"0x1ee373ad010\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da830797\",\"rsp\":\"0xcc3237f060\",\"rbp\":\"0xcc3237f0d0\",\"rflags\":\"0x10202\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x2050797\"},\"gpr\":{\"rax\":\"0x30\",\"rbx\":\"0x30000300000006\",\"rcx\":\"0x1ee43d08e98\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0xcc3237f148\",\"r9\":\"0xcc3237f150\",\"r10\":\"0x7ff7da83076e\",\"r11\":\"0xcc3237f138\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da830797\",\"mn\":\"movss\",\"op\":\"dword ptr [rax + rsi], xmm0\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad010\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"f30f110430e99b010000488b45504d8b\",\"pre_len\":16,\"pre_bytes\":\"15000000160000000000000000000000\",\"post_len\":16,\"post_bytes\":\"0100d83e2c36653ac055cf72ec010000\",\"stack_len\":64,\"stack_bytes\":\"010e0000020014000000000000000000a1b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da830497\",\"ctx\":[{\"a\":\"0x7ff7da8304e1\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da8304e5\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da8304e9\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da8304ec\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da8304ef\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da8304f4\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da8304f7\",\"mn\":\"call\",\"op\":\"0x7ff7da8314a0\"},{\"a\":\"0x7ff7da8304fc\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da8304fe\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad078 (vcpu=6, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354271043058,\"vcpu\":6,\"pid\":7476,\"gla\":\"0x1ee373ad078\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da8307ff\",\"rsp\":\"0xcc3237edf0\",\"rbp\":\"0xcc3237ee60\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x20507ff\"},\"gpr\":{\"rax\":\"0xfa\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x1ee43d09198\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0x98\",\"r9\":\"0xcc3237eee0\",\"r10\":\"0x7ff7da8307d6\",\"r11\":\"0xcc3237eec8\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da8307ff\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad078\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000e06fba08ed010000\",\"post_len\":16,\"post_bytes\":\"b2000000230b183bb0af7811ee010000\",\"stack_len\":64,\"stack_bytes\":\"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da8304ff\",\"ctx\":[{\"a\":\"0x7ff7da8304ff\",\"mn\":\"add\",\"op\":\"esp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad078 (vcpu=5, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354273374600,\"vcpu\":5,\"pid\":7476,\"gla\":\"0x1ee373ad078\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da8307ff\",\"rsp\":\"0xcc3237eb80\",\"rbp\":\"0xcc3237ebf0\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x20507ff\"},\"gpr\":{\"rax\":\"0xde\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x1ee43d09198\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0x98\",\"r9\":\"0xcc3237ec70\",\"r10\":\"0x7ff7da8307d6\",\"r11\":\"0xcc3237ec58\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da8307ff\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad078\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000e06fba08ed010000\",\"post_len\":16,\"post_bytes\":\"e0000000230b183bb0af7811ee010000\",\"stack_len\":64,\"stack_bytes\":\"010e000004001c00000000000000000091b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da8304ff\",\"ctx\":[{\"a\":\"0x7ff7da8304ff\",\"mn\":\"add\",\"op\":\"esp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad010 (vcpu=6, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354274903921,\"vcpu\":6,\"pid\":7476,\"gla\":\"0x1ee373ad010\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da830797\",\"rsp\":\"0xcc3237eaa0\",\"rbp\":\"0xcc3237eb10\",\"rflags\":\"0x10202\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x2050797\"},\"gpr\":{\"rax\":\"0x30\",\"rbx\":\"0x30000300000006\",\"rcx\":\"0x1ee43d08e98\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0xcc3237eb88\",\"r9\":\"0xcc3237eb90\",\"r10\":\"0x7ff7da83076e\",\"r11\":\"0xcc3237eb78\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da830797\",\"mn\":\"movss\",\"op\":\"dword ptr [rax + rsi], xmm0\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad010\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"f30f110430e99b010000488b45504d8b\",\"pre_len\":16,\"pre_bytes\":\"15000000160000000000000000000000\",\"post_len\":16,\"post_bytes\":\"0100803d2c36653ac055cf72ec010000\",\"stack_len\":64,\"stack_bytes\":\"010e000002001400000000000000000091b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da830497\",\"ctx\":[{\"a\":\"0x7ff7da8304e1\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da8304e5\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da8304e9\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da8304ec\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da8304ef\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da8304f4\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da8304f7\",\"mn\":\"call\",\"op\":\"0x7ff7da8314a0\"},{\"a\":\"0x7ff7da8304fc\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da8304fe\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad010 (vcpu=2, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354277115623,\"vcpu\":2,\"pid\":7476,\"gla\":\"0x1ee373ad010\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da830797\",\"rsp\":\"0xcc3237f020\",\"rbp\":\"0xcc3237f090\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x2050797\"},\"gpr\":{\"rax\":\"0x30\",\"rbx\":\"0x30000300000006\",\"rcx\":\"0x1ee43d08e98\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0xcc3237f108\",\"r9\":\"0xcc3237f110\",\"r10\":\"0x7ff7da83076e\",\"r11\":\"0xcc3237f0f8\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da830797\",\"mn\":\"movss\",\"op\":\"dword ptr [rax + rsi], xmm0\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad010\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"f30f110430e99b010000488b45504d8b\",\"pre_len\":16,\"pre_bytes\":\"15000000160000000000000000000000\",\"post_len\":16,\"post_bytes\":\"02001c3f2c36653ac055cf72ec010000\",\"stack_len\":64,\"stack_bytes\":\"010e000002001400000000000000000091b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da830497\",\"ctx\":[{\"a\":\"0x7ff7da8304e1\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da8304e5\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da8304e9\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da8304ec\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da8304ef\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da8304f4\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da8304f7\",\"mn\":\"call\",\"op\":\"0x7ff7da8314a0\"},{\"a\":\"0x7ff7da8304fc\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da8304fe\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad010 (vcpu=7, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354280284472,\"vcpu\":7,\"pid\":7476,\"gla\":\"0x1ee373ad010\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da830797\",\"rsp\":\"0xcc3237ed20\",\"rbp\":\"0xcc3237ed90\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x2050797\"},\"gpr\":{\"rax\":\"0x30\",\"rbx\":\"0x30000300000006\",\"rcx\":\"0x1ee43d08e98\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0xcc3237ee08\",\"r9\":\"0xcc3237ee10\",\"r10\":\"0x7ff7da83076e\",\"r11\":\"0xcc3237edf8\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da830797\",\"mn\":\"movss\",\"op\":\"dword ptr [rax + rsi], xmm0\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad010\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"f30f110430e99b010000488b45504d8b\",\"pre_len\":16,\"pre_bytes\":\"15000000160000000000000000000000\",\"post_len\":16,\"post_bytes\":\"0100e83e2c36653ac055cf72ec010000\",\"stack_len\":64,\"stack_bytes\":\"010e000002001400000000000000000081b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da830497\",\"ctx\":[{\"a\":\"0x7ff7da8304e1\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da8304e5\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da8304e9\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da8304ec\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da8304ef\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da8304f4\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da8304f7\",\"mn\":\"call\",\"op\":\"0x7ff7da8314a0\"},{\"a\":\"0x7ff7da8304fc\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da8304fe\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad010 (vcpu=6, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354281846113,\"vcpu\":6,\"pid\":7476,\"gla\":\"0x1ee373ad010\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da830797\",\"rsp\":\"0xcc3237eeb0\",\"rbp\":\"0xcc3237ef20\",\"rflags\":\"0x10202\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x2050797\"},\"gpr\":{\"rax\":\"0x30\",\"rbx\":\"0x30000300000006\",\"rcx\":\"0x1ee43d08e98\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0xcc3237ef98\",\"r9\":\"0xcc3237efa0\",\"r10\":\"0x7ff7da83076e\",\"r11\":\"0xcc3237ef88\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da830797\",\"mn\":\"movss\",\"op\":\"dword ptr [rax + rsi], xmm0\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad010\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"f30f110430e99b010000488b45504d8b\",\"pre_len\":16,\"pre_bytes\":\"15000000160000000000000000000000\",\"post_len\":16,\"post_bytes\":\"0100043f2c36653ac055cf72ec010000\",\"stack_len\":64,\"stack_bytes\":\"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da830497\",\"ctx\":[{\"a\":\"0x7ff7da8304e1\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da8304e5\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da8304e9\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da8304ec\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da8304ef\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da8304f4\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da8304f7\",\"mn\":\"call\",\"op\":\"0x7ff7da8314a0\"},{\"a\":\"0x7ff7da8304fc\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da8304fe\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD000-0x1EE373ADFFF 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad000..0x1ee373adfff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad078 (vcpu=5, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354284450410,\"vcpu\":5,\"pid\":7476,\"gla\":\"0x1ee373ad078\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da8307ff\",\"rsp\":\"0xcc3237eab0\",\"rbp\":\"0xcc3237eb20\",\"rflags\":\"0x10202\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x20507ff\"},\"gpr\":{\"rax\":\"0x97\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x1ee43d09198\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0x98\",\"r9\":\"0xcc3237eba0\",\"r10\":\"0x7ff7da8307d6\",\"r11\":\"0xcc3237eb88\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da8307ff\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad078\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000e06fba08ed010000\",\"post_len\":16,\"post_bytes\":\"98000000230b183bb0af7811ee010000\",\"stack_len\":64,\"stack_bytes\":\"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da8304ff\",\"ctx\":[{\"a\":\"0x7ff7da8304ff\",\"mn\":\"add\",\"op\":\"esp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD078-0x1EE373AD079 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad078..0x1ee373ad079) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [] Watch timeout (5006 ms) [] Done. (no write) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD078-0x1EE373AD079 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad078..0x1ee373ad079) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad078 (vcpu=7, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354392599450,\"vcpu\":7,\"pid\":7476,\"gla\":\"0x1ee373ad078\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da8307ff\",\"rsp\":\"0xcc3237ed90\",\"rbp\":\"0xcc3237ee00\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x20507ff\"},\"gpr\":{\"rax\":\"0xde\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x1ee43d09198\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0x98\",\"r9\":\"0xcc3237ee80\",\"r10\":\"0x7ff7da8307d6\",\"r11\":\"0xcc3237ee68\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da8307ff\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad078\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000e06fba08ed010000\",\"post_len\":16,\"post_bytes\":\"e9000000230b183bb0af7811ee010000\",\"stack_len\":64,\"stack_bytes\":\"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da8304ff\",\"ctx\":[{\"a\":\"0x7ff7da8304ff\",\"mn\":\"add\",\"op\":\"esp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD078-0x1EE373AD079 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad078..0x1ee373ad079) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad078 (vcpu=5, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354500797480,\"vcpu\":5,\"pid\":7476,\"gla\":\"0x1ee373ad078\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da8307ff\",\"rsp\":\"0xcc3237ea30\",\"rbp\":\"0xcc3237eaa0\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x20507ff\"},\"gpr\":{\"rax\":\"0xe2\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x1ee43d09198\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0x98\",\"r9\":\"0xcc3237eb20\",\"r10\":\"0x7ff7da8307d6\",\"r11\":\"0xcc3237eb08\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da8307ff\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad078\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000e06fba08ed010000\",\"post_len\":16,\"post_bytes\":\"e3000000230b183bb0af7811ee010000\",\"stack_len\":64,\"stack_bytes\":\"024a0000090058000000000000000000b1b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da8304ff\",\"ctx\":[{\"a\":\"0x7ff7da8304ff\",\"mn\":\"add\",\"op\":\"esp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD078-0x1EE373AD079 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad078..0x1ee373ad079) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad078 (vcpu=5, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354506902716,\"vcpu\":5,\"pid\":7476,\"gla\":\"0x1ee373ad078\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da8307ff\",\"rsp\":\"0xcc3237efb0\",\"rbp\":\"0xcc3237f020\",\"rflags\":\"0x10202\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x20507ff\"},\"gpr\":{\"rax\":\"0xcc\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x1ee43d09198\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0x98\",\"r9\":\"0xcc3237f0a0\",\"r10\":\"0x7ff7da8307d6\",\"r11\":\"0xcc3237f088\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da8307ff\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad078\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000e06fba08ed010000\",\"post_len\":16,\"post_bytes\":\"cd000000230b183bb0af7811ee010000\",\"stack_len\":64,\"stack_bytes\":\"024a000009005800000000000000000091b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da8304ff\",\"ctx\":[{\"a\":\"0x7ff7da8304ff\",\"mn\":\"add\",\"op\":\"esp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 7476 0x1EE373AD078-0x1EE373AD079 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=7476 range=[0x1ee373ad078..0x1ee373ad079) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x280910000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ee373ad000 .. 0x000001ee373ae000) [W] WRITE trap @0x1ee373ad078 (vcpu=5, gfn=0x6035c) {\"evt\":\"seed_write_pre\",\"ts_us\":1760354514842908,\"vcpu\":5,\"pid\":7476,\"gla\":\"0x1ee373ad078\",\"gfn\":\"0x6035c\",\"dtb\":\"0x280910000\",\"cr3\":\"0x280910000\",\"rip\":\"0x7ff7da8307ff\",\"rsp\":\"0xcc3237eba0\",\"rbp\":\"0xcc3237ec10\",\"rflags\":\"0x10202\",\"module\":{\"base\":\"0x7ff7d87e0000\",\"rip_off\":\"0x20507ff\"},\"gpr\":{\"rax\":\"0xf8\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x1ee43d09198\",\"rdx\":\"0x0\",\"rsi\":\"0x1ee373acfe0\",\"rdi\":\"0x1ec64200dc8\",\"r8\":\"0x98\",\"r9\":\"0xcc3237ec90\",\"r10\":\"0x7ff7da8307d6\",\"r11\":\"0xcc3237ec78\",\"r12\":\"0x0\",\"r13\":\"0x1ec620eab40\",\"r14\":\"0x0\",\"r15\":\"0x1ec72d15060\"},\"disasm\":{\"rip\":\"0x7ff7da8307ff\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ee373ad078\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000e06fba08ed010000\",\"post_len\":16,\"post_bytes\":\"f3000000230b183bb0af7811ee010000\",\"stack_len\":64,\"stack_bytes\":\"010e000004001c00000000000000000091b5e7cab107000000000000000000000000000000000000000000000000000000000000000000000000000000000000\",\"origin\":{\"rcx\":{\"addr\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\",\"kind\":\"lea\"},\"rdx\":{\"addr\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\",\"kind\":\"mov\"}},\"backtrace\":{\"start\":\"0x7ff7da8304ff\",\"ctx\":[{\"a\":\"0x7ff7da8304ff\",\"mn\":\"add\",\"op\":\"esp, 0x30\"},{\"a\":\"0x7ff7da830502\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830503\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830504\",\"mn\":\"mov\",\"op\":\"rax, qword ptr [rbp + 0x38]\"},{\"a\":\"0x7ff7da830508\",\"mn\":\"lea\",\"op\":\"rcx, [rbp + 0x10]\"},{\"a\":\"0x7ff7da83050c\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [rbp + 0x30]\"},{\"a\":\"0x7ff7da830510\",\"mn\":\"mov\",\"op\":\"r8, qword ptr [r10]\"},{\"a\":\"0x7ff7da830513\",\"mn\":\"mov\",\"op\":\"rdx, qword ptr [r11]\"},{\"a\":\"0x7ff7da830516\",\"mn\":\"mov\",\"op\":\"qword ptr [rsp + 0x20], rax\"},{\"a\":\"0x7ff7da83051b\",\"mn\":\"mov\",\"op\":\"r9, qword ptr [r9]\"},{\"a\":\"0x7ff7da83051e\",\"mn\":\"call\",\"op\":\"0x7ff7da831780\"},{\"a\":\"0x7ff7da830523\",\"mn\":\"mov\",\"op\":\"al, 1\"},{\"a\":\"0x7ff7da830525\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830529\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da83052a\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da83052b\",\"mn\":\"xor\",\"op\":\"al, al\"},{\"a\":\"0x7ff7da83052d\",\"mn\":\"add\",\"op\":\"rsp, 0x30\"},{\"a\":\"0x7ff7da830531\",\"mn\":\"pop\",\"op\":\"rbp\"},{\"a\":\"0x7ff7da830532\",\"mn\":\"ret\",\"op\":\"\"},{\"a\":\"0x7ff7da830533\",\"mn\":\"nop\",\"op\":\"\"},{\"a\":\"0x7ff7da830534\",\"mn\":\"sub\",\"op\":\"al, 3\"},{\"a\":\"0x7ff7da830536\",\"mn\":\"add\",\"op\":\"eax, 0x5035302\"},{\"a\":\"0x7ff7da83053b\",\"mn\":\"add\",\"op\":\"bh, byte ptr [rdx + 3]\"},{\"a\":\"0x7ff7da83053e\",\"mn\":\"add\",\"op\":\"eax, 0x503a102\"},{\"a\":\"0x7ff7da830543\",\"mn\":\"add\",\"op\":\"cl, al\"},{\"a\":\"0x7ff7da830545\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rip + 0x503ef02]\"},{\"a\":\"0x7ff7da83054b\",\"mn\":\"add\",\"op\":\"dl, byte ptr [rsi]\"},{\"a\":\"0x7ff7da83054d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83054f\",\"mn\":\"add\",\"op\":\"al, byte ptr [rcx + 4]\"},{\"a\":\"0x7ff7da830552\",\"mn\":\"add\",\"op\":\"eax, 0x5046802\"},{\"a\":\"0x7ff7da830557\",\"mn\":\"add\",\"op\":\"cl, byte ptr [rdi - 0x49fdfafc]\"},{\"a\":\"0x7ff7da83055d\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da83055f\",\"mn\":\"add\",\"op\":\"bl, ch\"},{\"a\":\"0x7ff7da830561\",\"mn\":\"add\",\"op\":\"al, 5\"},{\"a\":\"0x7ff7da830563\",\"mn\":\"add\",\"op\":\"al, byte ptr [rax + 0x52b0205]\"},{\"a\":\"0x7ff7da83056a\",\"mn\":\"add\",\"op\":\"eax, 0x2010002\"},{\"a\":\"0x7ff7da83056f\",\"mn\":\"add\",\"op\":\"eax, dword ptr [rax + 0x9080706]\"},{\"a\":\"0x7ff7da830576\",\"mn\":\"add\",\"op\":\"al, byte ptr [rip + 0xb060a0d]\"},{\"a\":\"0x7ff7da83057c\",\"mn\":\"or\",\"op\":\"al, 0xd\"},{\"a\":\"0x7ff7da83057e\",\"mn\":\"or\",\"op\":\"eax, 0x6060d0d\"}]},\"\":\"\"} [*] Done. (seed write trapped)</p> <p>kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v4 win10 14388 0x2390FD081F8-0x2390FD081F9 5000 === seed_once_watch_v4_3 === [] domain=win10 pid=14388 range=[0x2390fd081f8..0x2390fd081f9) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x30534a000 [] Armed W-trap: pages=1 registered=1 range=[0x000002390fd08000 .. 0x000002390fd09000) [] Watch timeout (5000 ms) VMI_ERROR: Caught a memory event that had no handler registered in LibVMI @ GFN 0xaffbf (0xaffbf190), access: 6 [] Done. (no write) kkongnyang2@acer:~/project4$ code . kkongnyang2@acer:~/project4$ sudo xl destroy win10 libxl: warning: libxl_pci.c:2217:pci_remove_timeout: Domain 2:timed out waiting for DM to remove pci-pt-01_00.0 kkongnyang2@acer:~/project4$ sudo xl create /etc/xen/win10-monitor.cfg Parsing config from /etc/xen/win10-monitor.cfg kkongnyang2@acer:~/project4$ sudo xl usbctrl-attach win10 type=auto version=3 ports=15 sudo xl usbdev-attach  win10 hostbus=1 hostaddr=6 controller=0 port=1 sudo xl usbdev-attach  win10 hostbus=1 hostaddr=7 controller=0 port=2 kkongnyang2@acer:~/project4$ sudo vmi-process-list win10 | grep -i overwatch [13372] Overwatch.exe (struct addr:ffffdf82f8347080) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13372 0x1C979DE8000-0x1C979DE8FFF 5000 === seed_once_watch_v3 === [] domain=win10 pid=13372 range=[0x1c979de8000..0x1c979de8fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x283087000 [] Armed W-trap: pages=1 registered=1 range=[0x000001c979de8000 .. 0x000001c979de9000) [W] WRITE trap @0x1c979de8a78 (vcpu=9, gfn=0x1eacb2) {\"evt\":\"seed_write_pre\",\"ts_us\":1760491178125779,\"vcpu\":9,\"pid\":13372,\"gla\":\"0x1c979de8a78\",\"gfn\":\"0x1eacb2\",\"dtb\":\"0x283087000\",\"cr3\":\"0x283087000\",\"rip\":\"0x7ff618164fef\",\"rsp\":\"0x64502ff130\",\"rbp\":\"0x64502ff250\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff6160f0000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1c9c982b301\",\"rbx\":\"0x1c979de8a78\",\"rcx\":\"0xdb\",\"rdx\":\"0x1c979de8a78\",\"rsi\":\"0x1c9c982b308\",\"rdi\":\"0x8\",\"r8\":\"0x64502ff1d0\",\"r9\":\"0x64502ff190\",\"r10\":\"0x64502ff198\",\"r11\":\"0x64502ff1b8\",\"r12\":\"0x1c7948f0dc0\",\"r13\":\"0x1c7948f4460\",\"r14\":\"0x1c7948f3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff618164fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1c979de8a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e1297ae725070000808ade79c9010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"060000000000000010003bc9c7010000808518dcc901000010003bc9c7010000040000000000000074561618f67f000050000000000000007000000000000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13372 0x1C979DE8000-0x1C979DE8FFF 5000 === seed_once_watch_v3 === [] domain=win10 pid=13372 range=[0x1c979de8000..0x1c979de8fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x283087000 [] Armed W-trap: pages=1 registered=1 range=[0x000001c979de8000 .. 0x000001c979de9000) [W] WRITE trap @0x1c979de8a78 (vcpu=0, gfn=0x1eacb2) {\"evt\":\"seed_write_pre\",\"ts_us\":1760491239655183,\"vcpu\":0,\"pid\":13372,\"gla\":\"0x1c979de8a78\",\"gfn\":\"0x1eacb2\",\"dtb\":\"0x283087000\",\"cr3\":\"0x283087000\",\"rip\":\"0x7ff618164fef\",\"rsp\":\"0x64503ff390\",\"rbp\":\"0x64503ff4b0\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff6160f0000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1c9c982b301\",\"rbx\":\"0x1c979de8a78\",\"rcx\":\"0xef\",\"rdx\":\"0x1c979de8a78\",\"rsi\":\"0x1c9c982b308\",\"rdi\":\"0x8\",\"r8\":\"0x64503ff430\",\"r9\":\"0x64503ff3f0\",\"r10\":\"0x64503ff3f8\",\"r11\":\"0x64503ff418\",\"r12\":\"0x1c7948f0dc0\",\"r13\":\"0x1c7948f4460\",\"r14\":\"0x1c7948f3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff618164fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1c979de8a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e1297ae725070000808ade79c9010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"f0affe18f67f000057811518f67f0000000000000000000040ba81c0c9010000100000000100000074561618f67f00000d000100270700000501bf0110000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13372 0x1C979DE8000-0x1C979DE8FFF 5000 === seed_once_watch_v3 === [] domain=win10 pid=13372 range=[0x1c979de8000..0x1c979de8fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x283087000 [] Armed W-trap: pages=1 registered=1 range=[0x000001c979de8000 .. 0x000001c979de9000) [W] WRITE trap @0x1c979de8c00 (vcpu=0, gfn=0x1eacb2) {\"evt\":\"seed_write_pre\",\"ts_us\":1760491248144456,\"vcpu\":0,\"pid\":13372,\"gla\":\"0x1c979de8c00\",\"gfn\":\"0x1eacb2\",\"dtb\":\"0x283087000\",\"cr3\":\"0x283087000\",\"rip\":\"0x7ff61811e10e\",\"rsp\":\"0x64503ff5b0\",\"rbp\":\"0x64503ff679\",\"rflags\":\"0x10242\",\"module\":{\"base\":\"0x7ff6160f0000\",\"rip_off\":\"0x202e10e\"},\"gpr\":{\"rax\":\"0x64503ff6d8\",\"rbx\":\"0x278\",\"rcx\":\"0x1c979de8c08\",\"rdx\":\"0x1c979de8bf8\",\"rsi\":\"0x1c979de8bc0\",\"rdi\":\"0x1c9d3f955e0\",\"r8\":\"0x1\",\"r9\":\"0x64503ff3c0\",\"r10\":\"0x7ff618162ee0\",\"r11\":\"0x64503ff6a0\",\"r12\":\"0x1c7948f0dc0\",\"r13\":\"0x1c7948f3e50\",\"r14\":\"0x1c7f648b5ec\",\"r15\":\"0x64503ff710\"},\"disasm\":{\"rip\":\"0x7ff61811e10e\",\"mn\":\"movss\",\"op\":\"dword ptr [rdx + 8], xmm2\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1c979de8c00\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"f30f11520880791402751ef30f104910\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000000000009e1a0f3f\",\"post_len\":16,\"post_bytes\":\"9e1a0f\",\"stack_len\":64,\"stack_bytes\":\"00003bc9c70100004066e9dcc901000040f83f5064000000f0affe18f67f0000801663ddc90100005bcb1118f67f0000000000000000000040ba81c0c9010000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13372 0x1C979DE8000-0x1C979DE8FFF 5000 === seed_once_watch_v3 === [] domain=win10 pid=13372 range=[0x1c979de8000..0x1c979de8fff) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x283087000 [] Armed W-trap: pages=1 registered=1 range=[0x000001c979de8000 .. 0x000001c979de9000) [W] WRITE trap @0x1c979de8a78 (vcpu=9, gfn=0x1eacb2) {\"evt\":\"seed_write_pre\",\"ts_us\":1760491251289323,\"vcpu\":9,\"pid\":13372,\"gla\":\"0x1c979de8a78\",\"gfn\":\"0x1eacb2\",\"dtb\":\"0x283087000\",\"cr3\":\"0x283087000\",\"rip\":\"0x7ff618164fef\",\"rsp\":\"0x64502ff1f0\",\"rbp\":\"0x64502ff310\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff6160f0000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1c9c982b301\",\"rbx\":\"0x1c979de8a78\",\"rcx\":\"0xe5\",\"rdx\":\"0x1c979de8a78\",\"rsi\":\"0x1c9c982b308\",\"rdi\":\"0x8\",\"r8\":\"0x64502ff290\",\"r9\":\"0x64502ff250\",\"r10\":\"0x64502ff258\",\"r11\":\"0x64502ff278\",\"r12\":\"0x1c7948f0dc0\",\"r13\":\"0x1c7948f4460\",\"r14\":\"0x1c7948f3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff618164fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1c979de8a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e1297ae725070000808ade79c9010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"060000000000000010003bc9c7010000604549ddc901000010003bc9c7010000040000000000000074561618f67f000050000000000000007000000000000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13372 0x1C979DE8A78-0x1C979DE8A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13372 range=[0x1c979de8a78..0x1c979de8a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x283087000 [] Armed W-trap: pages=1 registered=1 range=[0x000001c979de8000 .. 0x000001c979de9000) [W] WRITE trap @0x1c979de8a78 (vcpu=9, gfn=0x1eacb2) {\"evt\":\"seed_write_pre\",\"ts_us\":1760491285293184,\"vcpu\":9,\"pid\":13372,\"gla\":\"0x1c979de8a78\",\"gfn\":\"0x1eacb2\",\"dtb\":\"0x283087000\",\"cr3\":\"0x283087000\",\"rip\":\"0x7ff618164fef\",\"rsp\":\"0x64502ff3e0\",\"rbp\":\"0x64502ff500\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff6160f0000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1c9c982b301\",\"rbx\":\"0x1c979de8a78\",\"rcx\":\"0xe9\",\"rdx\":\"0x1c979de8a78\",\"rsi\":\"0x1c9c982b308\",\"rdi\":\"0x8\",\"r8\":\"0x64502ff480\",\"r9\":\"0x64502ff440\",\"r10\":\"0x64502ff448\",\"r11\":\"0x64502ff468\",\"r12\":\"0x1c7948f0dc0\",\"r13\":\"0x1c7948f4460\",\"r14\":\"0x1c7948f3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff618164fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1c979de8a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e1297ae725070000808ade79c9010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"02eb06022707000057811518f67f0000000000000000000040ba81c0c9010000100000000100000074561618f67f000000eb0602270700000501bf0110000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13372 0x1C979DE8A78-0x1C979DE8A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13372 range=[0x1c979de8a78..0x1c979de8a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x283087000 [] Armed W-trap: pages=1 registered=1 range=[0x000001c979de8000 .. 0x000001c979de9000) [] Watch timeout (5000 ms) VMI_ERROR: Caught a memory event that had no handler registered in LibVMI @ GFN 0x1eacb2 (0x1eacb2c00), access: 6 [] Done. (no write) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13372 0x1C979DE8A78-0x1C979DE8A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13372 range=[0x1c979de8a78..0x1c979de8a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x283087000 [] Armed W-trap: pages=1 registered=1 range=[0x000001c979de8000 .. 0x000001c979de9000) [] Watch timeout (5005 ms) [] Done. (no write) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13372 0x1C979DE8A78-0x1C979DE8A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13372 range=[0x1c979de8a78..0x1c979de8a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x283087000 [] Armed W-trap: pages=1 registered=1 range=[0x000001c979de8000 .. 0x000001c979de9000) [] Watch timeout (5005 ms) [] Done. (no write) kkongnyang2@acer:~/project4$ sudo xl destroy win10 libxl: warning: libxl_pci.c:2217:pci_remove_timeout: Domain 3:timed out waiting for DM to remove pci-pt-01_00.0 kkongnyang2@acer:~/project4$ sudo xl create /etc/xen/win10-monitor.cfg Parsing config from /etc/xen/win10-monitor.cfg kkongnyang2@acer:~/project4$ sudo xl usbctrl-attach win10 type=auto version=3 ports=15 sudo xl usbdev-attach  win10 hostbus=1 hostaddr=6 controller=0 port=1 sudo xl usbdev-attach  win10 hostbus=1 hostaddr=7 controller=0 port=2 kkongnyang2@acer:~/project4$ sudo vmi-process-list win10 | grep -i overwatch [  864] Overwatch.exe (struct addr:ffffc58f1bf0a080) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 864 0x1EC054EA938-0x1EC054EA939 5000 === seed_once_watch_v3 === [] domain=win10 pid=864 range=[0x1ec054ea938..0x1ec054ea939) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x2be189000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec054ea000 .. 0x000001ec054eb000) [W] WRITE trap @0x1ec054ea938 (vcpu=3, gfn=0x8a5a) {\"evt\":\"seed_write_pre\",\"ts_us\":1760491860198110,\"vcpu\":3,\"pid\":864,\"gla\":\"0x1ec054ea938\",\"gfn\":\"0x8a5a\",\"dtb\":\"0x2be189000\",\"cr3\":\"0x2be189000\",\"rip\":\"0x7ff6414a99bf\",\"rsp\":\"0xd9ba4fe820\",\"rbp\":\"0xd9ba4fe890\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x20599bf\"},\"gpr\":{\"rax\":\"0xe7\",\"rbx\":\"0x98001000000008\",\"rcx\":\"0x1ea209eb448\",\"rdx\":\"0x0\",\"rsi\":\"0x1ec054ea8a0\",\"rdi\":\"0x1ea02f00dc8\",\"r8\":\"0x98\",\"r9\":\"0xd9ba4fe910\",\"r10\":\"0x7ff6414a9996\",\"r11\":\"0xd9ba4fe8f8\",\"r12\":\"0x0\",\"r13\":\"0x1eabcd8ab40\",\"r14\":\"0x0\",\"r15\":\"0x1eb01e8d240\"},\"disasm\":{\"rip\":\"0x7ff6414a99bf\",\"mn\":\"mov\",\"op\":\"dword ptr [r8 + rsi], eax\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec054ea938\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"41890430e934010000498b38488d4d20\",\"pre_len\":16,\"pre_bytes\":\"0000000000000000c043e501eb010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"04e3000008004000c80df002ea010000a1921008ac0700000000000000000000230000000800400098086e74ec01000000000000000000000000000000000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo vmi-process-list win10 | grep -i overwatch [sudo] password for kkongnyang2:  [13000] Overwatch.exe (struct addr:ffffc58f193b80c0) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [W] WRITE trap @0x1ec29c98a78 (vcpu=5, gfn=0xe3227) {\"evt\":\"seed_write_pre\",\"ts_us\":1760496257725555,\"vcpu\":5,\"pid\":13000,\"gla\":\"0x1ec29c98a78\",\"gfn\":\"0xe3227\",\"dtb\":\"0x3cbf9c000\",\"cr3\":\"0x3cbf9c000\",\"rip\":\"0x7ff6414c4fef\",\"rsp\":\"0x4a453ff380\",\"rbp\":\"0x4a453ff4a0\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1ec3001d001\",\"rbx\":\"0x1ec29c98a78\",\"rcx\":\"0xee\",\"rdx\":\"0x1ec29c98a78\",\"rsi\":\"0x1ec3001d078\",\"rdi\":\"0x8\",\"r8\":\"0x4a453ff420\",\"r9\":\"0x4a453ff3e0\",\"r10\":\"0x4a453ff3e8\",\"r11\":\"0x4a453ff408\",\"r12\":\"0x1ea115b0dc0\",\"r13\":\"0x1ea115b4460\",\"r14\":\"0x1ea115b3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff6414c4fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec29c98a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e12926a7b0070000808ac929ec010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"0213b0fcaf07000057814b41f67f0000000000000000000040042cffeb010000100000000100000074564c41f67f00000013b0fcaf0700000501550110000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [W] WRITE trap @0x1ec29c98a78 (vcpu=1, gfn=0xe3227) {\"evt\":\"seed_write_pre\",\"ts_us\":1760496271607627,\"vcpu\":1,\"pid\":13000,\"gla\":\"0x1ec29c98a78\",\"gfn\":\"0xe3227\",\"dtb\":\"0x3cbf9c000\",\"cr3\":\"0x3cbf9c000\",\"rip\":\"0x7ff6414c4fef\",\"rsp\":\"0x4a451fef70\",\"rbp\":\"0x4a451ff090\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1ec3001d001\",\"rbx\":\"0x1ec29c98a78\",\"rcx\":\"0xf8\",\"rdx\":\"0x1ec29c98a78\",\"rsi\":\"0x1ec3001d078\",\"rdi\":\"0x8\",\"r8\":\"0x4a451ff010\",\"r9\":\"0x4a451fefd0\",\"r10\":\"0x4a451fefd8\",\"r11\":\"0x4a451feff8\",\"r12\":\"0x1ea115b0dc0\",\"r13\":\"0x1ea115b4460\",\"r14\":\"0x1ea115b3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff6414c4fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec29c98a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e12926a7b0070000808ac929ec010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"f0af3442f67f000057814b41f67f0000000000000000000040042cffeb010000100000000100000074564c41f67f00000d000100af0700000501550110000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [W] WRITE trap @0x1ec29c98a78 (vcpu=1, gfn=0xe3227) {\"evt\":\"seed_write_pre\",\"ts_us\":1760496585792667,\"vcpu\":1,\"pid\":13000,\"gla\":\"0x1ec29c98a78\",\"gfn\":\"0xe3227\",\"dtb\":\"0x3cbf9c000\",\"cr3\":\"0x3cbf9c000\",\"rip\":\"0x7ff6414c4fef\",\"rsp\":\"0x4a451fed10\",\"rbp\":\"0x4a451fee30\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1ec3001d001\",\"rbx\":\"0x1ec29c98a78\",\"rcx\":\"0xef\",\"rdx\":\"0x1ec29c98a78\",\"rsi\":\"0x1ec3001d078\",\"rdi\":\"0x8\",\"r8\":\"0x4a451fedb0\",\"r9\":\"0x4a451fed70\",\"r10\":\"0x4a451fed78\",\"r11\":\"0x4a451fed98\",\"r12\":\"0x1ea115b0dc0\",\"r13\":\"0x1ea115b4460\",\"r14\":\"0x1ea115b3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff6414c4fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec29c98a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e12926a7b0070000808ac929ec010000\",\"post_len\":16,\"post_bytes\":\"ed0000\",\"stack_len\":64,\"stack_bytes\":\"00375b11ea010000f3742a41f67f0000c8105b11ea01000080734e41f67f000070335b11ea01000074564c41f67f0000c00300001c0200000000000000000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [W] WRITE trap @0x1ec29c98a78 (vcpu=4, gfn=0xe3227) {\"evt\":\"seed_write_pre\",\"ts_us\":1760496596322809,\"vcpu\":4,\"pid\":13000,\"gla\":\"0x1ec29c98a78\",\"gfn\":\"0xe3227\",\"dtb\":\"0x3cbf9c000\",\"cr3\":\"0x3cbf9c000\",\"rip\":\"0x7ff6414c4fef\",\"rsp\":\"0x4a453ff410\",\"rbp\":\"0x4a453ff530\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1ec3001d001\",\"rbx\":\"0x1ec29c98a78\",\"rcx\":\"0xee\",\"rdx\":\"0x1ec29c98a78\",\"rsi\":\"0x1ec3001d078\",\"rdi\":\"0x8\",\"r8\":\"0x4a453ff4b0\",\"r9\":\"0x4a453ff470\",\"r10\":\"0x4a453ff478\",\"r11\":\"0x4a453ff498\",\"r12\":\"0x1ea115b0dc0\",\"r13\":\"0x1ea115b4460\",\"r14\":\"0x1ea115b3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff6414c4fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec29c98a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e12926a7b0070000808ac929ec010000\",\"post_len\":16,\"post_bytes\":\"e80000\",\"stack_len\":64,\"stack_bytes\":\"00375b11ea010000f3742a41f67f0000c8105b11ea01000080734e41f67f000070335b11ea01000074564c41f67f0000c00300001c0200000000000000000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [W] WRITE trap @0x1ec29c98a78 (vcpu=2, gfn=0xe3227) {\"evt\":\"seed_write_pre\",\"ts_us\":1760496603103749,\"vcpu\":2,\"pid\":13000,\"gla\":\"0x1ec29c98a78\",\"gfn\":\"0xe3227\",\"dtb\":\"0x3cbf9c000\",\"cr3\":\"0x3cbf9c000\",\"rip\":\"0x7ff6414c4fef\",\"rsp\":\"0x4a452ff260\",\"rbp\":\"0x4a452ff380\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1ec3001d001\",\"rbx\":\"0x1ec29c98a78\",\"rcx\":\"0xf5\",\"rdx\":\"0x1ec29c98a78\",\"rsi\":\"0x1ec3001d078\",\"rdi\":\"0x8\",\"r8\":\"0x4a452ff300\",\"r9\":\"0x4a452ff2c0\",\"r10\":\"0x4a452ff2c8\",\"r11\":\"0x4a452ff2e8\",\"r12\":\"0x1ea115b0dc0\",\"r13\":\"0x1ea115b4460\",\"r14\":\"0x1ea115b3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff6414c4fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec29c98a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e12926a7b0070000808ac929ec010000\",\"post_len\":16,\"post_bytes\":\"f70000\",\"stack_len\":64,\"stack_bytes\":\"00375b11ea010000f3742a41f67f0000c8105b11ea01000080734e41f67f000070335b11ea01000074564c41f67f0000c00300001c0200000000000000000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [W] WRITE trap @0x1ec29c98a78 (vcpu=2, gfn=0xe3227) {\"evt\":\"seed_write_pre\",\"ts_us\":1760496609446132,\"vcpu\":2,\"pid\":13000,\"gla\":\"0x1ec29c98a78\",\"gfn\":\"0xe3227\",\"dtb\":\"0x3cbf9c000\",\"cr3\":\"0x3cbf9c000\",\"rip\":\"0x7ff6414c4fef\",\"rsp\":\"0x4a452ff400\",\"rbp\":\"0x4a452ff520\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1ec3001d001\",\"rbx\":\"0x1ec29c98a78\",\"rcx\":\"0xf7\",\"rdx\":\"0x1ec29c98a78\",\"rsi\":\"0x1ec3001d078\",\"rdi\":\"0x8\",\"r8\":\"0x4a452ff4a0\",\"r9\":\"0x4a452ff460\",\"r10\":\"0x4a452ff468\",\"r11\":\"0x4a452ff488\",\"r12\":\"0x1ea115b0dc0\",\"r13\":\"0x1ea115b4460\",\"r14\":\"0x1ea115b3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff6414c4fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec29c98a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e12926a7b0070000808ac929ec010000\",\"post_len\":16,\"post_bytes\":\"f20000\",\"stack_len\":64,\"stack_bytes\":\"00375b11ea010000f3742a41f67f0000c8105b11ea01000080734e41f67f000070335b11ea01000074564c41f67f0000c00300001c0200000000000000000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [] Watch timeout (5005 ms) [] Done. (no write) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [] Watch timeout (5005 ms) [] Done. (no write) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [W] WRITE trap @0x1ec29c98a78 (vcpu=2, gfn=0xe3227) {\"evt\":\"seed_write_pre\",\"ts_us\":1760496630215241,\"vcpu\":2,\"pid\":13000,\"gla\":\"0x1ec29c98a78\",\"gfn\":\"0xe3227\",\"dtb\":\"0x3cbf9c000\",\"cr3\":\"0x3cbf9c000\",\"rip\":\"0x7ff6414c4fef\",\"rsp\":\"0x4a452ff140\",\"rbp\":\"0x4a452ff260\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1ec3001d001\",\"rbx\":\"0x1ec29c98a78\",\"rcx\":\"0xf7\",\"rdx\":\"0x1ec29c98a78\",\"rsi\":\"0x1ec3001d078\",\"rdi\":\"0x8\",\"r8\":\"0x4a452ff1e0\",\"r9\":\"0x4a452ff1a0\",\"r10\":\"0x4a452ff1a8\",\"r11\":\"0x4a452ff1c8\",\"r12\":\"0x1ea115b0dc0\",\"r13\":\"0x1ea115b4460\",\"r14\":\"0x1ea115b3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff6414c4fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec29c98a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e12926a7b0070000808ac929ec010000\",\"post_len\":16,\"post_bytes\":\"fa0000\",\"stack_len\":64,\"stack_bytes\":\"50f42f454a000000f3742a41f67f0000402ef4b7ea0100007125ac7a0000004c00000000ea01000074564c41f67f0000c00300001c0200000000000000000000\"} [] Done. (seed write trapped) kkongnyang2@acer:~/project4$ sudo ./seed_once_watch_v3_1 win10 13000 0x1EC29C98A78-0x1EC29C98A79 5000 === seed_once_watch_v3 === [] domain=win10 pid=13000 range=[0x1ec29c98a78..0x1ec29c98a79) timeout=5000 ms [] libvmi initialized [+] DTB resolved via vmi_pid_to_dtb: 0x3cbf9c000 [] Armed W-trap: pages=1 registered=1 range=[0x000001ec29c98000 .. 0x000001ec29c99000) [W] WRITE trap @0x1ec29c98a78 (vcpu=2, gfn=0xe3227) {\"evt\":\"seed_write_pre\",\"ts_us\":1760496641883568,\"vcpu\":2,\"pid\":13000,\"gla\":\"0x1ec29c98a78\",\"gfn\":\"0xe3227\",\"dtb\":\"0x3cbf9c000\",\"cr3\":\"0x3cbf9c000\",\"rip\":\"0x7ff6414c4fef\",\"rsp\":\"0x4a452ff390\",\"rbp\":\"0x4a452ff4b0\",\"rflags\":\"0x10206\",\"module\":{\"base\":\"0x7ff63f450000\",\"rip_off\":\"0x2074fef\"},\"gpr\":{\"rax\":\"0x1ec3001d001\",\"rbx\":\"0x1ec29c98a78\",\"rcx\":\"0xd2\",\"rdx\":\"0x1ec29c98a78\",\"rsi\":\"0x1ec3001d078\",\"rdi\":\"0x8\",\"r8\":\"0x4a452ff430\",\"r9\":\"0x4a452ff3f0\",\"r10\":\"0x4a452ff3f8\",\"r11\":\"0x4a452ff418\",\"r12\":\"0x1ea115b0dc0\",\"r13\":\"0x1ea115b4460\",\"r14\":\"0x1ea115b3e50\",\"r15\":\"0x0\"},\"disasm\":{\"rip\":\"0x7ff6414c4fef\",\"mn\":\"mov\",\"op\":\"dword ptr [rdx], ecx\",\"mem_write\":true,\"wkind\":\"store\",\"ea_calc\":\"0x1ec29c98a78\",\"ea_match\":true},\"rip_bytes_len\":16,\"rip_bytes\":\"890a4989104883c428c3498b08488b44\",\"pre_len\":16,\"pre_bytes\":\"e12926a7b0070000808ac929ec010000\",\"post_len\":16,\"post_bytes\":\"cd0000\",\"stack_len\":64,\"stack_bytes\":\"0213b0fcaf070000f5814b41f67f0000000000000000000040042cffeb010000100000000100000074564c41f67f00000013b0fcaf0700000501550110000000\"} [] Done. (seed write trapped)</p>"},{"location":"memo/","title":"Memo","text":"<p>\ubb58 \ub9cc\ub4e4\uace0 \uc2f6\ub0d0?</p> <p>\uc704\uce58\ud575.</p> <p>\ud654\uba74\uc5d0 \ud14c\ud22c\ub9ac \ub80c\ub354\ub9c1.</p> <p>\uadf8\ub9ac\uace0 \uccb4\ub825\ubc14 \ud45c\uc2dc.</p> <p>\uc5d0\uc784\uc744 \ub530\ub77c\uac00\ub294 \uc6d0\ub9ac\ub294 \ubb34\uc5c7\uc778\uac00? \uc74c.. \ub80c\ub354\ub9c1 \uae30\uc900 \uc0c1\ub300\uc758 \ud5e4\ub4dc\uac00 \ub0b4 \uc911\uc559\uc73c\ub85c \uac00\uac8c\ub054 \ub9c8\uc6b0\uc2a4 \uc785\ub825\uac12? \uadf8\uac78 \uc5b4\ub5bb\uac8c? \ud5e4\ub4dc\uac00 \uc62c\ub54c\uae4c\uc9c0 \uc785\ub825\uac12 \uc8fc\ub294\uac83. \uc704\uce58 \ud3b8\ucc28\ub97c \uc904\uc774\ub294 \ubc29\ud5a5\uc73c\ub85c 0\uc73c\ub85c \ub9cc\ub4e4\uae30. \uc815\ub3c4\ub294? \ucd5c\ub300\ud55c \uc0ac\ub78c \ud749\ub0b4.</p> <p>\ud559\uc2b5\uc744 \ubc30\uc6cc\uc11c \uc368\uba39\uc744\uc218 \uc788\uc744\uae4c? \uafc0\uac12\ub9d0\uace0 \uc2e4\uc81c\ub85c \uc120\uc218\ub4e4 \uc5d0\uc774\ubc0d\uc744.</p> <p>\uc544\ub2c8\uba74 \uc5d0\uc784\uc774 \ub9de\uc73c\uba74 \ud30c\ub780\uc0c9\uc73c\ub85c \ubcc0\ud574\uc11c \uadf8\ub54c \uc3d8\uac8c\ud558\ub294 \uac83\ub3c4 \uc7ac\ubc0c\uc744\uac70 \uac19\uc74c.</p> <p>\ube44\uc2b7\ud55c \ubc94\uc704\uba74 \ub178\ub780\uc0c9. \uc774\uac74 \uae30\uacc4\uac00 \ub098\uba38\uc9c0\ub97c \uc870\uc815\ud574\uc11c \uc3d8\ub3c4\ub85d.</p> <p>\ub108\ubb34 \uc790\ub3d9\ud654\ub9d0\uace0 \ub0b4\uac00 \ud1b5\uc81c\ud558\ub294 \ub290\ub08c\uc744 \uc8fc\ub3c4\ub85d.</p> <p>\ud788\uc2a4\ud1a0\ub9ac\ub294 \uc5b4\ub5bb\uac8c \ud558\ub294\uac70\uc9c0? \uc2dc\uac04 \ucc28\ub97c \uc870\uc791\ud574 \ud310\uc815\uc774 \ub113\uc5b4\uc9c0\uac8c.</p> <p>github \uc624\ud508\uc18c\uc2a4 - LibVMI\uacfc PyVMI \uc608\uc81c. Python \ubc14\uc778\ub529\uc73c\ub85c \ud504\ub85c\uc138\uc2a4 \ub9ac\uc2a4\ud2b8\uc640 \uba54\ubaa8\ub9ac \uc77d\uae30 \ub370\ubaa8. https://github.com/maxking/pyvmi_example?utm_source=chatgpt.com</p> <p>github \uc624\ud508\uc18c\uc2a4 - r2vmi\uc640 IntroVirt. LibVMI + Radare2 \ud50c\ub7ec\uadf8\uc778/KVM \uc804\uc6a9 \ud655\uc7a5\uacfc VMI \ud504\ub808\uc784\uc6cc\ud06c https://github.com/Wenzel/r2vmi?utm_source=chatgpt.com https://github.com/IntroVirt/IntroVirt?utm_source=chatgpt.com</p> <p>github \uc624\ud508\uc18c\uc2a4 - pixelbot https://github.com/AliShazly/pixelbot?utm_source=chatgpt.com</p> <p>\uce58\ud2b8 \uc18c\uc2a4 P. Karkallis, J. Blasco, G. Suarez-Tangil, and S. Pastrana. Detecting video-game injectors exchanged in game cheating communities. In Computer Security \u2013 ESORICS 2021: 26th European Symposium on Research in Computer Security, Darmstadt, Germany, October 4\u20138, 2021, Proceedings, Part I, page 305\u2013324, Berlin, Heidelberg, 2021. Springer-Verlag.</p>"},{"location":"memo/#_1","title":"&gt; \uac8c\uc2a4\ud2b8 \uce21 \ubcf4\uc548 \uc81c\uac70","text":"<p>\uc548\ud2f0\uce58\ud2b8\uac00 Hyper-V \ucee4\ub110 \ub808\uc774\ub7ec\ub97c \uac10\uc9c0\ud558\uba74 \ubc14\ub85c \ube14\ub8e8\uc2a4\ud06c\ub9b0.</p> <p>step 1. \uc124\uc815 \u203a \uc571 \u203a \uc120\ud0dd\uc801 \uae30\ub2a5 <pre><code>    Hyper-V\n    Windows Hypervisor Platform\n    Virtual Machine Platform\n    Windows Sandbox\n    Windows Subsystem for Linux\n    \u2192 \uc804\ubd80 \uccb4\ud06c \ud574\uc81c(\uc81c\uac70) \u25b8 \uc7ac\ubd80\ud305\n</code></pre></p> <p>step 2. \uc124\uc815 <pre><code>    core isolation \u2192 Memory Integrity OFF\n    Optional: bcdedit /set hypervisorlaunchtype off\n</code></pre></p> <p>\uc548\ud2f0\uce58\ud2b8 \ub17c\ubb38 - VMI \uc790\uccb4\ub97c \uac8c\uc2a4\ud2b8 \ucabd\uc5d0\uc11c \uac10\uc9c0\ud558\ub294 \ud734\ub9ac\uc2a4\ud2f1 \uc81c\uc548 https://www.researchgate.net/publication/345646485_Who_watches_the_watcher_Detecting_hypervisor_introspection_from_unprivileged_guests</p> <p>https://drakvuf-sandbox.readthedocs.io/en/latest/usage/getting_started.html?utm_source=chatgpt.com</p> <p>Bug noted on 2025-04-24: Xen refers to old Tianocore OVMF version that refers to broken subhook submodule URL. If you\u2019re affected by this bug, you\u2019ll be asked for Git credentials while running make -j4 dist-tools and build process will be interrupted.</p> <p>To overcome this issue, we changed the OVMF version to edk2-stable202408.01 by applying this patch to Config.mk:</p> <ul> <li>OVMF_UPSTREAM_URL ?= https://xenbits.xen.org/git-http/ovmf.git</li> <li>OVMF_UPSTREAM_REVISION ?= ba91d0292e593df8528b66f99c1b0b14fadc8e16</li> <li>OVMF_UPSTREAM_URL ?= https://github.com/tianocore/edk2.git</li> <li>OVMF_UPSTREAM_REVISION ?= 4dfdca63a93497203f197ec98ba20e2327e4afe4</li> </ul> <p>kkongnyang2@acer:~$ sudo /home/kkongnyang2/vmi-venv/bin/python3 ~/game-cheat/code/chain/decode_component_slots.py \\</p> <p>--data /home/kkongnyang2/abc.exe_.data_0x7ff740282000_0x2ef800.bin \\   --slot-offs 0x3603ed0 0x36fa6e8 0x3603f30 \\   --module-base 0x7ff73cdd0000 \\   --out-json /home/kkongnyang2/decoded_component_bases.json [i] Using module base = 0x7ff73cdd0000 [i] .data VA = 0x7ff740282000, size = 0x2ef800 [i] XOR key = 0xee222bb7ef934a1d [i] Steps = [0, 8, 16, 24] [+] Wrote decoded candidates -&gt; /home/kkongnyang2/decoded_component_bases.json [!] No plausible decoded pointers found in range. Try adjusting --key, --steps, or pointer bounds. kkongnyang2@acer:~$ sudo nano ~/decoded_component_bases.json kkongnyang2@acer:~$ sudo /home/kkongnyang2/vmi-venv/bin/python3 ~/game-cheat/code/chain/decode_component_slots.py   --data /home/kkongnyang2/abc.exe_.data_0x7ff740282000_0x2ef800.bin   --json /home/kkongnyang2/component_slot_candidates.json   --top 6   --verbose [i] Using module base = 0x7ff73cdd0000 [i] .data VA = 0x7ff740282000, size = 0x2ef800 [i] XOR key = 0xee222bb7ef934a1d [i] Steps = [0, 8, 16, 24], Rotations = [8, 13, 16, 24, 31] [i] Canonicalization: mask48=ON, sign_extend=OFF [+]            xor | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x1e65671d424bc67f  canon 0x671d424bc67f  (OK) [+] ror_then_xor:8 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x8cd26cfb453e9291  canon 0x6cfb453e9291  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x8d35a98d8ac624d9 (not in range) [ ] ror_then_xor:16 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x6240dbf0a339e7c5 (not in range) [+] ror_then_xor:24 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x36ae4947a8dfe0b0  canon 0x4947a8dfe0b0  (OK) [+] ror_then_xor:31 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0xb59333720f1dd348  canon 0x33720f1dd348  (OK) [+] xor_then_ror:8 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x7f1e65671d424bc6  canon 0x65671d424bc6  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x33f8f32b38ea125e (not in range) [+] xor_then_ror:16 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0xc67f1e65671d424b  canon 0x1e65671d424b  (OK) [+] xor_then_ror:24 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x4bc67f1e65671d42  canon 0x7f1e65671d42  (OK) [ ] xor_then_ror:31 | slot 0x7ff7403d3ed0 +0x0 -&gt; enc 0xf0474caaadd88c62  raw 0x84978cfe3ccace3a (not in range) [+]            xor | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0x1e65671d424fc8ff  canon 0x671d424fc8ff  (OK) [+] ror_then_xor:8 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0xcd26cfb453e969f  canon 0x6cfb453e969f  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0xf935a98d8ac624f9 (not in range) [ ] ror_then_xor:16 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0x6cc0dbf0a339e7c1 (not in range) [ ] ror_then_xor:24 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0x32a0c947a8dfe0b0 (not in range) [+] ror_then_xor:31 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0xb59b2e720f1dd348  canon 0x2e720f1dd348  (OK) [+] xor_then_ror:8 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0xff1e65671d424fc8  canon 0x65671d424fc8  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0x47f8f32b38ea127e (not in range) [+] xor_then_ror:16 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0xc8ff1e65671d424f  canon 0x1e65671d424f  (OK) [ ] xor_then_ror:24 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0x4fc8ff1e65671d42 (not in range) [ ] xor_then_ror:31 | slot 0x7ff7403d3ed0 +0x8 -&gt; enc 0xf0474caaaddc82e2  raw 0x849f91fe3ccace3a (not in range) [ ]            xor | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0x1e65e4f6053dca97 (not in range) [+] ror_then_xor:8 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0x64d26c78ae79e49d  canon 0x6c78ae79e49d  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0xea75a989959c1f69 (not in range) [ ] ror_then_xor:16 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0x6ea8dbf020d2a0b3 (not in range) [ ] ror_then_xor:24 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0x40a2a147a85c0bf7 (not in range) [+] ror_then_xor:31 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0x3b7f2aa20f1cd49e  canon 0x2aa20f1cd49e  (OK) [+] xor_then_ror:8 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0x971e65e4f6053dca  canon 0x65e4f6053dca  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0x54b8f32f27b029ee (not in range) [+] xor_then_ror:16 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0xca971e65e4f6053d  canon 0x1e65e4f6053d  (OK) [ ] xor_then_ror:24 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0x3dca971e65e4f605 (not in range) [ ] xor_then_ror:31 | slot 0x7ff7403d3ed0 +0x10 -&gt; enc 0xf047cf41eaae808a  raw 0xa7b952e3ccbc9ec (not in range) [+]            xor | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0x1e6564fec4865d3f  canon 0x64fec4865d3f  (OK) [+] ror_then_xor:8 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0xccd26cf8a6b85f0a  canon 0x6cf8a6b85f0a  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0x5735a98d95da12b5 (not in range) [ ] ror_then_xor:16 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0xf900dbf0a0da6108 (not in range) [+] ror_then_xor:24 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0xfb350947a8dc0336  canon 0x947a8dc0336  (OK) [+] ror_then_xor:31 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0xb80805f20f1dd48f  canon 0x5f20f1dd48f  (OK) [+] xor_then_ror:8 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0x3f1e6564fec4865d  canon 0x6564fec4865d  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0xe9f8f32b27f62432 (not in range) [+] xor_then_ror:16 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0x5d3f1e6564fec486  canon 0x1e6564fec486  (OK) [+] xor_then_ror:24 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0x865d3f1e6564fec4  canon 0x3f1e6564fec4  (OK) [ ] xor_then_ror:31 | slot 0x7ff7403d3ed0 +0x18 -&gt; enc 0xf0474f492b151722  raw 0x890cba7e3ccac9fd (not in range) [+]            xor | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0xee225576ccd2320c  canon 0x5576ccd2320c  (OK) [+] ror_then_xor:8 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0xff222bc92eb00b65  canon 0x2bc92eb00b65  (OK) [+] ror_then_xor:13 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0x2eaa2bb4199a5016  canon 0x2bb4199a5016  (OK) [+] ror_then_xor:16 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0x96332bb79152695c  canon 0x2bb79152695c  (OK) [+] ror_then_xor:24 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0xaf5a3ab7efed8b3e  canon 0x3ab7efed8b3e  (OK) [ ] ror_then_xor:31 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0xa8a0db95ef93b79f (not in range) [+] xor_then_ror:8 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0xcee225576ccd232  canon 0x225576ccd232  (OK) [+] xor_then_ror:13 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0x90677112abb66691  canon 0x7112abb66691  (OK) [ ] xor_then_ror:16 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0x320cee225576ccd2 (not in range) [+] xor_then_ror:24 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0xd2320cee225576cc  canon 0xcee225576cc  (OK) [+] xor_then_ror:31 | slot 0x7ff7404ca6e8 +0x0 -&gt; enc 0x7ec123417811  raw 0x99a46419dc44aaed  canon 0x6419dc44aaed  (OK) [+]            xor | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0xee222bb7ef93d268  canon 0x2bb7ef93d268  (OK) [+] ror_then_xor:8 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0x9b222bb7ef934a85  canon 0x2bb7ef934a85  (OK) [+] ror_then_xor:13 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0x2d8a2bb7ef934a19  canon 0x2bb7ef934a19  (OK) [+] ror_then_xor:16 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0x76572bb7ef934a1d  canon 0x2bb7ef934a1d  (OK) [+] ror_then_xor:24 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0xeeba5eb7ef934a1d  canon 0x5eb7ef934a1d  (OK) [+] ror_then_xor:31 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0xee231b5def934a1d  canon 0x1b5def934a1d  (OK) [+] xor_then_ror:8 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0x68ee222bb7ef93d2  canon 0x222bb7ef93d2  (OK) [+] xor_then_ror:13 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0x934771115dbf7c9e  canon 0x71115dbf7c9e  (OK) [ ] xor_then_ror:16 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0xd268ee222bb7ef93 (not in range) [+] xor_then_ror:24 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0x93d268ee222bb7ef  canon 0x68ee222bb7ef  (OK) [ ] xor_then_ror:31 | slot 0x7ff7404ca6e8 +0x8 -&gt; enc 0x9875  raw 0xdf27a4d1dc44576f (not in range) [+]            xor | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0xee222bb7ef934a1d  canon 0x2bb7ef934a1d  (OK) [+] ror_then_xor:8 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0xee222bb7ef934a1d  canon 0x2bb7ef934a1d  (OK) [+] ror_then_xor:13 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0xee222bb7ef934a1d  canon 0x2bb7ef934a1d  (OK) [+] ror_then_xor:16 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0xee222bb7ef934a1d  canon 0x2bb7ef934a1d  (OK) [+] ror_then_xor:24 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0xee222bb7ef934a1d  canon 0x2bb7ef934a1d  (OK) [+] ror_then_xor:31 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0xee222bb7ef934a1d  canon 0x2bb7ef934a1d  (OK) [+] xor_then_ror:8 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0x1dee222bb7ef934a  canon 0x222bb7ef934a  (OK) [+] xor_then_ror:13 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0x50ef71115dbf7c9a  canon 0x71115dbf7c9a  (OK) [ ] xor_then_ror:16 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0x4a1dee222bb7ef93 (not in range) [+] xor_then_ror:24 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0x934a1dee222bb7ef  canon 0x1dee222bb7ef  (OK) [ ] xor_then_ror:31 | slot 0x7ff7404ca6e8 +0x10 -&gt; enc 0x0  raw 0xdf26943bdc44576f (not in range) [+]            xor | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0xee222b99ef934a18  canon 0x2b99ef934a18  (OK) [+] ror_then_xor:8 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0xeb222bb7c1934a1d  canon 0x2bb7c1934a1d  (OK) [+] ror_then_xor:13 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0xee0a2bb7eee34a1d  canon 0x2bb7eee34a1d  (OK) [+] ror_then_xor:16 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0xee272bb7efbd4a1d  canon 0x2bb7efbd4a1d  (OK) [+] ror_then_xor:24 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0xee222eb7ef93641d  canon 0x2eb7ef93641d  (OK) [+] ror_then_xor:31 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0xee222bbdef934a41  canon 0x2bbdef934a41  (OK) [+] xor_then_ror:8 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0x18ee222b99ef934a  canon 0x222b99ef934a  (OK) [+] xor_then_ror:13 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0x50c771115ccf7c9a  canon 0x71115ccf7c9a  (OK) [ ] xor_then_ror:16 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0x4a18ee222b99ef93 (not in range) [+] xor_then_ror:24 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0x934a18ee222b99ef  canon 0x18ee222b99ef  (OK) [ ] xor_then_ror:31 | slot 0x7ff7404ca6e8 +0x18 -&gt; enc 0x2e00000005  raw 0xdf269431dc445733 (not in range) [+]            xor | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0x1e65671d3cd05d3f  canon 0x671d3cd05d3f  (OK) [+] ror_then_xor:8 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0xccd26cfb4540090a  canon 0x6cfb4540090a  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0x5735a98d8ac5d005 (not in range) [ ] ror_then_xor:16 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0xf900dbf0a339995e (not in range) [+] ror_then_xor:24 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0xad350947a8dfe0ce  canon 0x947a8dfe0ce  (OK) [+] ror_then_xor:31 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0x48a405f20f1dd348  canon 0x5f20f1dd348  (OK) [+] xor_then_ror:8 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0x3f1e65671d3cd05d  canon 0x65671d3cd05d  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0xe9f8f32b38e9e682 (not in range) [+] xor_then_ror:16 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0x5d3f1e65671d3cd0  canon 0x1e65671d3cd0  (OK) [+] xor_then_ror:24 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0xd05d3f1e65671d3c  canon 0x3f1e65671d3c  (OK) [ ] xor_then_ror:31 | slot 0x7ff7403d3f30 +0x0 -&gt; enc 0xf0474caad3431722  raw 0x79a0ba7e3ccace3a (not in range) [ ]            xor | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0x1e65e4f60539f6ef (not in range) [+] ror_then_xor:8 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0x1cd26c78ae79e0a1  canon 0x6c78ae79e0a1  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0x9b5a989959c1f48 (not in range) [ ] ror_then_xor:16 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0x52d0dbf020d2a0b7 (not in range) [ ] ror_then_xor:24 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0x449ed947a85c0bf7 (not in range) [+] ror_then_xor:31 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0x3b7752520f1cd49e  canon 0x52520f1cd49e  (OK) [+] xor_then_ror:8 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0xef1e65e4f60539f6  canon 0x65e4f60539f6  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0xb778f32f27b029cf (not in range) [+] xor_then_ror:16 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0xf6ef1e65e4f60539  canon 0x1e65e4f60539  (OK) [ ] xor_then_ror:24 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0x39f6ef1e65e4f605 (not in range) [ ] xor_then_ror:31 | slot 0x7ff7403d3f30 +0x8 -&gt; enc 0xf047cf41eaaabcf2  raw 0xa73edde3ccbc9ec (not in range) [ ]            xor | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0x1e65e4f60539f7ef (not in range) [+] ror_then_xor:8 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0x1cd26c78ae79e0a0  canon 0x6c78ae79e0a0  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0x1b5a989959c1f48 (not in range) [ ] ror_then_xor:16 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0x53d0dbf020d2a0b7 (not in range) [ ] ror_then_xor:24 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0x449fd947a85c0bf7 (not in range) [+] ror_then_xor:31 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0x3b7750520f1cd49e  canon 0x50520f1cd49e  (OK) [+] xor_then_ror:8 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0xef1e65e4f60539f7  canon 0x65e4f60539f7  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0xbf78f32f27b029cf (not in range) [+] xor_then_ror:16 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0xf7ef1e65e4f60539  canon 0x1e65e4f60539  (OK) [ ] xor_then_ror:24 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0x39f7ef1e65e4f605 (not in range) [ ] xor_then_ror:31 | slot 0x7ff7403d3f30 +0x10 -&gt; enc 0xf047cf41eaaabdf2  raw 0xa73efde3ccbc9ec (not in range) [ ]            xor | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0x1e65e4f60533566f (not in range) [+] ror_then_xor:8 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0x9cd26c78ae79ea01  canon 0x6c78ae79ea01  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0xdb5a989959c1f1d (not in range) [ ] ror_then_xor:16 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0xf250dbf020d2a0bd (not in range) [+] ror_then_xor:24 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0x4e3e5947a85c0bf7  canon 0x5947a85c0bf7  (OK) [+] ror_then_xor:31 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0x3b6213520f1cd49e  canon 0x13520f1cd49e  (OK) [+] xor_then_ror:8 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0x6f1e65e4f6053356  canon 0x65e4f6053356  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0xb378f32f27b0299a (not in range) [+] xor_then_ror:16 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0x566f1e65e4f60533  canon 0x1e65e4f60533  (OK) [+] xor_then_ror:24 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0x33566f1e65e4f605  canon 0x6f1e65e4f605  (OK) [ ] xor_then_ror:31 | slot 0x7ff7403d3f30 +0x18 -&gt; enc 0xf047cf41eaa01c72  raw 0xa66acde3ccbc9ec (not in range) [+]            xor | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0xee225440d03ff00d  canon 0x5440d03ff00d  (OK) [+] ror_then_xor:8 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0xfe222bc818ace6a7  canon 0x2bc818ace6a7  (OK) [+] ror_then_xor:13 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0x3ea22bb4102ab778  canon 0x2bb4102ab778  (OK) [+] ror_then_xor:16 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0x54322bb7906475b1  canon 0x2bb7906475b1  (OK) [+] ror_then_xor:24 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0x42983bb7efecbd22  canon 0x3bb7efecbd22  (OK) [+] ror_then_xor:31 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0x917b5f97ef93b5f3  canon 0x5f97ef93b5f3  (OK) [+] xor_then_ror:8 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0xdee225440d03ff0  canon 0x225440d03ff0  (OK) [+] xor_then_ror:13 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0x806f7112a20681ff  canon 0x7112a20681ff  (OK) [ ] xor_then_ror:16 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0xf00dee225440d03f (not in range) [+] xor_then_ror:24 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0x3ff00dee225440d0  canon 0xdee225440d0  (OK) [ ] xor_then_ror:31 | slot 0x7ff7402a50c0 +0x0 -&gt; enc 0x7ff73facba10  raw 0xa07fe01bdc44a881 (not in range) [ ]            xor | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0x4c67d655f1bc2f70 (not in range) [+] ror_then_xor:8 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0x83806e4a0d8d6578  canon 0x6e4a0d8d6578  (OK) [+] ror_then_xor:13 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0xc54f39980083bb66  canon 0x39980083bb66  (OK) [ ] ror_then_xor:16 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0x8b4f89f212715432 (not in range) [+] ror_then_xor:24 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0xc1474615aa6ea803  canon 0x4615aa6ea803  (OK) [ ] ror_then_xor:31 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0xd27ce16cab18b1d9 (not in range) [+] xor_then_ror:8 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0x704c67d655f1bc2f  canon 0x67d655f1bc2f  (OK) [+] xor_then_ror:13 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0x7b82633eb2af8de1  canon 0x633eb2af8de1  (OK) [+] xor_then_ror:16 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0x2f704c67d655f1bc  canon 0x4c67d655f1bc  (OK) [+] xor_then_ror:24 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0xbc2f704c67d655f1  canon 0x704c67d655f1  (OK) [+] xor_then_ror:31 | slot 0x7ff7402a50c0 +0x8 -&gt; enc 0xa245fde21e2f656d  raw 0xe3785ee098cfacab  canon 0x5ee098cfacab  (OK) [+]            xor | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0xa65673e7ee934a3a  canon 0x73e7ee934a3a  (OK) [+] ror_then_xor:8 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0xc96a5fefbf924a1d  canon 0x5fefbf924a1d  (OK) [+] ror_then_xor:13 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0xef1868152d13421d  canon 0x68152d13421d  (OK) [+] ror_then_xor:16 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0xee0563c3b7c34b1d  canon 0x63c3b7c34b1d  (OK) [+] ror_then_xor:24 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0xee220cff9bcb1a1c  canon 0xcff9bcb1a1c  (OK) [+] ror_then_xor:31 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0xec222bf97f7bfabd  canon 0x2bf97f7bfabd  (OK) [+] xor_then_ror:8 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0x3aa65673e7ee934a  canon 0x5673e7ee934a  (OK) [+] xor_then_ror:13 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0x51d532b39f3f749a  canon 0x32b39f3f749a  (OK) [ ] xor_then_ror:16 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0x4a3aa65673e7ee93 (not in range) [+] xor_then_ror:24 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0x934a3aa65673e7ee  canon 0x3aa65673e7ee  (OK) [ ] xor_then_ror:31 | slot 0x7ff7402a50c0 +0x10 -&gt; enc 0x4874585001000027  raw 0xdd2694754cace7cf (not in range) [+]            xor | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0x956f23bf00f6eabc  canon 0x23bf00f6eabc  (OK) [+] ror_then_xor:8 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0x4f5966bfe77c2fbd  canon 0x66bfe77c2fbd  (OK) [ ] ror_then_xor:13 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0xeb29f1dfafd43130 (not in range) [+] ror_then_xor:16 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0x4e8350fae79ba578  canon 0x50fae79ba578  (OK) [ ] ror_then_xor:24 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0x8b828acca29b42f2 (not in range) [+] ror_then_xor:31 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0x30e96af519095a0c  canon 0x6af519095a0c  (OK) [+] xor_then_ror:8 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0xbc956f23bf00f6ea  canon 0x6f23bf00f6ea  (OK) [ ] xor_then_ror:13 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0x55e4ab791df807b7 (not in range) [ ] xor_then_ror:16 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0xeabc956f23bf00f6 (not in range) [ ] xor_then_ror:24 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0xf6eabc956f23bf00 (not in range) [ ] xor_then_ror:31 | slot 0x7ff7402a50c0 +0x18 -&gt; enc 0x7b4d0808ef65a0a1  raw 0x1edd5792ade477e (not in range) [+]            xor | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0xee2229a9fe344a9c  canon 0x29a9fe344a9c  (OK) [+] ror_then_xor:8 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0x6f222bb5f182ed1d  canon 0x2bb5f182ed1d  (OK) [+] ror_then_xor:13 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0xea2a2bb7ff63c725  canon 0x2bb7ff63c725  (OK) [+] ror_then_xor:16 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0xeea32bb7ed8d5bba  canon 0x2bb7ed8d5bba  (OK) [ ] ror_then_xor:24 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0x4922aab7ef91540c (not in range) [+] ror_then_xor:31 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0xcd6c2ab5ef934e21  canon 0x2ab5ef934e21  (OK) [+] xor_then_ror:8 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0x9cee2229a9fe344a  canon 0x2229a9fe344a  (OK) [+] xor_then_ror:13 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0x54e771114d4ff1a2  canon 0x71114d4ff1a2  (OK) [ ] xor_then_ror:16 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0x4a9cee2229a9fe34 (not in range) [ ] xor_then_ror:24 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0x344a9cee2229a9fe (not in range) [ ] xor_then_ror:31 | slot 0x7ff7403cc118 +0x0 -&gt; enc 0x21e11a70081  raw 0xfc689539dc445353 (not in range) [+]            xor | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x97c44ebdba65fa9f  canon 0x4ebdba65fa9f  (OK) [ ] ror_then_xor:8 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x6c5bcdd2e5c6bcad (not in range) [ ] ror_then_xor:13 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x6a31e484c7c1e5a8 (not in range) [+] ror_then_xor:16 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x5ea052518a991feb  canon 0x52518a991feb  (OK) [ ] ror_then_xor:24 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x1892a9ce09f64048 (not in range) [+] ror_then_xor:31 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x45cf4ab31c5f8009  canon 0x4ab31c5f8009  (OK) [ ] xor_then_ror:8 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x9f97c44ebdba65fa (not in range) [ ] xor_then_ror:13 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0xd4fcbe2275edd32f (not in range) [ ] xor_then_ror:16 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0xfa9f97c44ebdba65 (not in range) [ ] xor_then_ror:24 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x65fa9f97c44ebdba (not in range) [ ] xor_then_ror:31 | slot 0x7ff7403cc118 +0x8 -&gt; enc 0x79e6650a55f6b082  raw 0x74cbf53f2f889d7b (not in range) [+]            xor | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0x884442f3ef934a11  canon 0x42f3ef934a11  (OK) [+] ror_then_xor:8 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0xe2444ddeab934a1d  canon 0x4ddeab934a1d  (OK) [+] ror_then_xor:13 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0xee411884a5b34a1d  canon 0x1884a5b34a1d  (OK) [+] ror_then_xor:16 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0xee2e4dd186d74a1d  canon 0x4dd186d74a1d  (OK) [+] ror_then_xor:24 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0xee2227d189fa0e1d  canon 0x27d189fa0e1d  (OK) [+] ror_then_xor:31 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0xee222baf235f9895  canon 0x2baf235f9895  (OK) [+] xor_then_ror:8 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0x11884442f3ef934a  canon 0x4442f3ef934a  (OK) [+] xor_then_ror:13 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0x508c4222179f7c9a  canon 0x4222179f7c9a  (OK) [ ] xor_then_ror:16 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0x4a11884442f3ef93 (not in range) [+] xor_then_ror:24 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0x934a11884442f3ef  canon 0x11884442f3ef  (OK) [ ] xor_then_ror:31 | slot 0x7ff7403cc118 +0x10 -&gt; enc 0x666669440000000c  raw 0xdf269423108885e7 (not in range) [+]            xor | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x9c4d47d8acf63968  canon 0x47d8acf63968  (OK) [+] ror_then_xor:8 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x9b5044db80d02f6e  canon 0x44db80d02f6e  (OK) [ ] ror_then_xor:13 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x7589b8cc8ce95136 (not in range) [+] ror_then_xor:16 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x9d5759d883fc0978  canon 0x59d883fc0978  (OK) [+] ror_then_xor:24 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x8b515ec580ff255e  canon 0x5ec580ff255e  (OK) [ ] ror_then_xor:31 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x68e8cd5d0b4d92c3 (not in range) [+] xor_then_ror:8 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x689c4d47d8acf639  canon 0x4d47d8acf639  (OK) [ ] xor_then_ror:13 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0xcb44e26a3ec567b1 (not in range) [ ] xor_then_ror:16 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x39689c4d47d8acf6 (not in range) [+] xor_then_ror:24 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0xf639689c4d47d8ac  canon 0x689c4d47d8ac  (OK) [+] xor_then_ror:31 | slot 0x7ff7403cc118 +0x18 -&gt; enc 0x726f6c6f43657375  raw 0x59ec72d1389a8fb1  canon 0x72d1389a8fb1  (OK) [+] Wrote decoded candidates -&gt; decoded_component_bases.json kkongnyang2@acer:~$ </p>"}]}