
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../4-igpu/">
      
      
        <link rel="next" href="../6-two-gpu/">
      
      
      <link rel="icon" href="../logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>5 dgpu - Game-Cheat</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../soft-era.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="apple" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#igpu-dgpu-vm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Game-Cheat" class="md-header__button md-logo" aria-label="Game-Cheat" data-md-component="logo">
      
  <img src="../logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Game-Cheat
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              5 dgpu
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="apple" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Soft Era"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Soft Era" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20.71 4.63-1.34-1.34c-.37-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.04 0-1.41M7 14a3 3 0 0 0-3 3c0 1.31-1.16 2-2 2 .92 1.22 2.5 2 4 2a4 4 0 0 0 4-4 3 3 0 0 0-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="soft" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Apple Classic"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Apple Classic" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20.71 4.63-1.34-1.34c-.37-.39-1.02-.39-1.41 0L9 12.25 11.75 15l8.96-8.96c.39-.39.39-1.04 0-1.41M7 14a3 3 0 0 0-3 3c0 1.31-1.16 2-2 2 .92 1.22 2.5 2 4 2a4 4 0 0 0 4-4 3 3 0 0 0-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../1-ow/" class="md-tabs__link">
        
  
  
    
  
  1 ow

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../10-kvmi-v7/" class="md-tabs__link">
        
  
  
    
  
  10 kvmi v7

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../11-xen-22.04/" class="md-tabs__link">
        
  
  
    
  
  11 xen 22.04

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../12-xen-backlist/" class="md-tabs__link">
        
  
  
    
  
  12 xen backlist

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../13-xen-pciback/" class="md-tabs__link">
        
  
  
    
  
  13 xen pciback

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../14-summary/" class="md-tabs__link">
        
  
  
    
  
  14 summary

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../15-CE-tutorial/" class="md-tabs__link">
        
  
  
    
  
  15 CE tutorial

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../16-pyvmi-rw/" class="md-tabs__link">
        
  
  
    
  
  16 pyvmi rw

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../17-pyvmi-dump/" class="md-tabs__link">
        
  
  
    
  
  17 pyvmi dump

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../18-drakvuf-heap/" class="md-tabs__link">
        
  
  
    
  
  18 drakvuf heap

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../19-ow-memory/" class="md-tabs__link">
        
  
  
    
  
  19 ow memory

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../2-cheats/" class="md-tabs__link">
        
  
  
    
  
  2 cheats

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../20-drakvuf-microtrace/" class="md-tabs__link">
        
  
  
    
  
  20 drakvuf microtrace

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../21-libvmi-microtrace/" class="md-tabs__link">
        
  
  
    
  
  21 libvmi microtrace

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../22-main/" class="md-tabs__link">
        
  
  
    
  
  22 main

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../3-display/" class="md-tabs__link">
        
  
  
    
  
  3 display

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../4-igpu/" class="md-tabs__link">
        
  
  
    
  
  4 igpu

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  5 dgpu

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../6-two-gpu/" class="md-tabs__link">
        
  
  
    
  
  6 two gpu

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../7-vmi/" class="md-tabs__link">
        
  
  
    
  
  7 vmi

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../8-kvm-legacy/" class="md-tabs__link">
        
  
  
    
  
  8 kvm legacy

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../9-kvmi-v12/" class="md-tabs__link">
        
  
  
    
  
  9 kvmi v12

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../log/" class="md-tabs__link">
        
  
  
    
  
  Log

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../memo/" class="md-tabs__link">
        
  
  
    
  
  Memo

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Game-Cheat" class="md-nav__button md-logo" aria-label="Game-Cheat" data-md-component="logo">
      
  <img src="../logo.svg" alt="logo">

    </a>
    Game-Cheat
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../1-ow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1 ow
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-kvmi-v7/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10 kvmi v7
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../11-xen-22.04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11 xen 22.04
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../12-xen-backlist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12 xen backlist
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../13-xen-pciback/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    13 xen pciback
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../14-summary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14 summary
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../15-CE-tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15 CE tutorial
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../16-pyvmi-rw/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16 pyvmi rw
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../17-pyvmi-dump/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17 pyvmi dump
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../18-drakvuf-heap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18 drakvuf heap
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../19-ow-memory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19 ow memory
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-cheats/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    2 cheats
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../20-drakvuf-microtrace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20 drakvuf microtrace
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../21-libvmi-microtrace/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    21 libvmi microtrace
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../22-main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    22 main
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-display/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3 display
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../4-igpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4 igpu
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    5 dgpu
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    5 dgpu
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#igpu-dgpu-vm" class="md-nav__link">
    <span class="md-ellipsis">
      IGPU 없을때 DGPU 풀 패스스루 vm을 만들자
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IGPU 없을때 DGPU 풀 패스스루 vm을 만들자">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      풀 패스스루 개요
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      커널 설정
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      주소 및 그룹 정보 확인
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu" class="md-nav__link">
    <span class="md-ellipsis">
      gpu 장치 제어
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vm" class="md-nav__link">
    <span class="md-ellipsis">
      vm에 정보 전달
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      &gt; 원격
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      해결
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../6-two-gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6 two gpu
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../7-vmi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    7 vmi
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../8-kvm-legacy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8 kvm legacy
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../9-kvmi-v12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9 kvmi v12
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Log
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../memo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Memo
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#igpu-dgpu-vm" class="md-nav__link">
    <span class="md-ellipsis">
      IGPU 없을때 DGPU 풀 패스스루 vm을 만들자
    </span>
  </a>
  
    <nav class="md-nav" aria-label="IGPU 없을때 DGPU 풀 패스스루 vm을 만들자">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      풀 패스스루 개요
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      커널 설정
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      주소 및 그룹 정보 확인
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu" class="md-nav__link">
    <span class="md-ellipsis">
      gpu 장치 제어
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vm" class="md-nav__link">
    <span class="md-ellipsis">
      vm에 정보 전달
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      &gt; 원격
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      해결
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>5 dgpu</h1>

<h2 id="igpu-dgpu-vm">IGPU 없을때 DGPU 풀 패스스루 vm을 만들자</h2>
<p>작성자: kkongnyang2 작성일: 2025-08-02</p>
<hr />
<p>igpu 없이 dgpu 하나여도, 호스트에서 떼고 게스트로 넘기는 법</p>
<h3 id="_1">풀 패스스루 개요</h3>
<p>IOMMU 켜고 hostdev 추가 + VFIO 바인딩을 해야 실제 GPU가 넘어간다<br />
참고로 장치는 에뮬레이션(진짜 하드웨어인척 흉내), 파라버추얼(가짜 장치 인터페이스 virtio 제공), 패스스루(하드웨어 건내주기) 세가지 방식이 있다</p>
<h3 id="_2">커널 설정</h3>
<p>grub에서 IOMMU 전체 켜기<br />
<div class="highlight"><pre><span></span><code>$ sudo nano /etc/default/grub
원본
GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet splash&quot;
수정
# iommu=pt 패스스루 장치만 통과 video=efifb:off 호스트가 gpu 기본 프레임버퍼 잡는 것 방지
GRUB_CMDLINE_LINUX_DEFAULT=&quot;quiet splash amd_iommu=on iommu=pt video-efifb:off&quot;
$ sudo update-grub
$ reboot
</code></pre></div></p>
<h3 id="_3">주소 및 그룹 정보 확인</h3>
<p>PCI 주소와 ID 확인<br />
<div class="highlight"><pre><span></span><code>$ lspci -nn | grep -i -e vga -e audio   # gpu에 audio 장치가 딸려 있는 경우가 많기 때문에 같이 ID 같이 찾음
01:00.0 VGA compatible controller [0300]: NVIDIA Corporation AD107M [GeForce RTX 4060 Max-Q / Mobile] [10de:28e0] (rev a1)
01:00.1 Audio device [0403]: NVIDIA Corporation Device [10de:22be] (rev a1)
05:00.5 Multimedia controller [0480]: Advanced Micro Devices, Inc. [AMD] ACP/ACP3X/ACP6x Audio Coprocessor [1022:15e2] (rev 60)
05:00.6 Audio device [0403]: Advanced Micro Devices, Inc. [AMD] Family 17h/19h HD Audio Controller [1022:15e3]
</code></pre></div><br />
* PCI 주소? 버스 슬롯 어디에 꽂혀 있나<br />
* 벤더:디바이스 ID? 제조사+모델 코드로 무슨 장치인가<br />
VGA : PCI 주소 01:00.0에 ID 10de:28e0<br />
Audio : PCI 주소 01:00.1에 ID 10de:22be<br />
이게 그룹이 맞는지 iommu_groups을 확인해보자</p>
<p>Iommu_groups 확인<br />
<div class="highlight"><pre><span></span><code>$ for g in /sys/kernel/iommu_groups/*; do
  echo &quot;Group $(basename $g):&quot;; ls -l $g/devices; echo; done
Group 14:
합계 0
lrwxrwxrwx 1 root root 0  7월 26 10:11 0000:01:00.0 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:01:00.0
lrwxrwxrwx 1 root root 0  7월 26 10:11 0000:01:00.1 -&gt; ../../../../devices/pci0000:00/0000:00:01.1/0000:01:00.1
</code></pre></div><br />
따라서 둘은 14번 그룹이 맞고 이거 두개만 넘기면 됨</p>
<h3 id="gpu">gpu 장치 제어</h3>
<p>hostdev 장치 추가<br />
<div class="highlight"><pre><span></span><code>$ virt-manager
하드웨어 추가 - PCI 호스트 장치 - 0000:01:00.0과 0000:01:00.1 추가
</code></pre></div><br />
* 장치 떼기/붙이기의 관리를 managed=yes로 libvirt에게 맡기는 것</p>
<p>hook 스크립트 작성<br />
<div class="highlight"><pre><span></span><code>$ sudo mkdir -p /etc/libvirt/hooks    # 디렉토리 확인
$ sudo nano /etc/libvirt/hooks/qemu   # qemu 파일 생성
#!/usr/bin/env bash
# /etc/libvirt/hooks/qemu
set -euo pipefail

VM=&quot;$1&quot;
HOOK=&quot;$2&quot;
PHASE=&quot;$3&quot;

GPU=&quot;0000:01:00.0&quot;
AUD=&quot;0000:01:00.1&quot;
HOSTDRV=&quot;nvidia&quot;

DM_LIST=(&quot;gdm3&quot; &quot;gdm&quot; &quot;sddm&quot; &quot;lightdm&quot;)
DM_STATE_FILE=&quot;/run/libvirt-active-dm&quot;

log(){ echo &quot;[$(date +&#39;%F %T&#39;)] $*&quot; &gt;&gt; /var/log/libvirt/qemu-hook.log; }

stop_dm() {
  for dm in &quot;${DM_LIST[@]}&quot;; do
    if systemctl is-active --quiet &quot;$dm&quot;; then
      systemctl stop &quot;$dm&quot;
      echo &quot;$dm&quot; &gt; &quot;$DM_STATE_FILE&quot;
      break
    fi
  done
}

start_dm() {
  if [[ -f &quot;$DM_STATE_FILE&quot; ]]; then
    dm=&quot;$(cat &quot;$DM_STATE_FILE&quot;)&quot;
    systemctl start &quot;$dm&quot; || true
    rm -f &quot;$DM_STATE_FILE&quot;
  fi
}

unbind_vtconsoles() {
  for c in /sys/class/vtconsole/*; do
    [[ -e &quot;$c/bind&quot; ]] &amp;&amp; echo 0 &gt; &quot;$c/bind&quot; || true
  done
  echo efi-framebuffer.0        &gt; /sys/bus/platform/drivers/efi-framebuffer/unbind        2&gt;/dev/null || true
  echo simple-framebuffer.0    &gt; /sys/bus/platform/drivers/simple-framebuffer/unbind     2&gt;/dev/null || true
  echo simpledrm.0             &gt; /sys/bus/platform/drivers/simpledrm/unbind              2&gt;/dev/null || true
}

unload_host_driver() {
  case &quot;$HOSTDRV&quot; in
    nvidia)
      modprobe -r nvidia_drm nvidia_modeset nvidia_uvm nvidia 2&gt;/dev/null || true
      ;;
    amdgpu)
      modprobe -r amdgpu 2&gt;/dev/null || true
      ;;
  esac
}

reload_host_driver() {
  case &quot;$HOSTDRV&quot; in
    nvidia)
      modprobe nvidia 2&gt;/dev/null || true
      modprobe nvidia_uvm 2&gt;/dev/null || true
      modprobe nvidia_modeset 2&gt;/dev/null || true
      modprobe nvidia_drm 2&gt;/dev/null || true
      ;;
    amdgpu)
      modprobe amdgpu 2&gt;/dev/null || true
      ;;
  esac
}

load_vfio() {
  for m in vfio vfio-pci vfio_iommu_type1; do
    modprobe -n &quot;$m&quot; &amp;&gt;/dev/null &amp;&amp; modprobe &quot;$m&quot; || true
  done
}

case &quot;${HOOK}/${PHASE}&quot; in
  prepare/begin)
    log &quot;[$VM] prepare/begin: stop DM, unbind fb, unload $HOSTDRV, load vfio&quot;
    stop_dm
    unbind_vtconsoles
    unload_host_driver
    load_vfio
    ;;

  release/end|stopped/end)
    log &quot;[$VM] release/stopped: reload $HOSTDRV, start DM&quot;
    reload_host_driver
    start_dm
    ;;

  *)
    log &quot;[$VM] other phase: $HOOK / $PHASE $4&quot;
    ;;
esac

exit 0

$ sudo chmod +x /etc/libvirt/hooks/qemu     # 저장 후 실행권한
$ sudo mv /etc/libvirt/hooks/qemu ~/dd      # 잠깐 무효화할때
$ sudo mv ~/dd /etc/libvirt/hooks/qemu      # 다시 활성화
</code></pre></div><br />
* hook 스크립트란 vm이 시작/종료되기 직전 직후에 libvirt가 자동으로 실행해주는 스크립트<br />
* 이 안에서 vfio 모듈로 장치 건네주기/언바인딩/바인딩 코드를 짜주고 호스트의 gui/dm 도 내려준다<br />
* #!는 이 파일을 어떤 인터프리터로 실행할지임</p>
<h3 id="vm">vm에 정보 전달</h3>
<p>rom 파일 추가<br />
<div class="highlight"><pre><span></span><code>$ sudo mkdir -p /usr/share/vgabios      # 디렉토리 생성
$ echo 1 | sudo tee /sys/bus/pci/devices/0000:01:00.0/rom     # rom 읽기 허용
$ sudo dd if=/sys/bus/pci/devices/0000:01:00.0/rom of=/usr/share/vgabios/rtx4060.rom bs=1K
$ sudo chown root:root /usr/share/vgabios/rtx4060.rom
$ sudo chmod 644 /usr/share/vgabios/rtx4060.rom
$ echo 0 | sudo tee /sys/bus/pci/devices/0000:01:00.0/rom   # rom 잠금
$ virsh edit win10
gpu hostdev 안에 source 블록 다음에 두는 것이 관례
&lt;rom file=&#39;/usr/share/vgabios/rtx4060.rom&#39;/&gt;
</code></pre></div></p>
<h3 id="_4">&gt; 원격</h3>
<p>이렇게 패스스루를 시키면 호스트 화면이 없으므로 ssh 원격컴으로 vm을 키고 끄자</p>
<p>ssh 실행<br />
<div class="highlight"><pre><span></span><code># 내컴에서
$ sudo apt install openssh-server
$ sudo systemctl start ssh
$ sudo ufw allow 22
</code></pre></div></p>
<p>ssh 원격<br />
<div class="highlight"><pre><span></span><code># 원격컴에서
$ ssh kkongnyang2@172.30.1.69
비밀번호 4108 입력
$ virsh list --all        # vm 리스트보기
$ virsh start win10       # vm 키기
$ virsh shutdown win10    # vm 끄기
$ virsh destroy win10     # 강제 파워내리기
$ exit                    # ssh 연결 종료
</code></pre></div></p>
<h3 id="_5">해결</h3>
<p>호스트 화면은 잘 꺼지지만 게스트 화면이 켜지질 않음. 로그를 살펴보자</p>
<p>hook 스크립트 로그: /var/log/libvirt/qemu-hook.log<br />
VM별 QEMU 로그: /var/log/libvirt/qemu/win10.log<br />
libvirt 데몬 로그: journalctl -u virtqemud -u libvirtd -f<br />
커널/VFIO 메시지: dmesg | grep -i vfio<br />
<div class="highlight"><pre><span></span><code>vfio-pci ... resetting … reset done
NVRM: GPU 0000:01:00.0 is already bound to vfio-pci.
</code></pre></div><br />
정상 작동.</p>
<p>휴대폰 플래시로 비춰보니 화면이 보임. 패널 백라이트 문제임을 알 수 있음. 왜 패널 백라이트가 안켜지냐?<br />
igpu가 없고 dgpu만 있는 모델은 프레임버퍼가 dpgu 전용 vram에만 있게 되고 패널 eDP 신호선 또한 dpgu display port 엔진에만 물려 있다. 또한 노트북에서는 주로 EC(Embedded Controller)가 밝기를 조절하는 컨트롤러인데, ROM에 EC 펌웨어가 탑재되어 있으며 ACPI라는 테이블을 통해 이걸 os로 넘겨주게 된다. 하지만 qemu 부팅에서는 EC 관련 ACPI를 생성하지 않기 때문에 백라이트를 킬 수 없는 것이다. 그러나 요즘 패널에는 DPCD 주소로 AUX 채널(DisplayPort 배선에 포함된 링크 제어 및 백라이트 조정 채널)을 조절할 수 있게 해놨기에 EC 없이도 조절이 가능하다.<br />
geforce rtx 4060 game ready 드라이버 552.12 WHQL 계열부터 NVAPI를 통해 eDP AUX 경로(DPCD 레지스터 0x720/0x722/0x723)로 밝기 값을 쓰는 게 가능하다 적혀 있으므로 이걸 이용하자.<br />
혹은 ovmf로 부팅해도 백라이트 문제가 해결된다</p>
<p>게스트 spice 원격화면 접속<br />
<div class="highlight"><pre><span></span><code># 원격컴에서
virt-manager.org/download 들어가서 virt-viewer 카테고리에서 win x64 msi 다운받기
$ virsh start win10
$ virsh domdisplay win10
spice://127.0.0.1:5900
다른 cmd $ ssh -N -L 5900:127.0.0.1:5900 kkongnyang2@172.30.1.69   # 내부 서비스 접속 가능한 명령어
C:\Program Files\VirtViewer v12\bin 들어가서 remote-viewer.exe 클릭
spice://127.0.0.1:5900 연결
</code></pre></div><br />
* spice? 가상 머신 원격 접속 프로토콜</p>
<p>게스트에서 nvidia 드라이버 설치<br />
<div class="highlight"><pre><span></span><code>geforce - geforce RTX 40 series (notebooks) - geforce RTX 4060 laptop GPU - window 10 64-bit - English(US) - geforce game ready driver
</code></pre></div></p>
<blockquote>
<p>⚠️ 실패. 호스트를 못봄 + 백라이트 문제로 게스트 화면도 안보임. 노트북 교체</p>
</blockquote>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "content.code.copy", "header.autohide"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>